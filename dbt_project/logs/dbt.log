[0m22:14:29.504044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8086e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eae8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8d4f10>]}


============================== 22:14:29.512492 | 7dbf0531-43b8-4d27-a7ea-21f6d51ad04e ==============================
[0m22:14:29.512492 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:14:29.512932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:14:29.588704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e728b10>]}
[0m22:14:29.607749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e5b650>]}
[0m22:14:29.608148 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:14:29.635324 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:14:29.635836 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:14:29.636182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e95b390>]}
[0m22:14:29.977149 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:14:29.977665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808f55d0>]}
[0m22:14:30.096762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75bb6650>]}
[0m22:14:30.153351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff741dbf50>]}
[0m22:14:30.153645 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:14:30.153952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff741b0e50>]}
[0m22:14:30.154756 [info ] [MainThread]: 
[0m22:14:30.155092 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:14:30.157175 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:14:30.170403 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:14:30.170642 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:14:30.170880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:30.175293 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:14:30.175898 [debug] [ThreadPool]: On list_thrive: Close
[0m22:14:30.176986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:14:30.177323 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:14:30.180114 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:14:30.180301 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:14:30.180477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:30.183675 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:14:30.184301 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:14:30.184490 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:14:30.184857 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:14:30.185028 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:14:30.185192 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:14:30.185616 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:14:30.186121 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:14:30.186326 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:14:30.186510 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:14:30.186814 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:14:30.187059 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:14:30.188301 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:14:30.190587 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:14:30.190782 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:14:30.190995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:30.194615 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:14:30.194854 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:14:30.195072 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:14:30.204096 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:14:30.204709 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:14:30.205089 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:14:30.205265 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:14:30.206545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff741cc690>]}
[0m22:14:30.206826 [debug] [MainThread]: Using duckdb connection "master"
[0m22:14:30.207044 [debug] [MainThread]: On master: BEGIN
[0m22:14:30.207257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:30.210461 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:14:30.210656 [debug] [MainThread]: On master: COMMIT
[0m22:14:30.210838 [debug] [MainThread]: Using duckdb connection "master"
[0m22:14:30.211024 [debug] [MainThread]: On master: COMMIT
[0m22:14:30.211340 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:14:30.211560 [debug] [MainThread]: On master: Close
[0m22:14:30.212350 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:14:30.212566 [info ] [MainThread]: 
[0m22:14:30.213919 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:14:30.214230 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:14:30.214507 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:14:30.214712 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:14:30.217810 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:14:30.218936 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:14:30.231238 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:14:30.232395 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:14:30.232595 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:14:30.232779 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:14:30.236168 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:14:30.236445 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:14:30.236634 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:14:30.244647 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:14:30.244957 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:14:30.245301 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:14:30.246788 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:14:30.247000 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:14:30.248672 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:14:30.249370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f496850>]}
[0m22:14:30.249686 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:14:30.249995 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:14:30.250243 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:14:30.250738 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:14:30.251000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:14:30.251254 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:14:30.252536 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:14:30.253087 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:14:30.255202 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:14:30.255733 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:14:30.255921 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:14:30.256235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:30.259447 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:14:30.259703 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:14:30.259895 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:14:30.260211 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:14:30.260389 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:14:30.260589 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:14:30.261495 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:14:30.261669 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:14:30.263178 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:14:30.263389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd30450>]}
[0m22:14:30.263643 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:14:30.263904 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:14:30.264098 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:14:30.264367 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:14:30.264710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:14:30.264932 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:14:30.266063 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:14:30.266598 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:14:30.267966 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:14:30.268699 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:14:30.268870 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:14:30.269040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:30.271857 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:14:30.272168 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:14:30.272462 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:14:30.279821 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:14:30.280088 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:14:30.280329 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:14:30.281286 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:14:30.281496 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:14:30.283422 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:14:30.283661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbf0531-43b8-4d27-a7ea-21f6d51ad04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f38c510>]}
[0m22:14:30.283957 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:14:30.284235 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:14:30.284973 [debug] [MainThread]: Using duckdb connection "master"
[0m22:14:30.285179 [debug] [MainThread]: On master: BEGIN
[0m22:14:30.285345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:30.288564 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:14:30.288756 [debug] [MainThread]: On master: COMMIT
[0m22:14:30.288938 [debug] [MainThread]: Using duckdb connection "master"
[0m22:14:30.289128 [debug] [MainThread]: On master: COMMIT
[0m22:14:30.289393 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:14:30.289573 [debug] [MainThread]: On master: Close
[0m22:14:30.290351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:30.290527 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:14:30.290686 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:14:30.290860 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:14:30.291068 [info ] [MainThread]: 
[0m22:14:30.291261 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:14:30.291634 [debug] [MainThread]: Command end result
[0m22:14:30.306466 [info ] [MainThread]: 
[0m22:14:30.306814 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:14:30.307039 [info ] [MainThread]: 
[0m22:14:30.307243 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:14:30.307393 [info ] [MainThread]: 
[0m22:14:30.307579 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:14:30.307771 [info ] [MainThread]: 
[0m22:14:30.307954 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:14:30.308164 [info ] [MainThread]: 
[0m22:14:30.308338 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:14:30.308743 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8235402, "process_user_time": 1.307309, "process_kernel_time": 0.079774, "process_mem_max_rss": "252752", "process_out_blocks": "7948", "command_success": false, "process_in_blocks": "0"}
[0m22:14:30.308968 [debug] [MainThread]: Command `dbt run` failed at 22:14:30.308932 after 0.82 seconds
[0m22:14:30.309162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eae8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eae8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8363dcd0>]}
[0m22:14:30.309333 [debug] [MainThread]: Flushing usage events
[0m22:15:17.757847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bde0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bde8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb6fd90>]}


============================== 22:15:17.759150 | 82899011-3291-4d95-9f14-d0b2c8dd8966 ==============================
[0m22:15:17.759150 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:15:17.759598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m22:15:17.835844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82899011-3291-4d95-9f14-d0b2c8dd8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9358f7d0>]}
[0m22:15:17.855017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82899011-3291-4d95-9f14-d0b2c8dd8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1f3010>]}
[0m22:15:17.855422 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:15:17.882371 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:15:17.930412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:17.930647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:17.948568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82899011-3291-4d95-9f14-d0b2c8dd8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931e4dd0>]}
[0m22:15:17.993641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82899011-3291-4d95-9f14-d0b2c8dd8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92fa3490>]}
[0m22:15:17.993947 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:15:17.994256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82899011-3291-4d95-9f14-d0b2c8dd8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be8d750>]}
[0m22:15:17.995090 [info ] [MainThread]: 
[0m22:15:17.995432 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:15:17.997479 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:15:18.012128 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:15:18.012389 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:15:18.012575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:18.017145 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m22:15:18.017782 [debug] [ThreadPool]: On list_thrive: Close
[0m22:15:18.018913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:15:18.019196 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:15:18.022324 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:15:18.022525 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:15:18.022701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:18.025971 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:15:18.026651 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:15:18.026836 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:15:18.027247 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:18.027541 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:15:18.027741 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:15:18.028029 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:18.028479 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:15:18.028678 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:15:18.028848 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:15:18.029116 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:18.029330 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:15:18.030552 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:15:18.032904 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:15:18.033086 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:15:18.033255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:18.036667 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:15:18.036854 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:15:18.037032 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:15:18.046088 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:15:18.046747 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:15:18.047179 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:15:18.047419 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:15:18.049016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82899011-3291-4d95-9f14-d0b2c8dd8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93577e50>]}
[0m22:15:18.049351 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:18.049537 [debug] [MainThread]: On master: BEGIN
[0m22:15:18.049716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:18.053123 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:15:18.053327 [debug] [MainThread]: On master: COMMIT
[0m22:15:18.053528 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:18.053719 [debug] [MainThread]: On master: COMMIT
[0m22:15:18.053958 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:15:18.054142 [debug] [MainThread]: On master: Close
[0m22:15:18.055063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:15:18.055367 [info ] [MainThread]: 
[0m22:15:18.056767 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:15:18.057097 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:15:18.057396 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:15:18.057643 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:15:18.061025 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:15:18.061573 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:15:18.074379 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:15:18.074950 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:15:18.075157 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:15:18.075349 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:18.078765 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:18.078971 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:15:18.079159 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:15:18.087071 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:15:18.087287 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:15:18.087550 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:15:18.089037 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:15:18.089237 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:15:18.091059 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:15:18.091785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82899011-3291-4d95-9f14-d0b2c8dd8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925c2290>]}
[0m22:15:18.092101 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:15:18.092422 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:15:18.092675 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:15:18.093197 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:15:18.093453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:15:18.093653 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:15:18.094873 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:15:18.095360 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:15:18.096741 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:15:18.097111 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:15:18.097266 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:15:18.097439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:18.100162 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:18.100357 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:15:18.100518 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:15:18.100760 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:15:18.100935 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:15:18.101134 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:15:18.102040 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:15:18.102212 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:15:18.103596 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:15:18.103805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82899011-3291-4d95-9f14-d0b2c8dd8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924a8050>]}
[0m22:15:18.104062 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:15:18.104324 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:15:18.104513 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:15:18.104755 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:15:18.104993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:15:18.105196 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:15:18.106263 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:15:18.106882 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:15:18.108230 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:15:18.108648 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:15:18.108831 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:15:18.108981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:18.111845 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:18.112138 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:15:18.112336 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:15:18.119796 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:15:18.119997 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:15:18.120199 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:15:18.121147 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:15:18.121334 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:15:18.123179 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:15:18.123406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82899011-3291-4d95-9f14-d0b2c8dd8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924b8550>]}
[0m22:15:18.123693 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:15:18.123975 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:15:18.124633 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:18.124841 [debug] [MainThread]: On master: BEGIN
[0m22:15:18.125020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:18.128176 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:15:18.128376 [debug] [MainThread]: On master: COMMIT
[0m22:15:18.128557 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:18.128726 [debug] [MainThread]: On master: COMMIT
[0m22:15:18.129154 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:15:18.129444 [debug] [MainThread]: On master: Close
[0m22:15:18.130145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:18.130326 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:15:18.130484 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:15:18.130634 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:15:18.130862 [info ] [MainThread]: 
[0m22:15:18.131109 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:15:18.131525 [debug] [MainThread]: Command end result
[0m22:15:18.146925 [info ] [MainThread]: 
[0m22:15:18.147283 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:15:18.147553 [info ] [MainThread]: 
[0m22:15:18.147818 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:15:18.148011 [info ] [MainThread]: 
[0m22:15:18.148215 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:15:18.148390 [info ] [MainThread]: 
[0m22:15:18.148589 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:15:18.148756 [info ] [MainThread]: 
[0m22:15:18.148919 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:15:18.149345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4100433, "process_user_time": 0.826792, "process_kernel_time": 0.078742, "process_mem_max_rss": "252752", "process_out_blocks": "1834", "command_success": false, "process_in_blocks": "0"}
[0m22:15:18.149611 [debug] [MainThread]: Command `dbt run` failed at 22:15:18.149569 after 0.41 seconds
[0m22:15:18.149822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a39010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bde38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bde3e90>]}
[0m22:15:18.150022 [debug] [MainThread]: Flushing usage events
[0m22:15:31.569178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95218710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95647590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9525ff90>]}


============================== 22:15:31.570455 | 31535ad0-3d66-42a5-b644-558098b59335 ==============================
[0m22:15:31.570455 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:15:31.570897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:31.645103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31535ad0-3d66-42a5-b644-558098b59335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952bd910>]}
[0m22:15:31.664425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31535ad0-3d66-42a5-b644-558098b59335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9761f750>]}
[0m22:15:31.664826 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:15:31.691228 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:15:31.738974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:31.739234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:31.757220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31535ad0-3d66-42a5-b644-558098b59335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c614dd0>]}
[0m22:15:31.801750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31535ad0-3d66-42a5-b644-558098b59335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3f3f90>]}
[0m22:15:31.802046 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:15:31.802364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31535ad0-3d66-42a5-b644-558098b59335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c795a90>]}
[0m22:15:31.803202 [info ] [MainThread]: 
[0m22:15:31.803560 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:15:31.805621 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:15:31.819955 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:15:31.820212 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:15:31.820412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:31.824898 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:15:31.825496 [debug] [ThreadPool]: On list_thrive: Close
[0m22:15:31.826420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:15:31.826764 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:15:31.829549 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:15:31.829755 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:15:31.829934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:31.832911 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:15:31.833479 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:15:31.833663 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:15:31.834018 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:31.834252 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:15:31.834450 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:15:31.834823 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:31.835268 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:15:31.835490 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:15:31.835681 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:15:31.835980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:31.836183 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:15:31.837345 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:15:31.839751 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:15:31.839937 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:15:31.840156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:31.843590 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:15:31.843771 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:15:31.843951 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:15:31.853046 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:15:31.853726 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:15:31.854116 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:15:31.854298 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:15:31.855577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31535ad0-3d66-42a5-b644-558098b59335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3d0610>]}
[0m22:15:31.855850 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:31.856029 [debug] [MainThread]: On master: BEGIN
[0m22:15:31.856215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:31.859868 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m22:15:31.860113 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.860320 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:31.860495 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.860815 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:15:31.861042 [debug] [MainThread]: On master: Close
[0m22:15:31.861836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:15:31.862108 [info ] [MainThread]: 
[0m22:15:31.863657 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:15:31.863989 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:15:31.864321 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:15:31.864515 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:15:31.867786 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:15:31.868244 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:15:31.881384 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:15:31.881958 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:15:31.882164 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:15:31.882352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:31.885860 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:31.886051 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:15:31.886240 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:15:31.894113 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:15:31.894373 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:15:31.894635 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:15:31.896046 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:15:31.896251 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:15:31.897935 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:15:31.898637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31535ad0-3d66-42a5-b644-558098b59335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8fea50>]}
[0m22:15:31.898992 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:15:31.899294 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:15:31.899527 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:15:31.900043 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:15:31.900288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:15:31.900487 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:15:31.901672 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:15:31.902220 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:15:31.903649 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:15:31.904108 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:15:31.904279 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:15:31.904432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:31.907486 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:31.907713 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:15:31.907945 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:15:31.908234 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:15:31.908418 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:15:31.908626 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:15:31.909550 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:15:31.909727 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:15:31.911191 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:15:31.911427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31535ad0-3d66-42a5-b644-558098b59335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8eb250>]}
[0m22:15:31.911721 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:15:31.911987 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:15:31.912182 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:15:31.912425 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:15:31.912647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:15:31.912831 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:15:31.914121 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:15:31.914563 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:15:31.916084 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:15:31.916497 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:15:31.916682 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:15:31.916861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:31.919681 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:31.919917 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:15:31.920100 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:15:31.927638 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:15:31.927861 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:15:31.928192 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:15:31.929137 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:15:31.929318 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:15:31.931107 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:15:31.931323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31535ad0-3d66-42a5-b644-558098b59335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8ead90>]}
[0m22:15:31.931593 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:15:31.931885 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:15:31.932637 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:31.932815 [debug] [MainThread]: On master: BEGIN
[0m22:15:31.932990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:31.936200 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:15:31.936515 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.936712 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:31.936903 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.937243 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:15:31.937484 [debug] [MainThread]: On master: Close
[0m22:15:31.938314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:31.938534 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:15:31.938722 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:15:31.938897 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:15:31.939119 [info ] [MainThread]: 
[0m22:15:31.939325 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:15:31.939724 [debug] [MainThread]: Command end result
[0m22:15:31.954643 [info ] [MainThread]: 
[0m22:15:31.954891 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:15:31.955128 [info ] [MainThread]: 
[0m22:15:31.955586 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:15:31.955932 [info ] [MainThread]: 
[0m22:15:31.956223 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:15:31.956412 [info ] [MainThread]: 
[0m22:15:31.956588 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:15:31.956755 [info ] [MainThread]: 
[0m22:15:31.956925 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:15:31.957328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.406867, "process_user_time": 0.798749, "process_kernel_time": 0.075409, "process_mem_max_rss": "253000", "process_out_blocks": "1834", "command_success": false, "process_in_blocks": "0"}
[0m22:15:31.957554 [debug] [MainThread]: Command `dbt run` failed at 22:15:31.957518 after 0.41 seconds
[0m22:15:31.957753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9521b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95322c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9cfb10>]}
[0m22:15:31.957926 [debug] [MainThread]: Flushing usage events
[0m22:16:19.624297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ca8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79db2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79cab1d0>]}


============================== 22:16:19.625441 | c756387a-96c1-49d8-97a5-b6d420099ed0 ==============================
[0m22:16:19.625441 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:16:19.625840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:16:19.697948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c756387a-96c1-49d8-97a5-b6d420099ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ca3190>]}
[0m22:16:19.716023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c756387a-96c1-49d8-97a5-b6d420099ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0b2cd0>]}
[0m22:16:19.716394 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:16:19.741771 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:16:19.787653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:19.787907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:19.805199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c756387a-96c1-49d8-97a5-b6d420099ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710d5450>]}
[0m22:16:19.847622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c756387a-96c1-49d8-97a5-b6d420099ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70e83fd0>]}
[0m22:16:19.847928 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:16:19.848242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c756387a-96c1-49d8-97a5-b6d420099ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d4cb10>]}
[0m22:16:19.849007 [info ] [MainThread]: 
[0m22:16:19.849346 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:16:19.851207 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:16:19.864444 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:16:19.864672 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:16:19.864873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:19.868854 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:16:19.869389 [debug] [ThreadPool]: On list_thrive: Close
[0m22:16:19.870309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:16:19.870550 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:16:19.873095 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:16:19.873273 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:16:19.873435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:19.876167 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:16:19.876684 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:16:19.876879 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:16:19.877181 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:16:19.877346 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:16:19.877508 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:16:19.877847 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:16:19.878236 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:16:19.878417 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:16:19.878587 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:16:19.878859 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:16:19.879060 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:16:19.880167 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:16:19.882160 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:16:19.882338 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:16:19.882499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:19.885488 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:16:19.885663 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:16:19.885848 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:16:19.894156 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:16:19.894711 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:16:19.895081 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:16:19.895262 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:16:19.896374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c756387a-96c1-49d8-97a5-b6d420099ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff712d1ad0>]}
[0m22:16:19.896608 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:19.896779 [debug] [MainThread]: On master: BEGIN
[0m22:16:19.896942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:19.900007 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:16:19.900197 [debug] [MainThread]: On master: COMMIT
[0m22:16:19.900366 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:19.900533 [debug] [MainThread]: On master: COMMIT
[0m22:16:19.900790 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:16:19.900995 [debug] [MainThread]: On master: Close
[0m22:16:19.903500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:16:19.903718 [info ] [MainThread]: 
[0m22:16:19.904947 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:16:19.905240 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:16:19.905506 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:16:19.905698 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:16:19.908556 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:16:19.909052 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:16:19.920967 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:16:19.921512 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:16:19.921716 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:16:19.921931 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:16:19.924675 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:16:19.924883 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:16:19.925105 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:16:19.931976 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:16:19.932178 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:16:19.932378 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:16:19.933825 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:16:19.934040 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:16:19.935599 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:16:19.936239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c756387a-96c1-49d8-97a5-b6d420099ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff703b2550>]}
[0m22:16:19.936528 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:16:19.936860 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:16:19.937086 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:16:19.937548 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:16:19.937813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:16:19.937999 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:16:19.939028 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:16:19.939493 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:16:19.940811 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:16:19.941213 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:16:19.941383 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:16:19.941550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:19.944535 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:16:19.944820 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:16:19.945020 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:16:19.945282 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:16:19.945468 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:16:19.945676 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:16:19.946681 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:16:19.946887 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:16:19.948343 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:16:19.948575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c756387a-96c1-49d8-97a5-b6d420099ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70e9da10>]}
[0m22:16:19.948862 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:16:19.949118 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:16:19.949334 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:16:19.949599 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:16:19.949847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:16:19.950045 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:16:19.951339 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:16:19.951969 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:16:19.953431 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:16:19.953856 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:16:19.954020 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:16:19.954175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:19.957213 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:16:19.957399 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:16:19.957549 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:16:19.964814 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:16:19.965026 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:16:19.965235 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:16:19.966125 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:16:19.966284 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:16:19.968042 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:16:19.968297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c756387a-96c1-49d8-97a5-b6d420099ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70e9d810>]}
[0m22:16:19.968638 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:16:19.968976 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:16:19.969601 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:19.969785 [debug] [MainThread]: On master: BEGIN
[0m22:16:19.970078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:16:19.973188 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:16:19.973373 [debug] [MainThread]: On master: COMMIT
[0m22:16:19.973538 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:19.973698 [debug] [MainThread]: On master: COMMIT
[0m22:16:19.973980 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:16:19.974148 [debug] [MainThread]: On master: Close
[0m22:16:19.974806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:19.975011 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:16:19.975167 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:16:19.975316 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:16:19.975519 [info ] [MainThread]: 
[0m22:16:19.975731 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:16:19.976147 [debug] [MainThread]: Command end result
[0m22:16:19.990532 [info ] [MainThread]: 
[0m22:16:19.990802 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:16:19.991016 [info ] [MainThread]: 
[0m22:16:19.991255 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:16:19.991533 [info ] [MainThread]: 
[0m22:16:19.992026 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:16:19.992204 [info ] [MainThread]: 
[0m22:16:19.992372 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:16:19.992526 [info ] [MainThread]: 
[0m22:16:19.992686 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:16:19.993086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3862686, "process_user_time": 0.762205, "process_kernel_time": 0.075715, "process_mem_max_rss": "252912", "process_out_blocks": "1834", "command_success": false, "process_in_blocks": "0"}
[0m22:16:19.993308 [debug] [MainThread]: Command `dbt run` failed at 22:16:19.993273 after 0.39 seconds
[0m22:16:19.993476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8f90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8f9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ca3d90>]}
[0m22:16:19.993627 [debug] [MainThread]: Flushing usage events
[0m22:16:33.773894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9fed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7f8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7f0b90>]}


============================== 22:16:33.774964 | 44b169ae-8ffe-45a9-a1aa-39b1614bf69b ==============================
[0m22:16:33.774964 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:16:33.775346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:16:33.845936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44b169ae-8ffe-45a9-a1aa-39b1614bf69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c88ce50>]}
[0m22:16:33.863696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44b169ae-8ffe-45a9-a1aa-39b1614bf69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec03190>]}
[0m22:16:33.864054 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:16:33.888579 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:16:33.934287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:33.934571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:33.951842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44b169ae-8ffe-45a9-a1aa-39b1614bf69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73bf4d50>]}
[0m22:16:33.994519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44b169ae-8ffe-45a9-a1aa-39b1614bf69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff739c8750>]}
[0m22:16:33.994795 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:16:33.995095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44b169ae-8ffe-45a9-a1aa-39b1614bf69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73d5f550>]}
[0m22:16:33.995860 [info ] [MainThread]: 
[0m22:16:33.996176 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:16:33.998126 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:16:34.011424 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:16:34.011671 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:16:34.011866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:34.015811 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:16:34.016408 [debug] [ThreadPool]: On list_thrive: Close
[0m22:16:34.017450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:16:34.017705 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:16:34.020161 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:16:34.020367 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:16:34.020571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:34.023285 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:16:34.023816 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:16:34.024016 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:16:34.024277 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:16:34.024464 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:16:34.024638 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:16:34.024943 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:16:34.025284 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:16:34.025455 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:16:34.025615 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:16:34.025880 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:16:34.026062 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:16:34.027198 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:16:34.029171 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:16:34.029342 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:16:34.029496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:34.032487 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:16:34.032672 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:16:34.032854 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:16:34.040958 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:16:34.041536 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:16:34.041895 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:16:34.042082 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:16:34.043353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44b169ae-8ffe-45a9-a1aa-39b1614bf69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73cbf990>]}
[0m22:16:34.043573 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:34.043751 [debug] [MainThread]: On master: BEGIN
[0m22:16:34.043946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:34.047049 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:16:34.047347 [debug] [MainThread]: On master: COMMIT
[0m22:16:34.047540 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:34.047723 [debug] [MainThread]: On master: COMMIT
[0m22:16:34.048071 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:16:34.048303 [debug] [MainThread]: On master: Close
[0m22:16:34.049022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:16:34.049245 [info ] [MainThread]: 
[0m22:16:34.050407 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:16:34.050672 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:16:34.050959 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:16:34.051169 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:16:34.053966 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:16:34.054459 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:16:34.066305 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:16:34.066791 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:16:34.067026 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:16:34.067267 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:16:34.070250 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:16:34.070437 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:16:34.070592 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:16:34.077446 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:16:34.077670 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:16:34.077996 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:16:34.079449 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:16:34.079652 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:16:34.081505 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:16:34.082284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b169ae-8ffe-45a9-a1aa-39b1614bf69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72efb3d0>]}
[0m22:16:34.082617 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:16:34.082948 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:16:34.083213 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:16:34.083702 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:16:34.083970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:16:34.084183 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:16:34.085358 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:16:34.085841 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:16:34.087137 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:16:34.087633 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:16:34.087853 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:16:34.088054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:34.090944 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:16:34.091139 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:16:34.091300 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:16:34.091551 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:16:34.091697 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:16:34.091886 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:16:34.092786 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:16:34.092984 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:16:34.094491 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:16:34.094700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b169ae-8ffe-45a9-a1aa-39b1614bf69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72ea1590>]}
[0m22:16:34.094972 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:16:34.095257 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:16:34.095473 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:16:34.095728 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:16:34.095940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:16:34.096113 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:16:34.097307 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:16:34.098004 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:16:34.099506 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:16:34.100028 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:16:34.100236 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:16:34.100430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:34.103466 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:16:34.103664 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:16:34.103869 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:16:34.111664 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:16:34.111906 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:16:34.112116 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:16:34.112994 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:16:34.113159 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:16:34.114949 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:16:34.115207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b169ae-8ffe-45a9-a1aa-39b1614bf69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f8d6d0>]}
[0m22:16:34.115495 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:16:34.115760 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:16:34.116391 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:34.116594 [debug] [MainThread]: On master: BEGIN
[0m22:16:34.116755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:16:34.119704 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:16:34.119876 [debug] [MainThread]: On master: COMMIT
[0m22:16:34.120024 [debug] [MainThread]: Using duckdb connection "master"
[0m22:16:34.120188 [debug] [MainThread]: On master: COMMIT
[0m22:16:34.120613 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:16:34.120911 [debug] [MainThread]: On master: Close
[0m22:16:34.121715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:34.121949 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:16:34.122105 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:16:34.122249 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:16:34.122434 [info ] [MainThread]: 
[0m22:16:34.122608 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:16:34.122989 [debug] [MainThread]: Command end result
[0m22:16:34.137202 [info ] [MainThread]: 
[0m22:16:34.137431 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:16:34.137605 [info ] [MainThread]: 
[0m22:16:34.137786 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:16:34.137993 [info ] [MainThread]: 
[0m22:16:34.138365 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:16:34.138619 [info ] [MainThread]: 
[0m22:16:34.138816 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:16:34.139004 [info ] [MainThread]: 
[0m22:16:34.139182 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:16:34.139580 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38305467, "process_user_time": 0.759366, "process_kernel_time": 0.069399, "process_mem_max_rss": "252712", "process_out_blocks": "1834", "command_success": false, "process_in_blocks": "0"}
[0m22:16:34.139791 [debug] [MainThread]: Command `dbt run` failed at 22:16:34.139760 after 0.38 seconds
[0m22:16:34.139968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb6f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8159de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7f3ed0>]}
[0m22:16:34.140177 [debug] [MainThread]: Flushing usage events
[0m22:17:21.883920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f08890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3e8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f27e10>]}


============================== 22:17:21.885102 | 22a073be-e6db-4434-b465-5030a420147f ==============================
[0m22:17:21.885102 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:17:21.885449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:17:21.956588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a073be-e6db-4434-b465-5030a420147f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f031d0>]}
[0m22:17:21.974975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a073be-e6db-4434-b465-5030a420147f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b30f450>]}
[0m22:17:21.975336 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:17:21.999975 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:17:22.044844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:22.045093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:22.062152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22a073be-e6db-4434-b465-5030a420147f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80304e10>]}
[0m22:17:22.104317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22a073be-e6db-4434-b465-5030a420147f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800e3f90>]}
[0m22:17:22.104596 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:17:22.104781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a073be-e6db-4434-b465-5030a420147f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8041aa50>]}
[0m22:17:22.105590 [info ] [MainThread]: 
[0m22:17:22.105908 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:17:22.107768 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:17:22.120718 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:17:22.120970 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:17:22.121188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:22.125159 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:17:22.125707 [debug] [ThreadPool]: On list_thrive: Close
[0m22:17:22.126788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:17:22.127135 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:17:22.129784 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:17:22.129979 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:17:22.130146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:22.132971 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:17:22.133543 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:17:22.133725 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:17:22.133992 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:17:22.134170 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:17:22.134335 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:17:22.134816 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:17:22.135271 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:17:22.135485 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:17:22.135652 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:17:22.135974 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:17:22.136207 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:17:22.137445 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:17:22.139556 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:17:22.139744 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:17:22.139900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:22.142776 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:17:22.142959 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:17:22.143122 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:17:22.151401 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:17:22.151965 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:17:22.152311 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:17:22.152495 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:17:22.153650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a073be-e6db-4434-b465-5030a420147f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89945210>]}
[0m22:17:22.153880 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:22.154046 [debug] [MainThread]: On master: BEGIN
[0m22:17:22.154203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:22.157002 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:17:22.157181 [debug] [MainThread]: On master: COMMIT
[0m22:17:22.157343 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:22.157519 [debug] [MainThread]: On master: COMMIT
[0m22:17:22.157783 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:17:22.157958 [debug] [MainThread]: On master: Close
[0m22:17:22.158677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:17:22.158898 [info ] [MainThread]: 
[0m22:17:22.160091 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:17:22.160375 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:17:22.160660 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:17:22.160856 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:17:22.163750 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:17:22.164229 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:17:22.176644 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:17:22.177483 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:17:22.177732 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:17:22.177938 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:17:22.181072 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:17:22.181314 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:17:22.181534 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:17:22.188540 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:17:22.188852 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:17:22.189199 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:17:22.190554 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:17:22.190768 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:17:22.192360 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:17:22.193058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a073be-e6db-4434-b465-5030a420147f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fa8810>]}
[0m22:17:22.193422 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:17:22.193726 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:17:22.193995 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:17:22.194507 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:17:22.194826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:17:22.195045 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:17:22.196289 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:17:22.196844 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:17:22.198251 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:17:22.198698 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:17:22.198870 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:17:22.199030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:22.202091 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:17:22.202403 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:17:22.202635 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:17:22.202968 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:17:22.203182 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:17:22.203472 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:17:22.204361 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:17:22.204568 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:17:22.206115 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:17:22.206337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a073be-e6db-4434-b465-5030a420147f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80347490>]}
[0m22:17:22.207002 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:17:22.207330 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:17:22.207569 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:17:22.207873 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:17:22.208182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:17:22.208543 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:17:22.209874 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:17:22.210390 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:17:22.211709 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:17:22.212062 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:17:22.212243 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:17:22.212405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:22.215353 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:17:22.215543 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:17:22.215724 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:17:22.222731 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:17:22.222933 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:17:22.223147 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:17:22.224053 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:17:22.224212 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:17:22.226002 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:17:22.226255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a073be-e6db-4434-b465-5030a420147f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5f1850>]}
[0m22:17:22.226567 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:17:22.226870 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:17:22.227684 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:22.227983 [debug] [MainThread]: On master: BEGIN
[0m22:17:22.228176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:22.231404 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:17:22.231591 [debug] [MainThread]: On master: COMMIT
[0m22:17:22.231772 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:22.231929 [debug] [MainThread]: On master: COMMIT
[0m22:17:22.232342 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:17:22.232641 [debug] [MainThread]: On master: Close
[0m22:17:22.233330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:22.233539 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:17:22.233704 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:17:22.233861 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:17:22.234066 [info ] [MainThread]: 
[0m22:17:22.234278 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:17:22.234703 [debug] [MainThread]: Command end result
[0m22:17:22.249135 [info ] [MainThread]: 
[0m22:17:22.249357 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:17:22.249528 [info ] [MainThread]: 
[0m22:17:22.249867 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:17:22.250099 [info ] [MainThread]: 
[0m22:17:22.250277 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:17:22.250438 [info ] [MainThread]: 
[0m22:17:22.250720 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:17:22.250993 [info ] [MainThread]: 
[0m22:17:22.251201 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:17:22.251640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38499567, "process_user_time": 0.767124, "process_kernel_time": 0.063423, "process_mem_max_rss": "252768", "process_out_blocks": "1834", "command_success": false, "process_in_blocks": "0"}
[0m22:17:22.251863 [debug] [MainThread]: Command `dbt run` failed at 22:17:22.251831 after 0.39 seconds
[0m22:17:22.252059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f26cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dcade90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f03c90>]}
[0m22:17:22.252234 [debug] [MainThread]: Flushing usage events
[0m22:17:36.024250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95968750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95968910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959aff90>]}


============================== 22:17:36.025401 | 832c3833-f3d6-4a67-a9aa-e7c1f7705ea9 ==============================
[0m22:17:36.025401 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:17:36.025810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:36.096984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '832c3833-f3d6-4a67-a9aa-e7c1f7705ea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959fcc50>]}
[0m22:17:36.114742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '832c3833-f3d6-4a67-a9aa-e7c1f7705ea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d73110>]}
[0m22:17:36.115103 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:17:36.139478 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:17:36.184526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:36.184767 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:36.201672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '832c3833-f3d6-4a67-a9aa-e7c1f7705ea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd95990>]}
[0m22:17:36.243660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '832c3833-f3d6-4a67-a9aa-e7c1f7705ea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb43f90>]}
[0m22:17:36.243918 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:17:36.244212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '832c3833-f3d6-4a67-a9aa-e7c1f7705ea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce8df10>]}
[0m22:17:36.245010 [info ] [MainThread]: 
[0m22:17:36.245338 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:17:36.247225 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:17:36.260284 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:17:36.260533 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:17:36.260708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:36.264715 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:17:36.265236 [debug] [ThreadPool]: On list_thrive: Close
[0m22:17:36.266313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:17:36.266676 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:17:36.269233 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:17:36.269415 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:17:36.269627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:36.272519 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:17:36.273053 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:17:36.273219 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:17:36.273520 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:17:36.273706 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:17:36.273868 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:17:36.274150 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:17:36.274554 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:17:36.274747 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:17:36.275056 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:17:36.275408 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:17:36.275601 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:17:36.276685 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:17:36.278688 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:17:36.278861 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:17:36.279030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:36.281983 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:17:36.282162 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:17:36.282331 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:17:36.290399 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:17:36.290975 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:17:36.291308 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:17:36.291512 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:17:36.292596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '832c3833-f3d6-4a67-a9aa-e7c1f7705ea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b72c50>]}
[0m22:17:36.292843 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:36.293014 [debug] [MainThread]: On master: BEGIN
[0m22:17:36.293176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:36.296181 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:17:36.296506 [debug] [MainThread]: On master: COMMIT
[0m22:17:36.296700 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:36.296873 [debug] [MainThread]: On master: COMMIT
[0m22:17:36.297141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:17:36.297312 [debug] [MainThread]: On master: Close
[0m22:17:36.299141 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:17:36.299430 [info ] [MainThread]: 
[0m22:17:36.300669 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:17:36.300944 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:17:36.301239 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:17:36.301429 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:17:36.304274 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:17:36.304761 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:17:36.316630 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:17:36.317142 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:17:36.317327 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:17:36.317530 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:17:36.320448 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:17:36.320628 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:17:36.320813 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:17:36.327804 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:17:36.328104 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:17:36.328454 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:17:36.329755 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:17:36.329949 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:17:36.331770 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:17:36.332530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '832c3833-f3d6-4a67-a9aa-e7c1f7705ea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c036a50>]}
[0m22:17:36.332861 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:17:36.333199 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:17:36.333448 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:17:36.333939 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:17:36.334199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:17:36.334398 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:17:36.335608 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:17:36.336084 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:17:36.337375 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:17:36.337747 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:17:36.337922 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:17:36.338068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:36.340819 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:17:36.340988 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:17:36.341162 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:17:36.341404 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:17:36.341584 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:17:36.341806 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:17:36.342638 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:17:36.342795 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:17:36.344170 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:17:36.344380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '832c3833-f3d6-4a67-a9aa-e7c1f7705ea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce33fd0>]}
[0m22:17:36.344647 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:17:36.344891 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:17:36.345086 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:17:36.345321 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:17:36.345539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:17:36.345706 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:17:36.346962 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:17:36.347376 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:17:36.348786 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:17:36.349247 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:17:36.349434 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:17:36.349591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:36.352510 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:17:36.352819 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:17:36.353014 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:17:36.360538 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:17:36.360774 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:17:36.361004 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:17:36.361940 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:17:36.362167 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:17:36.364444 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:17:36.364690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '832c3833-f3d6-4a67-a9aa-e7c1f7705ea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c036a50>]}
[0m22:17:36.364968 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:17:36.365214 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:17:36.366027 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:36.366237 [debug] [MainThread]: On master: BEGIN
[0m22:17:36.366411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:36.369389 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:17:36.369577 [debug] [MainThread]: On master: COMMIT
[0m22:17:36.369729 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:36.369862 [debug] [MainThread]: On master: COMMIT
[0m22:17:36.370060 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:17:36.370226 [debug] [MainThread]: On master: Close
[0m22:17:36.371065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:36.371306 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:17:36.371472 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:17:36.371599 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:17:36.371786 [info ] [MainThread]: 
[0m22:17:36.371967 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:17:36.372359 [debug] [MainThread]: Command end result
[0m22:17:36.386478 [info ] [MainThread]: 
[0m22:17:36.386838 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:17:36.387101 [info ] [MainThread]: 
[0m22:17:36.387360 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:17:36.387617 [info ] [MainThread]: 
[0m22:17:36.387805 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:17:36.387952 [info ] [MainThread]: 
[0m22:17:36.388112 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:17:36.388261 [info ] [MainThread]: 
[0m22:17:36.388433 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:17:36.388825 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38132447, "process_user_time": 0.765897, "process_kernel_time": 0.061991, "process_mem_max_rss": "252704", "process_out_blocks": "1834", "command_success": false, "process_in_blocks": "0"}
[0m22:17:36.389030 [debug] [MainThread]: Command `dbt run` failed at 22:17:36.388998 after 0.38 seconds
[0m22:17:36.389194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0875d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5b9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95963cd0>]}
[0m22:17:36.389346 [debug] [MainThread]: Flushing usage events
[0m22:18:23.752158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b348c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b760c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b341890>]}


============================== 22:18:23.753430 | 45532073-fb72-4a25-8eb6-0af3d094d348 ==============================
[0m22:18:23.753430 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:18:23.753866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:18:23.829379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45532073-fb72-4a25-8eb6-0af3d094d348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3f8dd0>]}
[0m22:18:23.849446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45532073-fb72-4a25-8eb6-0af3d094d348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d753490>]}
[0m22:18:23.849962 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:18:23.878167 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:18:23.924958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:23.925257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:23.942892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45532073-fb72-4a25-8eb6-0af3d094d348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82744690>]}
[0m22:18:23.988242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45532073-fb72-4a25-8eb6-0af3d094d348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825033d0>]}
[0m22:18:23.988563 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:18:23.988885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45532073-fb72-4a25-8eb6-0af3d094d348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82861f50>]}
[0m22:18:23.989700 [info ] [MainThread]: 
[0m22:18:23.990075 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:18:23.992406 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:18:24.006330 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:18:24.006714 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:18:24.006922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:24.011410 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:18:24.012048 [debug] [ThreadPool]: On list_thrive: Close
[0m22:18:24.013002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:18:24.013248 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:18:24.016116 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:18:24.016319 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:18:24.016469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:24.019302 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:18:24.019877 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:18:24.020037 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:18:24.020312 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:18:24.020465 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:18:24.020620 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:18:24.020887 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:18:24.021279 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:18:24.021460 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:18:24.021623 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:18:24.021870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:18:24.022044 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:18:24.023221 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:18:24.025554 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:18:24.025804 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:18:24.025972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:24.029342 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:18:24.029514 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:18:24.029678 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:18:24.038503 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:18:24.039440 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:18:24.039846 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:18:24.040008 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:18:24.041426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45532073-fb72-4a25-8eb6-0af3d094d348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a33bd0>]}
[0m22:18:24.041733 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:24.041914 [debug] [MainThread]: On master: BEGIN
[0m22:18:24.042056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:24.045427 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:18:24.045713 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.045935 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:24.046094 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.046401 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:18:24.046648 [debug] [MainThread]: On master: Close
[0m22:18:24.047415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:18:24.047615 [info ] [MainThread]: 
[0m22:18:24.049065 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:18:24.049383 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:18:24.049661 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:18:24.049873 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:18:24.052858 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:18:24.053261 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:18:24.066031 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:18:24.066515 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:18:24.066702 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:18:24.066871 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:18:24.070324 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:18:24.070605 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:18:24.070860 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:18:24.078757 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:18:24.079010 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:18:24.079280 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:18:24.080689 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:18:24.080906 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:18:24.082643 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:18:24.083430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45532073-fb72-4a25-8eb6-0af3d094d348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81943ed0>]}
[0m22:18:24.083799 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:18:24.084098 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:18:24.084339 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:18:24.084877 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:18:24.085135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:18:24.085355 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:18:24.086654 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:18:24.087088 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:18:24.088605 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:18:24.089215 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:18:24.089414 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:18:24.089584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:24.092904 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:18:24.093128 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:18:24.093309 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:18:24.093567 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:18:24.093737 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:18:24.093956 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:18:24.094922 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:18:24.095101 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:18:24.096419 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:18:24.096650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45532073-fb72-4a25-8eb6-0af3d094d348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c99a950>]}
[0m22:18:24.096948 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:18:24.097217 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:18:24.097442 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:18:24.097712 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:18:24.097998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:18:24.098192 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:18:24.099552 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:18:24.100118 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:18:24.101584 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:18:24.101982 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:18:24.102196 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:18:24.102371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:24.105558 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:18:24.105795 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:18:24.105995 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:18:24.113223 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:18:24.113480 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:18:24.113729 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:18:24.114726 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:18:24.114932 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:18:24.116815 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:18:24.117072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45532073-fb72-4a25-8eb6-0af3d094d348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a6bb90>]}
[0m22:18:24.117345 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:18:24.117601 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:18:24.118266 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:24.118460 [debug] [MainThread]: On master: BEGIN
[0m22:18:24.118608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:24.121620 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:18:24.121832 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.121980 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:24.122116 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.122319 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:18:24.122469 [debug] [MainThread]: On master: Close
[0m22:18:24.123185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:24.123345 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:18:24.123464 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:18:24.123577 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:18:24.123821 [info ] [MainThread]: 
[0m22:18:24.124081 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:18:24.124505 [debug] [MainThread]: Command end result
[0m22:18:24.139782 [info ] [MainThread]: 
[0m22:18:24.140070 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:18:24.140284 [info ] [MainThread]: 
[0m22:18:24.140678 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:18:24.140873 [info ] [MainThread]: 
[0m22:18:24.141056 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:18:24.141215 [info ] [MainThread]: 
[0m22:18:24.141411 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:18:24.141593 [info ] [MainThread]: 
[0m22:18:24.141768 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:18:24.142221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.40803882, "process_user_time": 0.79743, "process_kernel_time": 0.073947, "process_mem_max_rss": "252708", "process_out_blocks": "1834", "command_success": false, "process_in_blocks": "0"}
[0m22:18:24.142468 [debug] [MainThread]: Command `dbt run` failed at 22:18:24.142426 after 0.41 seconds
[0m22:18:24.142685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff99010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff990d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b343e10>]}
[0m22:18:24.142868 [debug] [MainThread]: Flushing usage events
[0m22:23:00.575174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83388890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8358e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83381850>]}


============================== 22:23:00.576542 | 9366def5-a35e-4182-9437-139411b7b1aa ==============================
[0m22:23:00.576542 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:23:00.576966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:23:00.653121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9366def5-a35e-4182-9437-139411b7b1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8340d250>]}
[0m22:23:00.672378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9366def5-a35e-4182-9437-139411b7b1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85792b50>]}
[0m22:23:00.672771 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:23:00.699128 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:23:00.748006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:23:00.748257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:23:00.766204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9366def5-a35e-4182-9437-139411b7b1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a807d90>]}
[0m22:23:00.810113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9366def5-a35e-4182-9437-139411b7b1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a563f50>]}
[0m22:23:00.810390 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:23:00.810677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9366def5-a35e-4182-9437-139411b7b1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a899910>]}
[0m22:23:00.811465 [info ] [MainThread]: 
[0m22:23:00.811753 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:23:00.813750 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:23:00.827623 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:23:00.827872 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:23:00.828061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:00.832366 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:23:00.832968 [debug] [ThreadPool]: On list_thrive: Close
[0m22:23:00.833837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:23:00.834105 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:23:00.836841 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:23:00.837035 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:23:00.837208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:23:00.840150 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:23:00.840744 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:23:00.840927 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:23:00.841384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:23:00.841669 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:23:00.841876 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:23:00.842172 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:23:00.842563 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:23:00.842741 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:23:00.842916 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:23:00.843266 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:23:00.843499 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:23:00.844728 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:23:00.847027 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:23:00.847207 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:23:00.847375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:00.850736 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:23:00.851011 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:23:00.851218 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:23:00.860593 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:23:00.861295 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:23:00.861694 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:23:00.861849 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:23:00.863123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9366def5-a35e-4182-9437-139411b7b1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833e7ad0>]}
[0m22:23:00.863407 [debug] [MainThread]: Using duckdb connection "master"
[0m22:23:00.863591 [debug] [MainThread]: On master: BEGIN
[0m22:23:00.863738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:23:00.866974 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:23:00.867209 [debug] [MainThread]: On master: COMMIT
[0m22:23:00.867410 [debug] [MainThread]: Using duckdb connection "master"
[0m22:23:00.867589 [debug] [MainThread]: On master: COMMIT
[0m22:23:00.867941 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:23:00.868182 [debug] [MainThread]: On master: Close
[0m22:23:00.868945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:00.869165 [info ] [MainThread]: 
[0m22:23:00.870412 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:23:00.870702 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:23:00.870989 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:23:00.871205 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:23:00.874365 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:23:00.874960 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:23:00.887518 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:23:00.888095 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:23:00.888303 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:23:00.888501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:23:00.891516 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:23:00.891703 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:23:00.891869 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:23:00.899393 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:23:00.899834 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:23:00.900094 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:23:00.901460 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:23:00.901667 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:23:00.903964 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:23:00.904733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9366def5-a35e-4182-9437-139411b7b1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a58150>]}
[0m22:23:00.905083 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:23:00.905417 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:23:00.905653 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:23:00.906156 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:23:00.906429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:23:00.906627 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:23:00.907853 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:23:00.908338 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:23:00.909763 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:23:00.910188 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:23:00.910361 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:23:00.910514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:00.913634 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:23:00.913806 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:23:00.913962 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:23:00.914232 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:23:00.914410 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:23:00.914608 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:23:00.915508 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:23:00.915696 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:23:00.917227 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:23:00.917470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9366def5-a35e-4182-9437-139411b7b1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8342ca90>]}
[0m22:23:00.917740 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:23:00.918012 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:23:00.918216 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:23:00.918462 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:23:00.918665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:23:00.918827 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:23:00.920115 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:23:00.920626 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:23:00.922025 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:23:00.922409 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:23:00.922596 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:23:00.922753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:00.925678 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:23:00.925943 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:23:00.926128 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:23:00.933482 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:23:00.933761 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:23:00.933977 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:23:00.934896 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:23:00.935069 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:23:00.936820 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:23:00.937061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9366def5-a35e-4182-9437-139411b7b1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a38190>]}
[0m22:23:00.937334 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:23:00.937654 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:23:00.938459 [debug] [MainThread]: Using duckdb connection "master"
[0m22:23:00.938680 [debug] [MainThread]: On master: BEGIN
[0m22:23:00.938861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:23:00.942047 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:23:00.942319 [debug] [MainThread]: On master: COMMIT
[0m22:23:00.942543 [debug] [MainThread]: Using duckdb connection "master"
[0m22:23:00.942734 [debug] [MainThread]: On master: COMMIT
[0m22:23:00.943070 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:23:00.943308 [debug] [MainThread]: On master: Close
[0m22:23:00.944037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:00.944216 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:23:00.944378 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:23:00.944537 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:23:00.944751 [info ] [MainThread]: 
[0m22:23:00.944954 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:23:00.945362 [debug] [MainThread]: Command end result
[0m22:23:00.960453 [info ] [MainThread]: 
[0m22:23:00.960928 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:23:00.961312 [info ] [MainThread]: 
[0m22:23:00.961716 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:23:00.961991 [info ] [MainThread]: 
[0m22:23:00.962234 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:23:00.962447 [info ] [MainThread]: 
[0m22:23:00.962660 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:23:00.962839 [info ] [MainThread]: 
[0m22:23:00.963004 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:23:00.963439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.40737572, "process_user_time": 0.796258, "process_kernel_time": 0.073023, "process_mem_max_rss": "252696", "process_out_blocks": "1834", "command_success": false, "process_in_blocks": "0"}
[0m22:23:00.963669 [debug] [MainThread]: Command `dbt run` failed at 22:23:00.963633 after 0.41 seconds
[0m22:23:00.963862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8622d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fd9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83383e50>]}
[0m22:23:00.964043 [debug] [MainThread]: Flushing usage events
[0m22:24:02.758205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a088c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab46190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a088850>]}


============================== 22:24:02.759434 | fec6638e-8d8c-40bc-a6c1-33cec2aed60b ==============================
[0m22:24:02.759434 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:24:02.759856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:02.839875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fec6638e-8d8c-40bc-a6c1-33cec2aed60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8183f3d0>]}
[0m22:24:02.860666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fec6638e-8d8c-40bc-a6c1-33cec2aed60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c493390>]}
[0m22:24:02.861203 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:24:02.888388 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:24:02.937488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:02.937786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:02.955867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fec6638e-8d8c-40bc-a6c1-33cec2aed60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81480d50>]}
[0m22:24:03.000529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fec6638e-8d8c-40bc-a6c1-33cec2aed60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81263fd0>]}
[0m22:24:03.000842 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:24:03.001188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fec6638e-8d8c-40bc-a6c1-33cec2aed60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815f5d50>]}
[0m22:24:03.002055 [info ] [MainThread]: 
[0m22:24:03.002400 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:24:03.004500 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:24:03.018755 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:24:03.018996 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:24:03.019218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:03.023541 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:24:03.024161 [debug] [ThreadPool]: On list_thrive: Close
[0m22:24:03.025135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:24:03.025392 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:24:03.028177 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:24:03.028373 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:24:03.028565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:03.031632 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:24:03.032220 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:24:03.032404 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:24:03.032852 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:24:03.033057 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:24:03.033252 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:24:03.033690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:24:03.034223 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:24:03.034451 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:24:03.034638 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:24:03.034939 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:24:03.035149 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:24:03.036375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:24:03.038758 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:24:03.039050 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:24:03.039266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:03.042592 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:24:03.042832 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:24:03.043132 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:24:03.052228 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:24:03.052964 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:24:03.053355 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:24:03.053547 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:24:03.054752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fec6638e-8d8c-40bc-a6c1-33cec2aed60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81289c50>]}
[0m22:24:03.055044 [debug] [MainThread]: Using duckdb connection "master"
[0m22:24:03.055310 [debug] [MainThread]: On master: BEGIN
[0m22:24:03.055527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:03.058940 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:24:03.059178 [debug] [MainThread]: On master: COMMIT
[0m22:24:03.059419 [debug] [MainThread]: Using duckdb connection "master"
[0m22:24:03.059609 [debug] [MainThread]: On master: COMMIT
[0m22:24:03.059865 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:24:03.060071 [debug] [MainThread]: On master: Close
[0m22:24:03.060823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:03.061125 [info ] [MainThread]: 
[0m22:24:03.062492 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:24:03.062819 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:24:03.063134 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:24:03.063343 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:24:03.066573 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:24:03.067119 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:24:03.080030 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:24:03.080583 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:24:03.080829 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:24:03.081053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:24:03.084903 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:24:03.085134 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:24:03.085327 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:24:03.093707 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:24:03.093958 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:24:03.094245 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:24:03.095670 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:24:03.095874 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:24:03.097811 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:24:03.098544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fec6638e-8d8c-40bc-a6c1-33cec2aed60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80769310>]}
[0m22:24:03.098878 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:24:03.099197 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:24:03.099436 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:24:03.099976 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:24:03.100232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:24:03.100436 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:24:03.101725 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:24:03.102244 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:24:03.103651 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:24:03.104022 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:24:03.104219 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:24:03.104375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:03.107267 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:24:03.107441 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:24:03.107636 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:24:03.107945 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    seleect
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:24:03.108296 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:24:03.108620 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:24:03.109561 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:24:03.109739 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:24:03.111240 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:24:03.111463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fec6638e-8d8c-40bc-a6c1-33cec2aed60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80865c90>]}
[0m22:24:03.111738 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:24:03.112027 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:24:03.112231 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:24:03.112474 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:24:03.112682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:24:03.112843 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:24:03.114158 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:24:03.114581 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:24:03.116007 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:24:03.116427 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:24:03.116587 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:24:03.116757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:03.119600 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:24:03.119868 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:24:03.120115 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:24:03.127669 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:24:03.128081 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:24:03.128822 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:24:03.131182 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:24:03.131476 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:24:03.134000 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:24:03.134273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fec6638e-8d8c-40bc-a6c1-33cec2aed60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817f85d0>]}
[0m22:24:03.134604 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:24:03.134907 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:24:03.135585 [debug] [MainThread]: Using duckdb connection "master"
[0m22:24:03.135792 [debug] [MainThread]: On master: BEGIN
[0m22:24:03.135988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:03.139433 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:24:03.139663 [debug] [MainThread]: On master: COMMIT
[0m22:24:03.139860 [debug] [MainThread]: Using duckdb connection "master"
[0m22:24:03.140043 [debug] [MainThread]: On master: COMMIT
[0m22:24:03.140374 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:24:03.140595 [debug] [MainThread]: On master: Close
[0m22:24:03.141422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:03.141621 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:24:03.141808 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:24:03.141977 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:24:03.142215 [info ] [MainThread]: 
[0m22:24:03.142422 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:24:03.142849 [debug] [MainThread]: Command end result
[0m22:24:03.158717 [info ] [MainThread]: 
[0m22:24:03.158978 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:24:03.159169 [info ] [MainThread]: 
[0m22:24:03.159371 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:24:03.159585 [info ] [MainThread]: 
[0m22:24:03.159815 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Parser Error: syntax error at or near "seleect"
[0m22:24:03.159980 [info ] [MainThread]: 
[0m22:24:03.160147 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:24:03.160321 [info ] [MainThread]: 
[0m22:24:03.160514 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:24:03.160946 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.42071787, "process_user_time": 0.805492, "process_kernel_time": 0.071422, "process_mem_max_rss": "252708", "process_out_blocks": "1834", "command_success": false, "process_in_blocks": "0"}
[0m22:24:03.161195 [debug] [MainThread]: Command `dbt run` failed at 22:24:03.161155 after 0.42 seconds
[0m22:24:03.161393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81830a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee2dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a292690>]}
[0m22:24:03.161585 [debug] [MainThread]: Flushing usage events
[0m22:25:04.897554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891c5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89068690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8909e010>]}


============================== 22:25:04.898857 | ce3b8636-242d-458f-947d-669b0a5c7eeb ==============================
[0m22:25:04.898857 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:25:04.899179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:25:04.973979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890f4650>]}
[0m22:25:04.993203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4730d0>]}
[0m22:25:04.993585 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:25:05.019152 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:25:05.066106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:25:05.066455 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_sales.sql
[0m22:25:05.143890 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:25:05.144199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807dbb90>]}
[0m22:25:05.208730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807b3c10>]}
[0m22:25:05.252245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7b8150>]}
[0m22:25:05.252536 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:25:05.252721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e782910>]}
[0m22:25:05.253558 [info ] [MainThread]: 
[0m22:25:05.253850 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:25:05.255942 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:25:05.293955 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:25:05.294272 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:25:05.294515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:05.299024 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m22:25:05.299629 [debug] [ThreadPool]: On list_thrive: Close
[0m22:25:05.300695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:25:05.301047 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:25:05.303820 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:25:05.304028 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:25:05.304203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:05.307072 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:25:05.307688 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:25:05.307882 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:25:05.308293 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:25:05.308550 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:25:05.308742 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:25:05.309041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:25:05.309439 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:25:05.309630 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:25:05.309813 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:25:05.310070 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:25:05.310254 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:25:05.311392 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:25:05.313618 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:25:05.313799 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:25:05.313968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:05.317100 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:25:05.317319 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:25:05.317505 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:25:05.326327 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:25:05.326909 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:25:05.327287 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:25:05.327464 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:25:05.328805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8db150>]}
[0m22:25:05.329090 [debug] [MainThread]: Using duckdb connection "master"
[0m22:25:05.329301 [debug] [MainThread]: On master: BEGIN
[0m22:25:05.329498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:25:05.332758 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:25:05.332974 [debug] [MainThread]: On master: COMMIT
[0m22:25:05.333197 [debug] [MainThread]: Using duckdb connection "master"
[0m22:25:05.333379 [debug] [MainThread]: On master: COMMIT
[0m22:25:05.333794 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:25:05.334072 [debug] [MainThread]: On master: Close
[0m22:25:05.334962 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:25:05.335218 [info ] [MainThread]: 
[0m22:25:05.336495 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:25:05.336790 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:25:05.337084 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:25:05.337293 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:25:05.340349 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:25:05.340855 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:25:05.352843 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:25:05.353465 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:25:05.353694 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:25:05.353892 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:25:05.356873 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:25:05.357075 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:25:05.357257 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:25:05.365220 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:25:05.365441 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:25:05.365687 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:25:05.367109 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:25:05.367342 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:25:05.369044 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:25:05.369730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7b9450>]}
[0m22:25:05.370041 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:25:05.370354 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:25:05.370588 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:25:05.371100 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:25:05.371364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:25:05.371562 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:25:05.372776 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:25:05.373250 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:25:05.374656 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:25:05.375104 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:25:05.375301 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:25:05.375487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:05.378261 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:25:05.378492 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:25:05.378671 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:25:05.385993 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:25:05.386228 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:25:05.386472 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:25:05.387433 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:25:05.387625 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:25:05.389364 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:25:05.389613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890b26d0>]}
[0m22:25:05.389903 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.02s]
[0m22:25:05.390195 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:25:05.390518 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:25:05.390802 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:25:05.391038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:25:05.391255 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:25:05.393171 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:25:05.393638 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:25:05.394951 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:25:05.395379 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:25:05.395573 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:25:05.395755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:05.398850 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:25:05.399035 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:25:05.399217 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:25:05.406439 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:25:05.406667 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:25:05.406903 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:25:05.407829 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:25:05.408022 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:25:05.409864 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:25:05.410196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce3b8636-242d-458f-947d-669b0a5c7eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80401f50>]}
[0m22:25:05.410495 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:25:05.410783 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:25:05.411511 [debug] [MainThread]: Using duckdb connection "master"
[0m22:25:05.411717 [debug] [MainThread]: On master: BEGIN
[0m22:25:05.411891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:25:05.414938 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:25:05.415128 [debug] [MainThread]: On master: COMMIT
[0m22:25:05.415319 [debug] [MainThread]: Using duckdb connection "master"
[0m22:25:05.415489 [debug] [MainThread]: On master: COMMIT
[0m22:25:05.415713 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:25:05.415893 [debug] [MainThread]: On master: Close
[0m22:25:05.416868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:25:05.417119 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:25:05.417316 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:25:05.417478 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:25:05.417691 [info ] [MainThread]: 
[0m22:25:05.417899 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m22:25:05.418315 [debug] [MainThread]: Command end result
[0m22:25:05.432681 [info ] [MainThread]: 
[0m22:25:05.432904 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:25:05.433135 [info ] [MainThread]: 
[0m22:25:05.433484 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:25:05.433842 [info ] [MainThread]: 
[0m22:25:05.434115 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:25:05.434363 [info ] [MainThread]: 
[0m22:25:05.434555 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:25:05.434715 [info ] [MainThread]: 
[0m22:25:05.434883 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:25:05.435304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.55571824, "process_user_time": 0.941655, "process_kernel_time": 0.073519, "process_mem_max_rss": "252720", "process_out_blocks": "2700", "command_success": false, "process_in_blocks": "0"}
[0m22:25:05.435535 [debug] [MainThread]: Command `dbt run` failed at 22:25:05.435501 after 0.56 seconds
[0m22:25:05.435735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8906a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8909e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9cbb90>]}
[0m22:25:05.435915 [debug] [MainThread]: Flushing usage events
[0m22:26:07.082682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb08390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb27e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf18c90>]}


============================== 22:26:07.083989 | 9babc6dc-d012-443c-b118-5f5fcfd17476 ==============================
[0m22:26:07.083989 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:26:07.084423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:26:07.160097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb02dd0>]}
[0m22:26:07.179151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df12d50>]}
[0m22:26:07.179548 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:26:07.206050 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:26:07.254307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:26:07.254796 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/sources.yml
[0m22:26:07.336562 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:26:07.336926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb95290>]}
[0m22:26:07.438540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9302e210>]}
[0m22:26:07.508178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e84410>]}
[0m22:26:07.508527 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:26:07.508868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92da4690>]}
[0m22:26:07.509747 [info ] [MainThread]: 
[0m22:26:07.510112 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:26:07.512238 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:26:07.525771 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:26:07.526039 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:26:07.526234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:07.530852 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m22:26:07.531451 [debug] [ThreadPool]: On list_thrive: Close
[0m22:26:07.532711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:26:07.533056 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:26:07.535915 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:26:07.536113 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:26:07.536311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:07.539347 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:26:07.539918 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:26:07.540104 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:26:07.540381 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:26:07.540550 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:26:07.540722 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:26:07.541098 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:26:07.541574 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:26:07.541781 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:26:07.541953 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:26:07.542280 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:26:07.542510 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:26:07.543730 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:26:07.546222 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:26:07.546414 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:26:07.546594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:07.549313 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:26:07.549508 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:26:07.549741 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:26:07.558620 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:26:07.559264 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:26:07.559659 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:26:07.559844 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:26:07.561083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90717a10>]}
[0m22:26:07.561348 [debug] [MainThread]: Using duckdb connection "master"
[0m22:26:07.561523 [debug] [MainThread]: On master: BEGIN
[0m22:26:07.561706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:07.565003 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:26:07.565214 [debug] [MainThread]: On master: COMMIT
[0m22:26:07.565389 [debug] [MainThread]: Using duckdb connection "master"
[0m22:26:07.565583 [debug] [MainThread]: On master: COMMIT
[0m22:26:07.566023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:26:07.566325 [debug] [MainThread]: On master: Close
[0m22:26:07.567070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:26:07.567286 [info ] [MainThread]: 
[0m22:26:07.568595 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:26:07.568907 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:26:07.569200 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:26:07.569411 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:26:07.572722 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:26:07.573202 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:26:07.585387 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:26:07.586078 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:26:07.586300 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:26:07.586505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:26:07.590157 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:26:07.590451 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:26:07.590649 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:26:07.598537 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:26:07.598774 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:26:07.599040 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:26:07.600514 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:26:07.600712 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:26:07.602433 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:26:07.603135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91390710>]}
[0m22:26:07.603460 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:26:07.603772 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:26:07.604006 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:26:07.604560 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:26:07.604816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:26:07.605019 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:26:07.606311 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:26:07.606805 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:26:07.608199 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:26:07.608652 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:26:07.608845 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:26:07.609023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:07.612030 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:26:07.612211 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:26:07.612367 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:26:07.620159 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:26:07.620399 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:26:07.620655 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:26:07.621610 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:26:07.621830 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:26:07.623549 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:26:07.623799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92eb3410>]}
[0m22:26:07.624126 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.02s]
[0m22:26:07.624429 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:26:07.624671 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:26:07.624960 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:26:07.625205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:26:07.625413 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:26:07.626547 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:26:07.627027 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:26:07.628368 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:26:07.628806 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:26:07.628986 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:26:07.629166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:07.632431 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:26:07.632652 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:26:07.632823 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:26:07.640312 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:26:07.640582 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:26:07.640834 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:26:07.641792 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:26:07.642009 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:26:07.643751 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:26:07.643988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9babc6dc-d012-443c-b118-5f5fcfd17476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90737910>]}
[0m22:26:07.644281 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:26:07.644586 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:26:07.645398 [debug] [MainThread]: Using duckdb connection "master"
[0m22:26:07.645620 [debug] [MainThread]: On master: BEGIN
[0m22:26:07.645828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:07.649002 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:26:07.649204 [debug] [MainThread]: On master: COMMIT
[0m22:26:07.649378 [debug] [MainThread]: Using duckdb connection "master"
[0m22:26:07.649582 [debug] [MainThread]: On master: COMMIT
[0m22:26:07.650003 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:26:07.650303 [debug] [MainThread]: On master: Close
[0m22:26:07.651108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:07.651327 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:26:07.651508 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:26:07.651680 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:26:07.651897 [info ] [MainThread]: 
[0m22:26:07.652105 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:26:07.652530 [debug] [MainThread]: Command end result
[0m22:26:07.667805 [info ] [MainThread]: 
[0m22:26:07.668286 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:26:07.668654 [info ] [MainThread]: 
[0m22:26:07.669044 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:26:07.669265 [info ] [MainThread]: 
[0m22:26:07.669460 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:26:07.669623 [info ] [MainThread]: 
[0m22:26:07.669868 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:26:07.670074 [info ] [MainThread]: 
[0m22:26:07.670252 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:26:07.670699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.60633856, "process_user_time": 0.994222, "process_kernel_time": 0.070873, "process_mem_max_rss": "252608", "process_out_blocks": "2696", "command_success": false, "process_in_blocks": "0"}
[0m22:26:07.670941 [debug] [MainThread]: Command `dbt run` failed at 22:26:07.670906 after 0.61 seconds
[0m22:26:07.671150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb52f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb51390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0759010>]}
[0m22:26:07.671337 [debug] [MainThread]: Flushing usage events
[0m22:26:45.218787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9df0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9df10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9df8750>]}


============================== 22:26:45.219945 | a16e8120-69b0-468a-bb94-269577bd7267 ==============================
[0m22:26:45.219945 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:26:45.220354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:26:45.290975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a16e8120-69b0-468a-bb94-269577bd7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e92410>]}
[0m22:26:45.308689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a16e8120-69b0-468a-bb94-269577bd7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac203050>]}
[0m22:26:45.309062 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:26:45.333932 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:26:45.380218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:26:45.380470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:26:45.397436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a16e8120-69b0-468a-bb94-269577bd7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa154d1d0>]}
[0m22:26:45.439950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a16e8120-69b0-468a-bb94-269577bd7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0fcff50>]}
[0m22:26:45.440259 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:26:45.440566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a16e8120-69b0-468a-bb94-269577bd7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa135f150>]}
[0m22:26:45.441403 [info ] [MainThread]: 
[0m22:26:45.441743 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:26:45.443723 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:26:45.457177 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:26:45.457415 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:26:45.457590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:45.461679 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:26:45.462230 [debug] [ThreadPool]: On list_thrive: Close
[0m22:26:45.463132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:26:45.463365 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:26:45.465843 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:26:45.466015 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:26:45.466175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:45.468949 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:26:45.469466 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:26:45.469634 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:26:45.470080 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:26:45.470357 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:26:45.470539 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:26:45.470853 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:26:45.471196 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:26:45.471363 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:26:45.471520 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:26:45.471798 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:26:45.472015 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:26:45.473194 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:26:45.475309 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:26:45.475485 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:26:45.475646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:45.478731 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:26:45.478910 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:26:45.479091 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:26:45.487191 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:26:45.487768 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:26:45.488115 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:26:45.488291 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:26:45.489421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a16e8120-69b0-468a-bb94-269577bd7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1568050>]}
[0m22:26:45.489657 [debug] [MainThread]: Using duckdb connection "master"
[0m22:26:45.489847 [debug] [MainThread]: On master: BEGIN
[0m22:26:45.490020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:45.493109 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:26:45.493289 [debug] [MainThread]: On master: COMMIT
[0m22:26:45.493456 [debug] [MainThread]: Using duckdb connection "master"
[0m22:26:45.493617 [debug] [MainThread]: On master: COMMIT
[0m22:26:45.493870 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:26:45.494076 [debug] [MainThread]: On master: Close
[0m22:26:45.495000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:26:45.495331 [info ] [MainThread]: 
[0m22:26:45.496625 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:26:45.496939 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:26:45.497234 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:26:45.497423 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:26:45.500280 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:26:45.500803 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:26:45.512554 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:26:45.513126 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:26:45.513319 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:26:45.513490 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:26:45.516773 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:26:45.516955 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:26:45.517121 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:26:45.524093 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:26:45.524362 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:26:45.524817 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:26:45.526137 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:26:45.526334 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:26:45.528266 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:26:45.529048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16e8120-69b0-468a-bb94-269577bd7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1435010>]}
[0m22:26:45.529375 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:26:45.529679 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:26:45.529914 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:26:45.530372 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:26:45.530639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:26:45.530838 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:26:45.531971 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:26:45.532423 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:26:45.533736 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:26:45.534235 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:26:45.534431 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:26:45.534615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:45.537534 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:26:45.537747 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:26:45.537906 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:26:45.545458 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:26:45.545693 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:26:45.545918 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:26:45.546815 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:26:45.546992 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:26:45.548604 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:26:45.548828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16e8120-69b0-468a-bb94-269577bd7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1376390>]}
[0m22:26:45.549128 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.02s]
[0m22:26:45.549393 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:26:45.549599 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:26:45.549855 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:26:45.550072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:26:45.550242 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:26:45.551388 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:26:45.551757 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:26:45.553026 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:26:45.553405 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:26:45.553571 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:26:45.553713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:45.556564 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:26:45.556897 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:26:45.557105 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:26:45.563922 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:26:45.564103 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:26:45.564308 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:26:45.565251 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:26:45.565405 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:26:45.567126 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:26:45.567390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16e8120-69b0-468a-bb94-269577bd7267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa04cba90>]}
[0m22:26:45.567675 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:26:45.567997 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:26:45.568646 [debug] [MainThread]: Using duckdb connection "master"
[0m22:26:45.568846 [debug] [MainThread]: On master: BEGIN
[0m22:26:45.569032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:45.571984 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:26:45.572172 [debug] [MainThread]: On master: COMMIT
[0m22:26:45.572336 [debug] [MainThread]: Using duckdb connection "master"
[0m22:26:45.572497 [debug] [MainThread]: On master: COMMIT
[0m22:26:45.572723 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:26:45.572893 [debug] [MainThread]: On master: Close
[0m22:26:45.573815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:45.574092 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:26:45.574276 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:26:45.574431 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:26:45.574645 [info ] [MainThread]: 
[0m22:26:45.574868 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:26:45.575302 [debug] [MainThread]: Command end result
[0m22:26:45.589281 [info ] [MainThread]: 
[0m22:26:45.589543 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:26:45.589746 [info ] [MainThread]: 
[0m22:26:45.589964 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:26:45.590140 [info ] [MainThread]: 
[0m22:26:45.590312 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:26:45.590574 [info ] [MainThread]: 
[0m22:26:45.591041 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:26:45.591269 [info ] [MainThread]: 
[0m22:26:45.591457 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:26:45.591897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39033213, "process_user_time": 0.758132, "process_kernel_time": 0.069828, "process_mem_max_rss": "252748", "process_out_blocks": "1835", "command_success": false, "process_in_blocks": "0"}
[0m22:26:45.592168 [debug] [MainThread]: Command `dbt run` failed at 22:26:45.592131 after 0.39 seconds
[0m22:26:45.592365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9dfa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1424750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea490d0>]}
[0m22:26:45.592546 [debug] [MainThread]: Flushing usage events
[0m22:27:47.409403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca98a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbcbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca91850>]}


============================== 22:27:47.410686 | 5fe8a598-a35c-41e0-b3da-47c2d824c1c5 ==============================
[0m22:27:47.410686 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:27:47.411105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m22:27:47.487449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fe8a598-a35c-41e0-b3da-47c2d824c1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb2d4d0>]}
[0m22:27:47.507003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fe8a598-a35c-41e0-b3da-47c2d824c1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee9f210>]}
[0m22:27:47.507402 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:27:47.533928 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:27:47.581558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:27:47.581800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:27:47.599474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fe8a598-a35c-41e0-b3da-47c2d824c1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73e94690>]}
[0m22:27:47.644096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fe8a598-a35c-41e0-b3da-47c2d824c1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c77f90>]}
[0m22:27:47.644436 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:27:47.644777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe8a598-a35c-41e0-b3da-47c2d824c1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb3a590>]}
[0m22:27:47.645810 [info ] [MainThread]: 
[0m22:27:47.646263 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:27:47.648536 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:27:47.663465 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:27:47.663813 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:27:47.664059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:47.668751 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m22:27:47.669491 [debug] [ThreadPool]: On list_thrive: Close
[0m22:27:47.670808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:27:47.671089 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:27:47.674483 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:27:47.674781 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:27:47.675087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:47.678777 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:27:47.679540 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:27:47.679751 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:27:47.680094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:27:47.680298 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:27:47.680479 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:27:47.680770 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:27:47.681311 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:27:47.681519 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:27:47.681698 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:27:47.681999 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:27:47.682197 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:27:47.683820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m22:27:47.686414 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:27:47.686678 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:27:47.686858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:47.690469 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:27:47.690752 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:27:47.690937 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:27:47.700763 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m22:27:47.701729 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:27:47.702307 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:27:47.702575 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:27:47.704142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe8a598-a35c-41e0-b3da-47c2d824c1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c92090>]}
[0m22:27:47.704428 [debug] [MainThread]: Using duckdb connection "master"
[0m22:27:47.704617 [debug] [MainThread]: On master: BEGIN
[0m22:27:47.704797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:47.709033 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m22:27:47.709284 [debug] [MainThread]: On master: COMMIT
[0m22:27:47.709464 [debug] [MainThread]: Using duckdb connection "master"
[0m22:27:47.709636 [debug] [MainThread]: On master: COMMIT
[0m22:27:47.709959 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:27:47.710212 [debug] [MainThread]: On master: Close
[0m22:27:47.711152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:27:47.711462 [info ] [MainThread]: 
[0m22:27:47.712857 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:27:47.713238 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:27:47.713602 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:27:47.713834 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:27:47.716998 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:27:47.717584 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:27:47.731678 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:27:47.732575 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:27:47.732850 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:27:47.733091 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:27:47.736591 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:27:47.736860 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:27:47.737100 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:27:47.744782 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:27:47.745187 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:27:47.745580 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:27:47.746996 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:27:47.747221 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:27:47.749016 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:27:47.749719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe8a598-a35c-41e0-b3da-47c2d824c1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7315ad90>]}
[0m22:27:47.750069 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.04s]
[0m22:27:47.750400 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:27:47.750667 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:27:47.751214 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:27:47.751482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:27:47.751664 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:27:47.752929 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:27:47.753480 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:27:47.754892 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:27:47.755403 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:27:47.755583 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:27:47.755731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:47.758727 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:27:47.758939 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:27:47.759108 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:27:47.766671 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:27:47.766932 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:27:47.767202 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:27:47.768236 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:27:47.768435 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:27:47.770433 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:27:47.770792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe8a598-a35c-41e0-b3da-47c2d824c1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7305f050>]}
[0m22:27:47.771195 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.02s]
[0m22:27:47.771500 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:27:47.771745 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:27:47.772063 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:27:47.772349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:27:47.772543 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:27:47.773696 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:27:47.774228 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:27:47.775535 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:27:47.775916 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:27:47.776085 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:27:47.776238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:47.779408 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:27:47.779653 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:27:47.779856 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:27:47.787802 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:27:47.788110 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:27:47.788362 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:27:47.789259 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:27:47.789439 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:27:47.791152 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:27:47.791411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe8a598-a35c-41e0-b3da-47c2d824c1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7305f010>]}
[0m22:27:47.791748 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:27:47.792044 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:27:47.792762 [debug] [MainThread]: Using duckdb connection "master"
[0m22:27:47.792979 [debug] [MainThread]: On master: BEGIN
[0m22:27:47.793166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:27:47.796488 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:27:47.796730 [debug] [MainThread]: On master: COMMIT
[0m22:27:47.796915 [debug] [MainThread]: Using duckdb connection "master"
[0m22:27:47.797117 [debug] [MainThread]: On master: COMMIT
[0m22:27:47.797392 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:27:47.797616 [debug] [MainThread]: On master: Close
[0m22:27:47.798348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:47.798524 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:27:47.798690 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:27:47.798906 [info ] [MainThread]: 
[0m22:27:47.799116 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m22:27:47.799527 [debug] [MainThread]: Command end result
[0m22:27:47.814519 [info ] [MainThread]: 
[0m22:27:47.814814 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:27:47.815007 [info ] [MainThread]: 
[0m22:27:47.815287 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:27:47.815637 [info ] [MainThread]: 
[0m22:27:47.815927 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:27:47.816151 [info ] [MainThread]: 
[0m22:27:47.816386 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:27:47.816570 [info ] [MainThread]: 
[0m22:27:47.816740 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:27:47.817248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4262291, "process_user_time": 0.801174, "process_kernel_time": 0.09618, "process_mem_max_rss": "252736", "process_out_blocks": "1835", "command_success": false, "process_in_blocks": "0"}
[0m22:27:47.817491 [debug] [MainThread]: Command `dbt run` failed at 22:27:47.817456 after 0.43 seconds
[0m22:27:47.817684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca9a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cca2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816e90d0>]}
[0m22:27:47.817853 [debug] [MainThread]: Flushing usage events
[0m22:28:22.461287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92dd8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92dd0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e1ff90>]}


============================== 22:28:22.462460 | b3a75358-6a03-4d8a-90e5-7aa0eb01b433 ==============================
[0m22:28:22.462460 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:28:22.462898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:22.534933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e5d4d0>]}
[0m22:28:22.553457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951e2b90>]}
[0m22:28:22.553839 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:28:22.578817 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:28:22.625622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:28:22.626065 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/sources.yml
[0m22:28:22.705486 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:28:22.705993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fd0310>]}
[0m22:28:22.803807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff888baf90>]}
[0m22:28:22.869295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f97fd0>]}
[0m22:28:22.869620 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:28:22.869936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88860a90>]}
[0m22:28:22.870730 [info ] [MainThread]: 
[0m22:28:22.871055 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:28:22.872971 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:28:22.886072 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:28:22.886311 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:28:22.886507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:22.891003 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:28:22.891570 [debug] [ThreadPool]: On list_thrive: Close
[0m22:28:22.892678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:28:22.892913 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:28:22.895421 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:28:22.895608 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:28:22.895780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:22.898449 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:28:22.898999 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:28:22.899169 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:28:22.899439 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:28:22.899645 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:28:22.899803 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:28:22.900085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:28:22.900444 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:28:22.900609 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:28:22.900791 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:28:22.901221 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:28:22.901544 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:28:22.902621 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:28:22.904952 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:28:22.905151 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:28:22.905307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:22.908489 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:28:22.908686 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:28:22.908855 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:28:22.917278 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:28:22.917871 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:28:22.918250 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:28:22.918434 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:28:22.919747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88422010>]}
[0m22:28:22.920078 [debug] [MainThread]: Using duckdb connection "master"
[0m22:28:22.920267 [debug] [MainThread]: On master: BEGIN
[0m22:28:22.920443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:28:22.923446 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:28:22.923643 [debug] [MainThread]: On master: COMMIT
[0m22:28:22.923805 [debug] [MainThread]: Using duckdb connection "master"
[0m22:28:22.923969 [debug] [MainThread]: On master: COMMIT
[0m22:28:22.924389 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:28:22.924661 [debug] [MainThread]: On master: Close
[0m22:28:22.925397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:28:22.925639 [info ] [MainThread]: 
[0m22:28:22.926850 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:28:22.927124 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:28:22.927404 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:28:22.927600 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:28:22.930453 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:28:22.930973 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:28:22.942607 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:28:22.943171 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:28:22.943392 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:28:22.943591 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:28:22.946420 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:28:22.946618 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:28:22.946780 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m22:28:22.947153 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m22:28:22.947333 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:28:22.947550 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:28:22.949741 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:28:22.951566 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:28:22.953742 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m22:28:22.954630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88415690>]}
[0m22:28:22.954964 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:28:22.955268 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:28:22.955493 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:28:22.955965 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:28:22.956223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:28:22.956422 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:28:22.957561 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:28:22.958025 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:28:22.959263 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:28:22.959728 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:28:22.959901 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:28:22.960064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:22.962741 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:28:22.962926 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:28:22.963091 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m22:28:22.963429 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m22:28:22.963614 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:28:22.963790 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:28:22.964610 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:28:22.964770 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:28:22.966097 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m22:28:22.966299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884c4090>]}
[0m22:28:22.966542 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:28:22.966795 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:28:22.966988 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:28:22.967221 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:28:22.967422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:28:22.967608 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:28:22.968577 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:28:22.968919 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:28:22.970351 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:28:22.970771 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:22.970960 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:28:22.971132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:22.973753 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:28:22.973947 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:22.974099 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m22:28:22.974665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:28:22.977376 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:22.977567 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m22:28:22.977837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:28:22.983503 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m22:28:22.983696 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:22.983858 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m22:28:22.984431 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:28:22.987073 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:22.987248 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m22:28:22.987553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:28:22.988576 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:28:22.990555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a75358-6a03-4d8a-90e5-7aa0eb01b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8833fa90>]}
[0m22:28:22.990915 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m22:28:22.991183 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:28:22.991823 [debug] [MainThread]: Using duckdb connection "master"
[0m22:28:22.992005 [debug] [MainThread]: On master: BEGIN
[0m22:28:22.992168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:28:22.995101 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:28:22.995290 [debug] [MainThread]: On master: COMMIT
[0m22:28:22.995465 [debug] [MainThread]: Using duckdb connection "master"
[0m22:28:22.995627 [debug] [MainThread]: On master: COMMIT
[0m22:28:22.995854 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:28:22.996128 [debug] [MainThread]: On master: Close
[0m22:28:22.996885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:22.997038 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:28:22.997194 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:28:22.997321 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:28:22.997518 [info ] [MainThread]: 
[0m22:28:22.997703 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:28:22.998097 [debug] [MainThread]: Command end result
[0m22:28:23.011403 [info ] [MainThread]: 
[0m22:28:23.011659 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:28:23.011863 [info ] [MainThread]: 
[0m22:28:23.012202 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m22:28:23.012503 [info ] [MainThread]: 
[0m22:28:23.012752 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m22:28:23.012927 [info ] [MainThread]: 
[0m22:28:23.013096 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m22:28:23.013521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.56946206, "process_user_time": 0.942872, "process_kernel_time": 0.077235, "process_mem_max_rss": "252880", "process_out_blocks": "3218", "command_success": false, "process_in_blocks": "0"}
[0m22:28:23.013769 [debug] [MainThread]: Command `dbt run` failed at 22:28:23.013734 after 0.57 seconds
[0m22:28:23.013959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ddb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937fd110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b7dd50>]}
[0m22:28:23.014130 [debug] [MainThread]: Flushing usage events
[0m22:28:49.696234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bef8450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf17290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c055810>]}


============================== 22:28:49.697483 | dacdecd4-6083-4f70-978f-f4a1776c2f8b ==============================
[0m22:28:49.697483 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:28:49.697917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:49.775721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dacdecd4-6083-4f70-978f-f4a1776c2f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf8e910>]}
[0m22:28:49.795921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dacdecd4-6083-4f70-978f-f4a1776c2f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf3c110>]}
[0m22:28:49.796573 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:28:49.822790 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:28:49.872633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:28:49.872978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:28:49.891359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dacdecd4-6083-4f70-978f-f4a1776c2f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93340890>]}
[0m22:28:49.937662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dacdecd4-6083-4f70-978f-f4a1776c2f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930c1f10>]}
[0m22:28:49.938007 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:28:49.938323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dacdecd4-6083-4f70-978f-f4a1776c2f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93475c10>]}
[0m22:28:49.939162 [info ] [MainThread]: 
[0m22:28:49.939507 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:28:49.941608 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:28:49.955856 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:28:49.956140 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:28:49.956340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:49.960585 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:28:49.961188 [debug] [ThreadPool]: On list_thrive: Close
[0m22:28:49.962162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:28:49.962463 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:28:49.965247 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:28:49.965480 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:28:49.965660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:49.968910 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:28:49.969582 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:28:49.969780 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:28:49.970057 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:28:49.970236 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:28:49.970427 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:28:49.970884 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:28:49.971383 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:28:49.971587 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:28:49.971763 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:28:49.972089 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:28:49.972317 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:28:49.973638 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:28:49.976018 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:28:49.976211 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:28:49.976382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:49.980121 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:28:49.980370 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:28:49.980583 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:28:49.989676 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:28:49.990447 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:28:49.990849 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:28:49.991039 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:28:49.992523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dacdecd4-6083-4f70-978f-f4a1776c2f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9befab90>]}
[0m22:28:49.992826 [debug] [MainThread]: Using duckdb connection "master"
[0m22:28:49.993031 [debug] [MainThread]: On master: BEGIN
[0m22:28:49.993217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:28:49.996594 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:28:49.996817 [debug] [MainThread]: On master: COMMIT
[0m22:28:49.997011 [debug] [MainThread]: Using duckdb connection "master"
[0m22:28:49.997190 [debug] [MainThread]: On master: COMMIT
[0m22:28:49.997706 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:28:49.997984 [debug] [MainThread]: On master: Close
[0m22:28:49.998805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:28:49.999076 [info ] [MainThread]: 
[0m22:28:50.000571 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:28:50.000926 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:28:50.001251 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:28:50.001464 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:28:50.004905 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:28:50.005484 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:28:50.018423 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:28:50.019104 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:28:50.019295 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:28:50.019491 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:28:50.023154 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:28:50.023464 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:28:50.023666 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m22:28:50.024071 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m22:28:50.024278 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:28:50.024510 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:28:50.025826 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:28:50.026008 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:28:50.027372 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m22:28:50.028031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dacdecd4-6083-4f70-978f-f4a1776c2f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925b0b50>]}
[0m22:28:50.028340 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:28:50.028623 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:28:50.028845 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:28:50.029356 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:28:50.029717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:28:50.029933 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:28:50.031502 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:28:50.032081 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:28:50.033444 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:28:50.033861 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:28:50.034034 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:28:50.034205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:50.037440 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:28:50.037758 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:28:50.037972 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m22:28:50.038408 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m22:28:50.038594 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:28:50.038816 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:28:50.039787 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:28:50.039961 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:28:50.041590 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m22:28:50.041963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dacdecd4-6083-4f70-978f-f4a1776c2f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925bce10>]}
[0m22:28:50.042312 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:28:50.042588 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:28:50.042810 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:28:50.043265 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:28:50.043540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:28:50.043719 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:28:50.045012 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:28:50.045455 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:28:50.047039 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:28:50.047478 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:50.047649 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:28:50.047806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:50.050927 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:28:50.051156 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:50.051365 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m22:28:50.051769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:28:50.054482 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:50.054688 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m22:28:50.055032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:28:50.056381 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:50.056555 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m22:28:50.056830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:28:50.063331 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m22:28:50.063597 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:50.063797 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m22:28:50.064578 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:28:50.066647 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:28:50.066865 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m22:28:50.067295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:28:50.068343 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:28:50.070687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dacdecd4-6083-4f70-978f-f4a1776c2f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9340ab90>]}
[0m22:28:50.071051 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.03s]
[0m22:28:50.071403 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:28:50.072147 [debug] [MainThread]: Using duckdb connection "master"
[0m22:28:50.072361 [debug] [MainThread]: On master: BEGIN
[0m22:28:50.072525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:28:50.075976 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:28:50.076186 [debug] [MainThread]: On master: COMMIT
[0m22:28:50.076357 [debug] [MainThread]: Using duckdb connection "master"
[0m22:28:50.076519 [debug] [MainThread]: On master: COMMIT
[0m22:28:50.076744 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:28:50.077025 [debug] [MainThread]: On master: Close
[0m22:28:50.078079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:50.078292 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:28:50.078461 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:28:50.078614 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:28:50.078834 [info ] [MainThread]: 
[0m22:28:50.079024 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:28:50.079411 [debug] [MainThread]: Command end result
[0m22:28:50.117041 [info ] [MainThread]: 
[0m22:28:50.117349 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:28:50.117644 [info ] [MainThread]: 
[0m22:28:50.117989 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m22:28:50.118206 [info ] [MainThread]: 
[0m22:28:50.118392 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m22:28:50.118560 [info ] [MainThread]: 
[0m22:28:50.118727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m22:28:50.119161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4399508, "process_user_time": 0.787021, "process_kernel_time": 0.086892, "process_mem_max_rss": "252612", "process_out_blocks": "2359", "command_success": false, "process_in_blocks": "0"}
[0m22:28:50.119399 [debug] [MainThread]: Command `dbt run` failed at 22:28:50.119361 after 0.44 seconds
[0m22:28:50.119599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c9d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903a7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903a2a10>]}
[0m22:28:50.119794 [debug] [MainThread]: Flushing usage events
[0m22:29:24.723552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6d8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6aa0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c71ff90>]}


============================== 22:29:24.726189 | 8620cf18-2e40-4e03-a51a-e5ca76d4ac8a ==============================
[0m22:29:24.726189 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:29:24.726734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:24.812396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8620cf18-2e40-4e03-a51a-e5ca76d4ac8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c75d050>]}
[0m22:29:24.831137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8620cf18-2e40-4e03-a51a-e5ca76d4ac8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eae2dd0>]}
[0m22:29:24.831891 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:29:24.856985 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:29:24.904980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:29:24.905264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:29:24.922759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8620cf18-2e40-4e03-a51a-e5ca76d4ac8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c77d6d0>]}
[0m22:29:24.967345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8620cf18-2e40-4e03-a51a-e5ca76d4ac8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838b3e90>]}
[0m22:29:24.967688 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:29:24.967918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8620cf18-2e40-4e03-a51a-e5ca76d4ac8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c774f50>]}
[0m22:29:24.968725 [info ] [MainThread]: 
[0m22:29:24.969060 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:29:24.971170 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:29:24.985009 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:29:24.985271 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:29:24.985476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:24.989739 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:29:24.990354 [debug] [ThreadPool]: On list_thrive: Close
[0m22:29:24.991258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:29:24.991557 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:29:24.994323 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:29:24.994532 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:29:24.994729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:24.997707 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:29:24.998299 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:29:24.998481 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:29:24.998849 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:29:24.999076 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:29:24.999296 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:29:24.999600 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:29:25.000022 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:29:25.000238 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:29:25.000418 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:29:25.000713 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:29:25.000958 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:29:25.002150 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:29:25.004520 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:29:25.004706 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:29:25.004880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:25.008035 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:29:25.008237 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:29:25.008469 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:29:25.017518 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:29:25.018172 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:29:25.018549 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:29:25.018732 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:29:25.019992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8620cf18-2e40-4e03-a51a-e5ca76d4ac8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c76fad0>]}
[0m22:29:25.020258 [debug] [MainThread]: Using duckdb connection "master"
[0m22:29:25.020457 [debug] [MainThread]: On master: BEGIN
[0m22:29:25.020637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:25.024046 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:29:25.024332 [debug] [MainThread]: On master: COMMIT
[0m22:29:25.024618 [debug] [MainThread]: Using duckdb connection "master"
[0m22:29:25.024878 [debug] [MainThread]: On master: COMMIT
[0m22:29:25.025289 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:29:25.025531 [debug] [MainThread]: On master: Close
[0m22:29:25.026375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:25.026606 [info ] [MainThread]: 
[0m22:29:25.027959 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:29:25.028257 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:29:25.028562 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:29:25.028776 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:29:25.031896 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:29:25.032501 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:29:25.045355 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:29:25.046003 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:29:25.046243 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:29:25.046456 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:29:25.050061 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:29:25.050330 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:29:25.050547 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m22:29:25.051064 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m22:29:25.051297 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:29:25.051538 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:29:25.052855 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:29:25.053043 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:29:25.054658 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m22:29:25.055316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8620cf18-2e40-4e03-a51a-e5ca76d4ac8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82dbbed0>]}
[0m22:29:25.055642 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:29:25.055970 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:29:25.056216 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:29:25.056735 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:29:25.057004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:29:25.057257 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:29:25.058722 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:29:25.059190 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:29:25.060477 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:29:25.060864 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:29:25.061065 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:29:25.061232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:25.064305 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:29:25.064542 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:29:25.064779 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m22:29:25.065233 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m22:29:25.065428 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:29:25.065635 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:29:25.066587 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:29:25.066767 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:29:25.068246 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m22:29:25.068494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8620cf18-2e40-4e03-a51a-e5ca76d4ac8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82de6150>]}
[0m22:29:25.068782 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:29:25.069064 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:29:25.069295 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:29:25.069645 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:29:25.070000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:29:25.070273 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:29:25.071510 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:29:25.071915 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:29:25.073352 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:29:25.073724 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:29:25.073886 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:29:25.074033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:25.076952 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:29:25.077143 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:29:25.077303 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m22:29:25.077660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:29:25.080267 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:29:25.080451 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m22:29:25.080715 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:29:25.081797 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:29:25.081970 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m22:29:25.082238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:29:25.088452 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m22:29:25.088709 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:29:25.088940 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m22:29:25.089657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:29:25.091781 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:29:25.091962 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m22:29:25.092344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:29:25.093416 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:29:25.095367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8620cf18-2e40-4e03-a51a-e5ca76d4ac8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7370d0>]}
[0m22:29:25.095697 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.03s]
[0m22:29:25.095964 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:29:25.096603 [debug] [MainThread]: Using duckdb connection "master"
[0m22:29:25.096825 [debug] [MainThread]: On master: BEGIN
[0m22:29:25.097008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:29:25.100233 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:29:25.100427 [debug] [MainThread]: On master: COMMIT
[0m22:29:25.100576 [debug] [MainThread]: Using duckdb connection "master"
[0m22:29:25.100713 [debug] [MainThread]: On master: COMMIT
[0m22:29:25.100917 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:29:25.101074 [debug] [MainThread]: On master: Close
[0m22:29:25.101782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:25.102002 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:29:25.102218 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:29:25.102476 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:29:25.102735 [info ] [MainThread]: 
[0m22:29:25.102930 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:29:25.103343 [debug] [MainThread]: Command end result
[0m22:29:25.143773 [info ] [MainThread]: 
[0m22:29:25.144047 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:29:25.144278 [info ] [MainThread]: 
[0m22:29:25.144619 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m22:29:25.144871 [info ] [MainThread]: 
[0m22:29:25.145294 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m22:29:25.145583 [info ] [MainThread]: 
[0m22:29:25.145814 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m22:29:25.146297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.44130692, "process_user_time": 0.820379, "process_kernel_time": 0.067277, "process_mem_max_rss": "252732", "process_out_blocks": "2359", "command_success": false, "process_in_blocks": "0"}
[0m22:29:25.146534 [debug] [MainThread]: Command `dbt run` failed at 22:29:25.146495 after 0.44 seconds
[0m22:29:25.146730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9147de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80373d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80372750>]}
[0m22:29:25.146942 [debug] [MainThread]: Flushing usage events
[0m22:29:51.678601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec4b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed52610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec8fd50>]}


============================== 22:29:51.679722 | 02f42766-fcd5-49a8-bc88-91df28e3e2bd ==============================
[0m22:29:51.679722 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:29:51.680030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:51.749172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0f7850>]}
[0m22:29:51.767082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1052fd0>]}
[0m22:29:51.767439 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:29:51.792577 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:29:51.836505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:29:51.836949 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/sources.yml
[0m22:29:51.916783 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:29:51.917228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec91790>]}
[0m22:29:52.010907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4722cd0>]}
[0m22:29:52.076176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6186810>]}
[0m22:29:52.076493 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:29:52.076722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46d7090>]}
[0m22:29:52.077511 [info ] [MainThread]: 
[0m22:29:52.077808 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:29:52.079683 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:29:52.092452 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:29:52.092685 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:29:52.092874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:52.096994 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:29:52.097637 [debug] [ThreadPool]: On list_thrive: Close
[0m22:29:52.098850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:29:52.099166 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:29:52.102392 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:29:52.102815 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:29:52.103104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:52.106715 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:29:52.107374 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:29:52.107603 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:29:52.107919 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:29:52.108126 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:29:52.108348 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:29:52.108837 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:29:52.109328 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:29:52.109526 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:29:52.109700 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:29:52.110054 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:29:52.110332 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:29:52.111575 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:29:52.114098 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:29:52.114308 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:29:52.114728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:52.119090 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:29:52.119508 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:29:52.119784 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:29:52.129808 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m22:29:52.130900 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:29:52.131468 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:29:52.131750 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:29:52.133598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f8e0d0>]}
[0m22:29:52.134006 [debug] [MainThread]: Using duckdb connection "master"
[0m22:29:52.134279 [debug] [MainThread]: On master: BEGIN
[0m22:29:52.134540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:52.138398 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m22:29:52.138679 [debug] [MainThread]: On master: COMMIT
[0m22:29:52.138905 [debug] [MainThread]: Using duckdb connection "master"
[0m22:29:52.139114 [debug] [MainThread]: On master: COMMIT
[0m22:29:52.139447 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:29:52.139694 [debug] [MainThread]: On master: Close
[0m22:29:52.140707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:52.140970 [info ] [MainThread]: 
[0m22:29:52.142342 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:29:52.142649 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:29:52.142956 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:29:52.143169 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:29:52.146125 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:29:52.146678 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:29:52.158959 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:29:52.159621 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:29:52.159835 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:29:52.160044 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:29:52.163677 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:29:52.163916 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:29:52.164100 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:29:52.171484 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:29:52.171737 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:29:52.172005 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:29:52.173384 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:29:52.173577 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:29:52.175335 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:29:52.176046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46d9c90>]}
[0m22:29:52.176419 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:29:52.176737 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:29:52.176966 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:29:52.177464 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:29:52.177739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:29:52.177942 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:29:52.179119 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:29:52.179639 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:29:52.181002 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:29:52.181358 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:29:52.181538 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:29:52.181714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:52.184716 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:29:52.184946 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:29:52.185116 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:29:52.192281 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:29:52.192481 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:29:52.192718 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:29:52.193619 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:29:52.193785 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:29:52.195483 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:29:52.195732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa469f190>]}
[0m22:29:52.196009 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.02s]
[0m22:29:52.196317 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:29:52.196541 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:29:52.196828 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:29:52.197091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:29:52.197282 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:29:52.198398 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:29:52.198868 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:29:52.200211 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:29:52.200593 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:29:52.200744 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:29:52.200881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:52.203648 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:29:52.203829 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:29:52.203987 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:29:52.210894 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:29:52.211096 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:29:52.211325 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:29:52.212218 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:29:52.212400 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:29:52.214065 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:29:52.214313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f42766-fcd5-49a8-bc88-91df28e3e2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e24150>]}
[0m22:29:52.214595 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:29:52.214858 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:29:52.215531 [debug] [MainThread]: Using duckdb connection "master"
[0m22:29:52.215761 [debug] [MainThread]: On master: BEGIN
[0m22:29:52.215934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:29:52.219284 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:29:52.219543 [debug] [MainThread]: On master: COMMIT
[0m22:29:52.219708 [debug] [MainThread]: Using duckdb connection "master"
[0m22:29:52.219866 [debug] [MainThread]: On master: COMMIT
[0m22:29:52.220143 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:29:52.220329 [debug] [MainThread]: On master: Close
[0m22:29:52.221030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:52.221215 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:29:52.221399 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:29:52.221553 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:29:52.221759 [info ] [MainThread]: 
[0m22:29:52.221975 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:29:52.222394 [debug] [MainThread]: Command end result
[0m22:29:52.236598 [info ] [MainThread]: 
[0m22:29:52.236831 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:29:52.237011 [info ] [MainThread]: 
[0m22:29:52.237224 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:29:52.237382 [info ] [MainThread]: 
[0m22:29:52.237580 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:29:52.237852 [info ] [MainThread]: 
[0m22:29:52.238268 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:29:52.238460 [info ] [MainThread]: 
[0m22:29:52.238655 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:29:52.239072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5770582, "process_user_time": 0.958666, "process_kernel_time": 0.067469, "process_mem_max_rss": "252748", "process_out_blocks": "2696", "command_success": false, "process_in_blocks": "0"}
[0m22:29:52.239302 [debug] [MainThread]: Command `dbt run` failed at 22:29:52.239268 after 0.58 seconds
[0m22:29:52.239496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13c4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb029bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39edd50>]}
[0m22:29:52.239673 [debug] [MainThread]: Flushing usage events
[0m22:30:26.977820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870c29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8718c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870bff90>]}


============================== 22:30:26.978956 | fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9 ==============================
[0m22:30:26.978956 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:30:26.979308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:30:27.049771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8711c890>]}
[0m22:30:27.067612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89482f50>]}
[0m22:30:27.067968 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:30:27.092425 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:30:27.137339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:27.137577 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:27.154399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4ac690>]}
[0m22:30:27.195538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e257f50>]}
[0m22:30:27.195838 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:30:27.196022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3db850>]}
[0m22:30:27.197040 [info ] [MainThread]: 
[0m22:30:27.197508 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:30:27.199582 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:30:27.213663 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:30:27.213958 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:30:27.214137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:27.218423 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:30:27.219014 [debug] [ThreadPool]: On list_thrive: Close
[0m22:30:27.219942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:30:27.220204 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:30:27.222823 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:30:27.223010 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:30:27.223194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:27.226152 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:30:27.226705 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:30:27.226878 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:30:27.227149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:30:27.227366 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:30:27.227526 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:30:27.227793 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:30:27.228144 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:30:27.228318 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:30:27.228475 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:30:27.228722 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:30:27.228884 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:30:27.230308 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:30:27.232532 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:30:27.232700 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:30:27.232854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:27.236099 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:30:27.236297 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:30:27.236468 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:30:27.244751 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:30:27.245467 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:30:27.245821 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:30:27.245988 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:30:27.247506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e27a010>]}
[0m22:30:27.247809 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:27.248009 [debug] [MainThread]: On master: BEGIN
[0m22:30:27.248198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:27.251421 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:30:27.251603 [debug] [MainThread]: On master: COMMIT
[0m22:30:27.251765 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:27.251925 [debug] [MainThread]: On master: COMMIT
[0m22:30:27.252184 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:30:27.252373 [debug] [MainThread]: On master: Close
[0m22:30:27.253098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:30:27.253340 [info ] [MainThread]: 
[0m22:30:27.254612 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:30:27.254883 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:30:27.255168 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:30:27.255366 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:30:27.258276 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:30:27.258737 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:30:27.270581 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:30:27.271125 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:30:27.271401 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:30:27.271581 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:30:27.274617 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:30:27.274903 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:30:27.275080 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:30:27.281906 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:30:27.282122 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:30:27.282399 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:30:27.284040 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:30:27.284280 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:30:27.285879 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:30:27.286523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d793410>]}
[0m22:30:27.286831 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:30:27.287166 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:30:27.287400 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:30:27.287929 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:30:27.288189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:30:27.288398 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:30:27.289603 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:30:27.290128 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:30:27.291423 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:30:27.291772 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:30:27.291931 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:30:27.292119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:27.294969 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:30:27.295153 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:30:27.295312 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:30:27.302338 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:30:27.302555 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:30:27.302756 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:30:27.303658 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:30:27.303813 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:30:27.305513 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:30:27.305746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7e83d0>]}
[0m22:30:27.306003 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.02s]
[0m22:30:27.306265 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:30:27.306462 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:30:27.306720 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:30:27.306945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:30:27.307154 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:30:27.308339 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:30:27.308846 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:30:27.310150 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:30:27.310639 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:30:27.310831 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:30:27.310998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:27.314041 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:30:27.314267 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:30:27.314449 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:30:27.321946 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:30:27.322214 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:30:27.322450 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:30:27.323344 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:30:27.323545 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:30:27.325397 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:30:27.325663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe0eb8e4-5d26-45c1-9f83-c7eeb9d89db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e80e490>]}
[0m22:30:27.325935 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:30:27.326195 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:30:27.326831 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:27.327024 [debug] [MainThread]: On master: BEGIN
[0m22:30:27.327185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:30:27.330417 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:30:27.330602 [debug] [MainThread]: On master: COMMIT
[0m22:30:27.330765 [debug] [MainThread]: Using duckdb connection "master"
[0m22:30:27.330938 [debug] [MainThread]: On master: COMMIT
[0m22:30:27.331202 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:30:27.331396 [debug] [MainThread]: On master: Close
[0m22:30:27.332054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:27.332243 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:30:27.332398 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:30:27.332544 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:30:27.332743 [info ] [MainThread]: 
[0m22:30:27.332957 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:30:27.333375 [debug] [MainThread]: Command end result
[0m22:30:27.347572 [info ] [MainThread]: 
[0m22:30:27.347808 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:30:27.348052 [info ] [MainThread]: 
[0m22:30:27.348406 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:30:27.348621 [info ] [MainThread]: 
[0m22:30:27.348820 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:30:27.349006 [info ] [MainThread]: 
[0m22:30:27.349216 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:30:27.349416 [info ] [MainThread]: 
[0m22:30:27.349592 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:30:27.349997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38900334, "process_user_time": 0.764028, "process_kernel_time": 0.062837, "process_mem_max_rss": "252756", "process_out_blocks": "1835", "command_success": false, "process_in_blocks": "0"}
[0m22:30:27.350239 [debug] [MainThread]: Command `dbt run` failed at 22:30:27.350204 after 0.39 seconds
[0m22:30:27.350451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8707a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8748a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bcc90d0>]}
[0m22:30:27.350668 [debug] [MainThread]: Flushing usage events
[0m22:31:31.879249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82122290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82cc2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82074b50>]}


============================== 22:31:31.880511 | 77542a7b-879b-448f-86ea-9564a294d2a0 ==============================
[0m22:31:31.880511 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:31:31.880834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:31:31.955869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77542a7b-879b-448f-86ea-9564a294d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7963ed50>]}
[0m22:31:31.974599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77542a7b-879b-448f-86ea-9564a294d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843227d0>]}
[0m22:31:31.974977 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:31:32.001344 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:31:32.049690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:31:32.049932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:31:32.067520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77542a7b-879b-448f-86ea-9564a294d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fb8890>]}
[0m22:31:32.111892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77542a7b-879b-448f-86ea-9564a294d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff790f7f50>]}
[0m22:31:32.112212 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:31:32.112432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77542a7b-879b-448f-86ea-9564a294d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79542f50>]}
[0m22:31:32.113265 [info ] [MainThread]: 
[0m22:31:32.113628 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:31:32.115891 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:31:32.130730 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:31:32.130987 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:31:32.131179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:32.135579 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:31:32.136182 [debug] [ThreadPool]: On list_thrive: Close
[0m22:31:32.137162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:31:32.137513 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:31:32.140321 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:31:32.140525 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:31:32.140720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:32.143664 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:31:32.144236 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:31:32.144416 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:31:32.144787 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:31:32.145031 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:31:32.145227 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:31:32.145533 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:31:32.145962 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:31:32.146153 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:31:32.146323 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:31:32.146586 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:31:32.146767 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:31:32.147937 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:31:32.150201 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:31:32.150388 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:31:32.150571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:32.154324 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:31:32.154534 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:31:32.154729 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:31:32.164401 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:31:32.165008 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:31:32.165371 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:31:32.165585 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:31:32.166777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77542a7b-879b-448f-86ea-9564a294d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f9fb10>]}
[0m22:31:32.167041 [debug] [MainThread]: Using duckdb connection "master"
[0m22:31:32.167246 [debug] [MainThread]: On master: BEGIN
[0m22:31:32.167436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:31:32.171167 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m22:31:32.171374 [debug] [MainThread]: On master: COMMIT
[0m22:31:32.171586 [debug] [MainThread]: Using duckdb connection "master"
[0m22:31:32.171770 [debug] [MainThread]: On master: COMMIT
[0m22:31:32.172144 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:31:32.172377 [debug] [MainThread]: On master: Close
[0m22:31:32.173166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:31:32.173448 [info ] [MainThread]: 
[0m22:31:32.174746 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:31:32.175059 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:31:32.175358 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:31:32.175598 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:31:32.178675 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:31:32.179228 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:31:32.191947 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:31:32.192535 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:31:32.192769 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:31:32.192982 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:31:32.196064 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:31:32.196265 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:31:32.196456 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:31:32.204773 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."raw"."raw_customers"
  );

[0m22:31:32.205004 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:31:32.205253 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:31:32.206702 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:31:32.206911 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:31:32.208642 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:31:32.209306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77542a7b-879b-448f-86ea-9564a294d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78503ed0>]}
[0m22:31:32.209655 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:31:32.209997 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:31:32.210271 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:31:32.210796 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:31:32.211056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:31:32.211276 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:31:32.212474 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:31:32.213032 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:31:32.214447 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:31:32.214875 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:31:32.215105 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:31:32.215299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:32.218230 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:31:32.218427 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:31:32.218612 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:31:32.225931 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."raw"."raw_sales"
  );

[0m22:31:32.226172 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:31:32.226412 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:31:32.227343 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:31:32.227556 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:31:32.229194 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:31:32.229445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77542a7b-879b-448f-86ea-9564a294d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff785c3bd0>]}
[0m22:31:32.229754 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.02s]
[0m22:31:32.230049 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:31:32.230271 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:31:32.230562 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:31:32.230817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:31:32.231030 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:31:32.232189 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:31:32.232690 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:31:32.234048 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:31:32.234485 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:31:32.234714 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:31:32.234902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:32.238329 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:31:32.238638 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:31:32.238833 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:31:32.246303 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."raw"."raw_tc_data"
  );

[0m22:31:32.246529 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:31:32.246822 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m22:31:32.247735 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m22:31:32.247944 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:31:32.249834 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:31:32.250150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77542a7b-879b-448f-86ea-9564a294d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78511bd0>]}
[0m22:31:32.250464 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.02s]
[0m22:31:32.250756 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:31:32.251417 [debug] [MainThread]: Using duckdb connection "master"
[0m22:31:32.251634 [debug] [MainThread]: On master: BEGIN
[0m22:31:32.251813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:31:32.255112 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:31:32.255307 [debug] [MainThread]: On master: COMMIT
[0m22:31:32.255491 [debug] [MainThread]: Using duckdb connection "master"
[0m22:31:32.255702 [debug] [MainThread]: On master: COMMIT
[0m22:31:32.256051 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:31:32.256319 [debug] [MainThread]: On master: Close
[0m22:31:32.257090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:32.257259 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:31:32.257424 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:31:32.257612 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:31:32.257849 [info ] [MainThread]: 
[0m22:31:32.258056 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:31:32.258458 [debug] [MainThread]: Command end result
[0m22:31:32.273834 [info ] [MainThread]: 
[0m22:31:32.274291 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:31:32.274636 [info ] [MainThread]: 
[0m22:31:32.274866 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "thrive.raw_customers"?
  LINE 9: from "thrive"."raw"."raw_customers"
               ^
[0m22:31:32.275072 [info ] [MainThread]: 
[0m22:31:32.275249 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Catalog Error: Table with name raw_sales does not exist!
  Did you mean "thrive.raw_sales"?
  LINE 10: from "thrive"."raw"."raw_sales"
                ^
[0m22:31:32.275420 [info ] [MainThread]: 
[0m22:31:32.275607 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Catalog Error: Table with name raw_tc_data does not exist!
  Did you mean "thrive.raw_tc_data"?
  LINE 11: from "thrive"."raw"."raw_tc_data"
                ^
[0m22:31:32.275791 [info ] [MainThread]: 
[0m22:31:32.275959 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:31:32.276404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4157637, "process_user_time": 0.825446, "process_kernel_time": 0.067092, "process_mem_max_rss": "253564", "process_out_blocks": "1835", "command_success": false, "process_in_blocks": "0"}
[0m22:31:32.276640 [debug] [MainThread]: Command `dbt run` failed at 22:31:32.276604 after 0.42 seconds
[0m22:31:32.276855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f1a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83292f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b69010>]}
[0m22:31:32.277044 [debug] [MainThread]: Flushing usage events
[0m22:38:00.660069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4988850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4988690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4988810>]}


============================== 22:38:00.661332 | 1da9f341-83e5-4864-95b1-456bc38f0486 ==============================
[0m22:38:00.661332 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:38:00.661752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m22:38:00.752265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49d0990>]}
[0m22:38:00.772521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49f4b50>]}
[0m22:38:00.773231 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m22:38:00.800078 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:38:00.846701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:38:00.847191 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/sources.yml
[0m22:38:00.847389 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_sales.sql
[0m22:38:00.847569 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_customers.sql
[0m22:38:00.847754 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_tc_data.sql
[0m22:38:00.925488 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:38:00.925988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be4ed90>]}
[0m22:38:01.018446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bbc5690>]}
[0m22:38:01.082419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bec4250>]}
[0m22:38:01.082733 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m22:38:01.083107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a39f310>]}
[0m22:38:01.083958 [info ] [MainThread]: 
[0m22:38:01.084328 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:38:01.086236 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m22:38:01.098650 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m22:38:01.098891 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m22:38:01.099113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:01.103472 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:38:01.104007 [debug] [ThreadPool]: On list_thrive: Close
[0m22:38:01.104930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m22:38:01.105168 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m22:38:01.107598 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:38:01.107774 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m22:38:01.107935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:01.110806 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:38:01.111357 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:38:01.111525 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m22:38:01.111802 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:38:01.111971 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:38:01.112138 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m22:38:01.112424 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:38:01.112824 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:38:01.113008 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m22:38:01.113173 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m22:38:01.113535 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:38:01.113831 [debug] [ThreadPool]: On create_thrive_main: Close
[0m22:38:01.114959 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m22:38:01.117213 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:38:01.117390 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m22:38:01.117546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:01.120689 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:38:01.120887 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m22:38:01.121100 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m22:38:01.129078 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m22:38:01.129628 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m22:38:01.129990 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m22:38:01.130172 [debug] [ThreadPool]: On list_thrive_main: Close
[0m22:38:01.131457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a444fd0>]}
[0m22:38:01.131682 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:01.131875 [debug] [MainThread]: On master: BEGIN
[0m22:38:01.132056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:01.135206 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:38:01.135505 [debug] [MainThread]: On master: COMMIT
[0m22:38:01.135698 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:01.135877 [debug] [MainThread]: On master: COMMIT
[0m22:38:01.136178 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:38:01.136355 [debug] [MainThread]: On master: Close
[0m22:38:01.137084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:01.137291 [info ] [MainThread]: 
[0m22:38:01.138516 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m22:38:01.138826 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:38:01.139106 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m22:38:01.139300 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m22:38:01.142052 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m22:38:01.142573 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m22:38:01.153445 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m22:38:01.154053 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:38:01.154261 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m22:38:01.154460 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:01.157934 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:38:01.158261 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m22:38:01.158447 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m22:38:01.158840 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m22:38:01.159024 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:38:01.159248 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m22:38:01.160542 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m22:38:01.160709 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m22:38:01.163845 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m22:38:01.164842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf37310>]}
[0m22:38:01.165167 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m22:38:01.165469 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m22:38:01.165693 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m22:38:01.166199 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m22:38:01.166469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m22:38:01.166656 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m22:38:01.167805 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m22:38:01.168271 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m22:38:01.169530 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m22:38:01.169976 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:38:01.170156 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m22:38:01.170325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:01.173032 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:38:01.173222 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m22:38:01.173373 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m22:38:01.173687 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m22:38:01.173882 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:38:01.174150 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m22:38:01.175034 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m22:38:01.175214 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m22:38:01.176496 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m22:38:01.176704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9991ec90>]}
[0m22:38:01.176994 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m22:38:01.177250 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m22:38:01.177442 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m22:38:01.177682 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m22:38:01.177916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m22:38:01.178092 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m22:38:01.179037 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m22:38:01.179397 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m22:38:01.180899 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m22:38:01.181305 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:38:01.181481 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m22:38:01.181647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:01.184536 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:38:01.184847 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:38:01.185060 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m22:38:01.185427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:38:01.187838 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:38:01.188021 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m22:38:01.188284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:38:01.189363 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:38:01.189519 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m22:38:01.189763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:38:01.196630 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m22:38:01.196844 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:38:01.197029 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m22:38:01.197715 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:38:01.199500 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m22:38:01.199668 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m22:38:01.200071 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:38:01.200982 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m22:38:01.203078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da9f341-83e5-4864-95b1-456bc38f0486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a4ded0>]}
[0m22:38:01.203354 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.03s]
[0m22:38:01.203618 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m22:38:01.204236 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:01.204441 [debug] [MainThread]: On master: BEGIN
[0m22:38:01.204599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:38:01.207518 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m22:38:01.207688 [debug] [MainThread]: On master: COMMIT
[0m22:38:01.207875 [debug] [MainThread]: Using duckdb connection "master"
[0m22:38:01.208037 [debug] [MainThread]: On master: COMMIT
[0m22:38:01.208479 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:38:01.208821 [debug] [MainThread]: On master: Close
[0m22:38:01.209632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:01.209793 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m22:38:01.209948 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m22:38:01.210097 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m22:38:01.210309 [info ] [MainThread]: 
[0m22:38:01.210503 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:38:01.210924 [debug] [MainThread]: Command end result
[0m22:38:01.224385 [info ] [MainThread]: 
[0m22:38:01.224610 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:38:01.224782 [info ] [MainThread]: 
[0m22:38:01.224993 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m22:38:01.225329 [info ] [MainThread]: 
[0m22:38:01.225576 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m22:38:01.225771 [info ] [MainThread]: 
[0m22:38:01.225996 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m22:38:01.226422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5834443, "process_user_time": 0.940129, "process_kernel_time": 0.077243, "process_mem_max_rss": "253540", "process_out_blocks": "3220", "command_success": false, "process_in_blocks": "0"}
[0m22:38:01.226648 [debug] [MainThread]: Command `dbt run` failed at 22:38:01.226613 after 0.58 seconds
[0m22:38:01.226846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49d3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49d2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa95d9010>]}
[0m22:38:01.227053 [debug] [MainThread]: Flushing usage events
[0m23:15:29.703271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0438e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0433790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0438b50>]}


============================== 23:15:29.704396 | 1341c9c2-46f5-4ba4-8632-ddd004afd90e ==============================
[0m23:15:29.704396 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:15:29.704797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:15:29.771309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1341c9c2-46f5-4ba4-8632-ddd004afd90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7be6410>]}
[0m23:15:29.788479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1341c9c2-46f5-4ba4-8632-ddd004afd90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04c5550>]}
[0m23:15:29.788856 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m23:15:29.812611 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:15:29.855203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:15:29.855437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:15:29.871301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1341c9c2-46f5-4ba4-8632-ddd004afd90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7864690>]}
[0m23:15:29.912069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1341c9c2-46f5-4ba4-8632-ddd004afd90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7617f50>]}
[0m23:15:29.915962 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m23:15:29.916325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1341c9c2-46f5-4ba4-8632-ddd004afd90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa779b150>]}
[0m23:15:29.917300 [info ] [MainThread]: 
[0m23:15:29.917707 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:15:29.920125 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m23:15:29.933661 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m23:15:29.933925 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m23:15:29.934139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:29.938422 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:15:29.939019 [debug] [ThreadPool]: On list_thrive: Close
[0m23:15:29.939902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m23:15:29.940158 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m23:15:29.942662 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:15:29.942855 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m23:15:29.943067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:15:29.945962 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:15:29.946513 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:15:29.946688 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m23:15:29.946997 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:15:29.947180 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:15:29.947355 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m23:15:29.947629 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:15:29.947990 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m23:15:29.948185 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:15:29.948360 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m23:15:29.948598 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:15:29.948779 [debug] [ThreadPool]: On create_thrive_main: Close
[0m23:15:29.949881 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m23:15:29.952008 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:15:29.952204 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m23:15:29.952380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:29.955460 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:15:29.955642 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:15:29.955849 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m23:15:29.964019 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:15:29.964552 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m23:15:29.964903 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m23:15:29.965069 [debug] [ThreadPool]: On list_thrive_main: Close
[0m23:15:29.966324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1341c9c2-46f5-4ba4-8632-ddd004afd90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04d1a50>]}
[0m23:15:29.966579 [debug] [MainThread]: Using duckdb connection "master"
[0m23:15:29.966763 [debug] [MainThread]: On master: BEGIN
[0m23:15:29.966922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:15:29.970082 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:15:29.970379 [debug] [MainThread]: On master: COMMIT
[0m23:15:29.970567 [debug] [MainThread]: Using duckdb connection "master"
[0m23:15:29.970743 [debug] [MainThread]: On master: COMMIT
[0m23:15:29.971081 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:15:29.971360 [debug] [MainThread]: On master: Close
[0m23:15:29.972077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:15:29.972286 [info ] [MainThread]: 
[0m23:15:29.973480 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m23:15:29.973745 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m23:15:29.974040 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m23:15:29.974239 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m23:15:29.977027 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m23:15:29.977537 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m23:15:29.988693 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m23:15:29.989128 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m23:15:29.989314 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m23:15:29.989473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:15:29.992809 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:15:29.993005 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m23:15:29.993208 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m23:15:29.993613 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m23:15:29.993776 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:15:29.993991 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m23:15:29.995302 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m23:15:29.995479 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m23:15:29.997098 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m23:15:29.997873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1341c9c2-46f5-4ba4-8632-ddd004afd90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b44e10>]}
[0m23:15:29.998206 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.02s]
[0m23:15:29.998487 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m23:15:29.998694 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m23:15:29.999191 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m23:15:29.999448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m23:15:29.999635 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m23:15:30.000696 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m23:15:30.001180 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m23:15:30.002469 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m23:15:30.002888 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m23:15:30.003079 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m23:15:30.003273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:30.006058 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:15:30.006333 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m23:15:30.006501 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m23:15:30.006831 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m23:15:30.007008 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:15:30.007212 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m23:15:30.008064 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m23:15:30.008259 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m23:15:30.009589 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m23:15:30.009791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1341c9c2-46f5-4ba4-8632-ddd004afd90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04c7390>]}
[0m23:15:30.010033 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m23:15:30.010303 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m23:15:30.010515 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m23:15:30.010764 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m23:15:30.010984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m23:15:30.011167 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m23:15:30.012129 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m23:15:30.012560 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m23:15:30.013998 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m23:15:30.014438 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:15:30.014614 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m23:15:30.014804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:30.017679 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:15:30.017989 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:15:30.018197 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m23:15:30.018574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:15:30.021015 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:15:30.021211 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m23:15:30.021532 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:15:30.022598 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:15:30.022775 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m23:15:30.023012 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:15:30.028974 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m23:15:30.029167 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:15:30.029341 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m23:15:30.030035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:15:30.031845 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:15:30.032027 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m23:15:30.032453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:15:30.033378 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m23:15:30.035007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1341c9c2-46f5-4ba4-8632-ddd004afd90e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b76510>]}
[0m23:15:30.035309 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m23:15:30.035590 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m23:15:30.036207 [debug] [MainThread]: Using duckdb connection "master"
[0m23:15:30.036416 [debug] [MainThread]: On master: BEGIN
[0m23:15:30.036572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:15:30.039616 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:15:30.039791 [debug] [MainThread]: On master: COMMIT
[0m23:15:30.039949 [debug] [MainThread]: Using duckdb connection "master"
[0m23:15:30.040082 [debug] [MainThread]: On master: COMMIT
[0m23:15:30.040352 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:15:30.040521 [debug] [MainThread]: On master: Close
[0m23:15:30.041208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:30.041346 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m23:15:30.041486 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m23:15:30.041613 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m23:15:30.041804 [info ] [MainThread]: 
[0m23:15:30.041970 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m23:15:30.042331 [debug] [MainThread]: Command end result
[0m23:15:30.079150 [info ] [MainThread]: 
[0m23:15:30.079426 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:15:30.079656 [info ] [MainThread]: 
[0m23:15:30.080134 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m23:15:30.080362 [info ] [MainThread]: 
[0m23:15:30.080553 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m23:15:30.080763 [info ] [MainThread]: 
[0m23:15:30.080958 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m23:15:30.081390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39429387, "process_user_time": 0.737312, "process_kernel_time": 0.060943, "process_mem_max_rss": "253664", "process_out_blocks": "2359", "command_success": false, "process_in_blocks": "0"}
[0m23:15:30.081613 [debug] [MainThread]: Command `dbt run` failed at 23:15:30.081576 after 0.39 seconds
[0m23:15:30.081798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5089010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40b2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40b2c10>]}
[0m23:15:30.081971 [debug] [MainThread]: Flushing usage events
[0m00:25:39.956391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf60f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2ce1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1dc6450>]}


============================== 00:25:39.957785 | bb382a14-c54d-4969-a59f-6af74a265107 ==============================
[0m00:25:39.957785 [info ] [MainThread]: Running with dbt=1.8.0
[0m00:25:39.958167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m00:25:40.037279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb382a14-c54d-4969-a59f-6af74a265107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2fbdd0>]}
[0m00:25:40.054610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb382a14-c54d-4969-a59f-6af74a265107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16a3290>]}
[0m00:25:40.054995 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m00:25:40.079909 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m00:25:40.123353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:25:40.123585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:25:40.139554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb382a14-c54d-4969-a59f-6af74a265107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf33d6d0>]}
[0m00:25:40.179706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb382a14-c54d-4969-a59f-6af74a265107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6477f10>]}
[0m00:25:40.179991 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m00:25:40.180199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb382a14-c54d-4969-a59f-6af74a265107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68c2350>]}
[0m00:25:40.181057 [info ] [MainThread]: 
[0m00:25:40.181372 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:25:40.183321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m00:25:40.197207 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m00:25:40.197482 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m00:25:40.197684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:40.201848 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:25:40.202391 [debug] [ThreadPool]: On list_thrive: Close
[0m00:25:40.203562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m00:25:40.203888 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m00:25:40.206478 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m00:25:40.206664 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m00:25:40.206848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:40.209600 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:25:40.210205 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m00:25:40.210406 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m00:25:40.210717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:25:40.210909 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m00:25:40.211075 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m00:25:40.211359 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:25:40.211717 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m00:25:40.211888 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m00:25:40.212063 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m00:25:40.212460 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:25:40.212745 [debug] [ThreadPool]: On create_thrive_main: Close
[0m00:25:40.213905 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m00:25:40.215918 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m00:25:40.216087 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m00:25:40.216244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:40.219482 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:25:40.219654 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m00:25:40.219833 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m00:25:40.227953 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m00:25:40.228550 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m00:25:40.228889 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m00:25:40.229058 [debug] [ThreadPool]: On list_thrive_main: Close
[0m00:25:40.230257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb382a14-c54d-4969-a59f-6af74a265107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6998810>]}
[0m00:25:40.230496 [debug] [MainThread]: Using duckdb connection "master"
[0m00:25:40.230665 [debug] [MainThread]: On master: BEGIN
[0m00:25:40.230827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:25:40.233777 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m00:25:40.234056 [debug] [MainThread]: On master: COMMIT
[0m00:25:40.234249 [debug] [MainThread]: Using duckdb connection "master"
[0m00:25:40.234411 [debug] [MainThread]: On master: COMMIT
[0m00:25:40.234700 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:25:40.234935 [debug] [MainThread]: On master: Close
[0m00:25:40.235775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:25:40.236060 [info ] [MainThread]: 
[0m00:25:40.237283 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m00:25:40.237549 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m00:25:40.237877 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m00:25:40.238071 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m00:25:40.240855 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m00:25:40.241352 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m00:25:40.252465 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m00:25:40.252954 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m00:25:40.253135 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m00:25:40.253307 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:25:40.256575 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:25:40.256789 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m00:25:40.256983 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m00:25:40.257358 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m00:25:40.257546 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:25:40.257760 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m00:25:40.258998 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m00:25:40.259156 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m00:25:40.260751 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m00:25:40.261602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb382a14-c54d-4969-a59f-6af74a265107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa595d690>]}
[0m00:25:40.262131 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.02s]
[0m00:25:40.262648 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m00:25:40.262971 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m00:25:40.263594 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m00:25:40.264078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m00:25:40.264300 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m00:25:40.265623 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m00:25:40.266116 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m00:25:40.267480 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m00:25:40.268010 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m00:25:40.268190 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m00:25:40.268349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:40.271376 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:25:40.271611 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m00:25:40.271801 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m00:25:40.272195 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m00:25:40.272373 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:25:40.272585 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m00:25:40.273534 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m00:25:40.273762 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m00:25:40.275575 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m00:25:40.275910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb382a14-c54d-4969-a59f-6af74a265107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa648af90>]}
[0m00:25:40.276226 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m00:25:40.276511 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m00:25:40.276723 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m00:25:40.276983 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m00:25:40.277219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m00:25:40.277411 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m00:25:40.278756 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m00:25:40.279264 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m00:25:40.280767 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m00:25:40.281195 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m00:25:40.281398 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m00:25:40.281575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:40.285787 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:25:40.286084 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m00:25:40.286604 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m00:25:40.287051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:25:40.289744 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m00:25:40.289956 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m00:25:40.290277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:25:40.291565 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m00:25:40.292000 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m00:25:40.292382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:25:40.299072 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m00:25:40.299351 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m00:25:40.299563 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m00:25:40.303996 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:25:40.306496 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m00:25:40.306877 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m00:25:40.307547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:25:40.308738 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m00:25:40.310898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb382a14-c54d-4969-a59f-6af74a265107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59563d0>]}
[0m00:25:40.311304 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.03s]
[0m00:25:40.311633 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m00:25:40.312301 [debug] [MainThread]: Using duckdb connection "master"
[0m00:25:40.312514 [debug] [MainThread]: On master: BEGIN
[0m00:25:40.312683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:25:40.316248 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m00:25:40.316443 [debug] [MainThread]: On master: COMMIT
[0m00:25:40.316607 [debug] [MainThread]: Using duckdb connection "master"
[0m00:25:40.316753 [debug] [MainThread]: On master: COMMIT
[0m00:25:40.317018 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:25:40.317236 [debug] [MainThread]: On master: Close
[0m00:25:40.317984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:40.318211 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m00:25:40.318369 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m00:25:40.318518 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m00:25:40.318716 [info ] [MainThread]: 
[0m00:25:40.318899 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m00:25:40.319271 [debug] [MainThread]: Command end result
[0m00:25:40.355354 [info ] [MainThread]: 
[0m00:25:40.355632 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:25:40.355794 [info ] [MainThread]: 
[0m00:25:40.356017 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m00:25:40.356233 [info ] [MainThread]: 
[0m00:25:40.356446 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m00:25:40.356609 [info ] [MainThread]: 
[0m00:25:40.356799 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m00:25:40.357371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4265522, "process_user_time": 0.804791, "process_kernel_time": 0.067401, "process_mem_max_rss": "253616", "process_out_blocks": "2359", "command_success": false, "process_in_blocks": "0"}
[0m00:25:40.357665 [debug] [MainThread]: Command `dbt run` failed at 00:25:40.357627 after 0.43 seconds
[0m00:25:40.357863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb403dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb403dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a697ed0>]}
[0m00:25:40.358038 [debug] [MainThread]: Flushing usage events
[0m01:40:35.038280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaffc8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafffdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaffcb1d0>]}


============================== 01:40:35.039629 | de1e0355-522e-440f-bd4a-165b10119a68 ==============================
[0m01:40:35.039629 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:40:35.039976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m01:40:35.126759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de1e0355-522e-440f-bd4a-165b10119a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb006d4d0>]}
[0m01:40:35.148807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de1e0355-522e-440f-bd4a-165b10119a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb000c110>]}
[0m01:40:35.149275 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m01:40:35.178978 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:40:35.233185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:40:35.233457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:40:35.253725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1e0355-522e-440f-bd4a-165b10119a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73b5390>]}
[0m01:40:35.304420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de1e0355-522e-440f-bd4a-165b10119a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa71a7f50>]}
[0m01:40:35.304726 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m01:40:35.304935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1e0355-522e-440f-bd4a-165b10119a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7712850>]}
[0m01:40:35.305838 [info ] [MainThread]: 
[0m01:40:35.306158 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:40:35.308412 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m01:40:35.324712 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m01:40:35.324978 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m01:40:35.325162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:35.329955 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m01:40:35.330693 [debug] [ThreadPool]: On list_thrive: Close
[0m01:40:35.332029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m01:40:35.332452 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m01:40:35.335783 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:40:35.336015 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m01:40:35.336220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:35.339842 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:40:35.340564 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:40:35.340809 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m01:40:35.341315 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:40:35.341709 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:40:35.341979 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m01:40:35.342394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:40:35.342883 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m01:40:35.343102 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:40:35.343307 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m01:40:35.343628 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:40:35.343846 [debug] [ThreadPool]: On create_thrive_main: Close
[0m01:40:35.345324 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m01:40:35.347938 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:40:35.348167 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m01:40:35.348369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:35.352023 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:40:35.352241 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:40:35.352445 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m01:40:35.362631 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m01:40:35.363295 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m01:40:35.363702 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m01:40:35.363905 [debug] [ThreadPool]: On list_thrive_main: Close
[0m01:40:35.365392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1e0355-522e-440f-bd4a-165b10119a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7196510>]}
[0m01:40:35.365685 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:35.365897 [debug] [MainThread]: On master: BEGIN
[0m01:40:35.366092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:35.369868 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m01:40:35.370110 [debug] [MainThread]: On master: COMMIT
[0m01:40:35.370319 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:35.370520 [debug] [MainThread]: On master: COMMIT
[0m01:40:35.370822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:40:35.371031 [debug] [MainThread]: On master: Close
[0m01:40:35.371844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:35.372088 [info ] [MainThread]: 
[0m01:40:35.373454 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m01:40:35.373792 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m01:40:35.374141 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m01:40:35.374374 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m01:40:35.378010 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m01:40:35.378633 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m01:40:35.393147 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m01:40:35.393754 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m01:40:35.393969 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m01:40:35.394148 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:35.397522 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:40:35.397764 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m01:40:35.397977 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m01:40:35.398431 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m01:40:35.398638 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:40:35.398879 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m01:40:35.400466 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m01:40:35.400668 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m01:40:35.402317 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m01:40:35.403088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1e0355-522e-440f-bd4a-165b10119a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa668cc10>]}
[0m01:40:35.403454 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m01:40:35.403815 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m01:40:35.404080 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m01:40:35.404643 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m01:40:35.404943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m01:40:35.405184 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m01:40:35.406787 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m01:40:35.407337 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m01:40:35.408957 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m01:40:35.409467 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m01:40:35.409695 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m01:40:35.409906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:35.412958 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:40:35.413165 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m01:40:35.413358 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m01:40:35.413748 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m01:40:35.413968 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:40:35.414198 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m01:40:35.415224 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m01:40:35.415420 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m01:40:35.417297 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m01:40:35.417666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1e0355-522e-440f-bd4a-165b10119a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66aa710>]}
[0m01:40:35.417996 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m01:40:35.418299 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m01:40:35.418557 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m01:40:35.419016 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m01:40:35.419334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m01:40:35.419569 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m01:40:35.420854 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m01:40:35.421364 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m01:40:35.422967 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m01:40:35.423470 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:40:35.423687 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m01:40:35.423910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:35.427040 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:40:35.427256 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:40:35.427454 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m01:40:35.427827 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:40:35.430827 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:40:35.431047 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m01:40:35.431359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:40:35.432683 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:40:35.432888 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m01:40:35.433405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:40:35.440929 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m01:40:35.441166 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:40:35.441381 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m01:40:35.442116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:40:35.444229 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:40:35.444438 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m01:40:35.444869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:40:35.445980 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m01:40:35.448010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1e0355-522e-440f-bd4a-165b10119a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66fb410>]}
[0m01:40:35.448333 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.03s]
[0m01:40:35.448641 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m01:40:35.449308 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:35.449517 [debug] [MainThread]: On master: BEGIN
[0m01:40:35.449716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:35.453269 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:40:35.453620 [debug] [MainThread]: On master: COMMIT
[0m01:40:35.453813 [debug] [MainThread]: Using duckdb connection "master"
[0m01:40:35.453969 [debug] [MainThread]: On master: COMMIT
[0m01:40:35.454281 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:40:35.454559 [debug] [MainThread]: On master: Close
[0m01:40:35.455596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:35.455798 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m01:40:35.456022 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m01:40:35.456222 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m01:40:35.456436 [info ] [MainThread]: 
[0m01:40:35.456649 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m01:40:35.457071 [debug] [MainThread]: Command end result
[0m01:40:35.497611 [info ] [MainThread]: 
[0m01:40:35.498044 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:40:35.498273 [info ] [MainThread]: 
[0m01:40:35.498511 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m01:40:35.498704 [info ] [MainThread]: 
[0m01:40:35.498900 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m01:40:35.499167 [info ] [MainThread]: 
[0m01:40:35.499358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m01:40:35.499809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4813685, "process_user_time": 0.88383, "process_kernel_time": 0.074661, "process_mem_max_rss": "253620", "process_out_blocks": "2359", "command_success": false, "process_in_blocks": "0"}
[0m01:40:35.500069 [debug] [MainThread]: Command `dbt run` failed at 01:40:35.500029 after 0.48 seconds
[0m01:40:35.500279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d6de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23e8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4452810>]}
[0m01:40:35.500477 [debug] [MainThread]: Flushing usage events
[0m17:32:43.014288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d167d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6bcb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6beff90>]}


============================== 17:32:43.022504 | 4981eaf4-440b-4b5f-a7ab-c550d6bd4646 ==============================
[0m17:32:43.022504 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:32:43.022915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:32:43.105009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4981eaf4-440b-4b5f-a7ab-c550d6bd4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c2d390>]}
[0m17:32:43.122538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4981eaf4-440b-4b5f-a7ab-c550d6bd4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9123bd0>]}
[0m17:32:43.122911 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:32:43.147737 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:32:43.192600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:43.192808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:43.208600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4981eaf4-440b-4b5f-a7ab-c550d6bd4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfe6990>]}
[0m17:32:43.263541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4981eaf4-440b-4b5f-a7ab-c550d6bd4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaddb4750>]}
[0m17:32:43.263853 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:32:43.264136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4981eaf4-440b-4b5f-a7ab-c550d6bd4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b0bd90>]}
[0m17:32:43.264916 [info ] [MainThread]: 
[0m17:32:43.265239 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:32:43.267212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:32:43.282551 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:32:43.282800 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:32:43.283030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:43.287460 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:32:43.288131 [debug] [ThreadPool]: On list_thrive: Close
[0m17:32:43.288999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:32:43.289267 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:32:43.292028 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:32:43.292210 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:32:43.292349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:43.295477 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:32:43.296098 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:32:43.296266 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:32:43.296653 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:32:43.296929 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:32:43.297086 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:32:43.297323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:32:43.297676 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:32:43.297866 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:32:43.298046 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:32:43.298373 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:32:43.298618 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:32:43.299815 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:32:43.301954 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:32:43.302132 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:32:43.302297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:43.305447 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:32:43.305656 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:32:43.305843 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:32:43.314109 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:32:43.314699 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:32:43.315045 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:32:43.315214 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:32:43.316397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4981eaf4-440b-4b5f-a7ab-c550d6bd4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c18cd0>]}
[0m17:32:43.316644 [debug] [MainThread]: Using duckdb connection "master"
[0m17:32:43.316833 [debug] [MainThread]: On master: BEGIN
[0m17:32:43.316995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:43.320238 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:32:43.320426 [debug] [MainThread]: On master: COMMIT
[0m17:32:43.320593 [debug] [MainThread]: Using duckdb connection "master"
[0m17:32:43.320776 [debug] [MainThread]: On master: COMMIT
[0m17:32:43.321226 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:32:43.321595 [debug] [MainThread]: On master: Close
[0m17:32:43.322466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:43.322686 [info ] [MainThread]: 
[0m17:32:43.324256 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:32:43.324553 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:32:43.324843 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:32:43.325037 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:32:43.328036 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:32:43.328643 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:32:43.339532 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:32:43.340196 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:32:43.340410 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:32:43.340591 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:43.344161 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:32:43.344376 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:32:43.344561 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m17:32:43.345210 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m17:32:43.345381 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:32:43.345580 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m17:32:43.346988 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m17:32:43.347172 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:32:43.348538 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:32:43.349214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4981eaf4-440b-4b5f-a7ab-c550d6bd4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2dd810>]}
[0m17:32:43.349492 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.02s]
[0m17:32:43.349774 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:32:43.349989 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:32:43.350472 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:32:43.350701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:32:43.350893 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:32:43.352931 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:32:43.353474 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:32:43.354792 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:32:43.355272 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:32:43.355460 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:32:43.355648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:43.358316 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:32:43.358495 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:32:43.358677 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m17:32:43.359012 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m17:32:43.359170 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:32:43.359355 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m17:32:43.360206 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m17:32:43.360367 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:32:43.361713 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:32:43.361964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4981eaf4-440b-4b5f-a7ab-c550d6bd4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad28d1d0>]}
[0m17:32:43.362205 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m17:32:43.362453 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:32:43.362661 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:32:43.362902 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:32:43.363113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:32:43.363281 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:32:43.364406 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:32:43.364941 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:32:43.366179 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:32:43.366641 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:32:43.366841 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:32:43.367067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:43.369640 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:32:43.369822 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:32:43.369985 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m17:32:43.370307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:32:43.372625 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:32:43.372802 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:32:43.373060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:32:43.378339 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:32:43.378554 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:32:43.378755 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:32:43.379431 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:32:43.381126 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:32:43.381294 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:32:43.381766 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:32:43.382895 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:32:43.384564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4981eaf4-440b-4b5f-a7ab-c550d6bd4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad260410>]}
[0m17:32:43.384896 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m17:32:43.385159 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:32:43.385851 [debug] [MainThread]: Using duckdb connection "master"
[0m17:32:43.386050 [debug] [MainThread]: On master: BEGIN
[0m17:32:43.386217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:43.389235 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:32:43.389415 [debug] [MainThread]: On master: COMMIT
[0m17:32:43.389580 [debug] [MainThread]: Using duckdb connection "master"
[0m17:32:43.389747 [debug] [MainThread]: On master: COMMIT
[0m17:32:43.390164 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:32:43.390434 [debug] [MainThread]: On master: Close
[0m17:32:43.391454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:43.391810 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:32:43.391977 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:32:43.392108 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:32:43.392280 [info ] [MainThread]: 
[0m17:32:43.392455 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:32:43.392830 [debug] [MainThread]: Command end result
[0m17:32:43.429014 [info ] [MainThread]: 
[0m17:32:43.429291 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:32:43.429544 [info ] [MainThread]: 
[0m17:32:43.429913 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:32:43.430135 [info ] [MainThread]: 
[0m17:32:43.430309 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:32:43.430473 [info ] [MainThread]: 
[0m17:32:43.430646 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:32:43.431055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.43384972, "process_user_time": 0.856903, "process_kernel_time": 0.064443, "process_mem_max_rss": "251656", "process_in_blocks": "16032", "process_out_blocks": "7614", "command_success": false}
[0m17:32:43.431274 [debug] [MainThread]: Command `dbt run` failed at 17:32:43.431240 after 0.43 seconds
[0m17:32:43.431464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1eadd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1eaf190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1eacf10>]}
[0m17:32:43.431649 [debug] [MainThread]: Flushing usage events
[0m17:33:45.074686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811e7150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81088690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811e5990>]}


============================== 17:33:45.075868 | 719726dd-2d96-41ba-9f47-5c5862cc6e16 ==============================
[0m17:33:45.075868 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:33:45.076209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:45.143356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '719726dd-2d96-41ba-9f47-5c5862cc6e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8112d590>]}
[0m17:33:45.160349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '719726dd-2d96-41ba-9f47-5c5862cc6e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83492e90>]}
[0m17:33:45.160703 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:33:45.184050 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:33:45.227260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:33:45.227492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:33:45.243433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '719726dd-2d96-41ba-9f47-5c5862cc6e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78477dd0>]}
[0m17:33:45.284178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '719726dd-2d96-41ba-9f47-5c5862cc6e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78267f50>]}
[0m17:33:45.284486 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:33:45.284713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '719726dd-2d96-41ba-9f47-5c5862cc6e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81139dd0>]}
[0m17:33:45.285495 [info ] [MainThread]: 
[0m17:33:45.285811 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:33:45.287755 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:33:45.300358 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:33:45.300583 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:33:45.300764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:45.304761 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:33:45.305294 [debug] [ThreadPool]: On list_thrive: Close
[0m17:33:45.306257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:33:45.306490 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:33:45.308957 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:33:45.309166 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:33:45.309389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:45.312118 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:33:45.312668 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:33:45.312844 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:33:45.313270 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:45.313542 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:33:45.313727 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:33:45.314025 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:45.314421 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:33:45.314594 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:33:45.314755 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:33:45.315090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:45.315341 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:33:45.316507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:33:45.318533 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:33:45.318714 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:33:45.318869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:45.321829 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:33:45.322093 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:33:45.322302 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:33:45.330244 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:33:45.330839 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:33:45.331176 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:33:45.331367 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:33:45.332730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '719726dd-2d96-41ba-9f47-5c5862cc6e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78773d10>]}
[0m17:33:45.332976 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:45.333156 [debug] [MainThread]: On master: BEGIN
[0m17:33:45.333332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:45.336278 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:33:45.336556 [debug] [MainThread]: On master: COMMIT
[0m17:33:45.336749 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:45.336913 [debug] [MainThread]: On master: COMMIT
[0m17:33:45.337260 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:45.337500 [debug] [MainThread]: On master: Close
[0m17:33:45.338326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:45.338597 [info ] [MainThread]: 
[0m17:33:45.339800 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:33:45.340060 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:33:45.340355 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:33:45.340558 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:33:45.343378 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:33:45.343866 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:33:45.356183 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:33:45.356968 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:33:45.357237 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:33:45.357443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:33:45.360470 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:33:45.360679 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:33:45.360846 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m17:33:45.361286 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m17:33:45.361464 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:33:45.361831 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m17:33:45.363322 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m17:33:45.363623 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:33:45.365381 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:33:45.366115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719726dd-2d96-41ba-9f47-5c5862cc6e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7777c210>]}
[0m17:33:45.366649 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m17:33:45.367147 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:33:45.367502 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:33:45.368064 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:33:45.368346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:33:45.368601 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:33:45.370050 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:33:45.371566 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:33:45.374193 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:33:45.376146 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:33:45.376897 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:33:45.377442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:45.382845 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:33:45.383294 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:33:45.383837 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m17:33:45.384568 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m17:33:45.384877 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:33:45.385194 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m17:33:45.386213 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m17:33:45.386416 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:33:45.388025 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:33:45.388326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719726dd-2d96-41ba-9f47-5c5862cc6e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77740fd0>]}
[0m17:33:45.388685 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.02s]
[0m17:33:45.388969 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:33:45.389234 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:33:45.389551 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:33:45.389790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:33:45.389977 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:33:45.391185 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:33:45.391746 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:33:45.393091 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:33:45.393564 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:33:45.393755 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:33:45.393928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:45.396959 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:33:45.397164 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:33:45.397346 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m17:33:45.397725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:45.400176 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:33:45.400375 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:33:45.400639 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:45.401681 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:33:45.401841 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:33:45.402071 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:45.408378 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:33:45.408618 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:33:45.408834 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:33:45.409613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:33:45.411334 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:33:45.411523 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:33:45.411943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:45.412989 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:33:45.414830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719726dd-2d96-41ba-9f47-5c5862cc6e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7773b650>]}
[0m17:33:45.415137 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.03s]
[0m17:33:45.415412 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:33:45.416100 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:45.416325 [debug] [MainThread]: On master: BEGIN
[0m17:33:45.416497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:45.419554 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:33:45.419728 [debug] [MainThread]: On master: COMMIT
[0m17:33:45.419887 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:45.420020 [debug] [MainThread]: On master: COMMIT
[0m17:33:45.420329 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:45.420564 [debug] [MainThread]: On master: Close
[0m17:33:45.421352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:45.421566 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:33:45.421882 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:33:45.422056 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:33:45.423340 [info ] [MainThread]: 
[0m17:33:45.423633 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m17:33:45.424510 [debug] [MainThread]: Command end result
[0m17:33:45.468834 [info ] [MainThread]: 
[0m17:33:45.469180 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:33:45.469482 [info ] [MainThread]: 
[0m17:33:45.469780 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:33:45.469996 [info ] [MainThread]: 
[0m17:33:45.470238 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:33:45.470410 [info ] [MainThread]: 
[0m17:33:45.470581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:33:45.471096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.41264403, "process_user_time": 0.74858, "process_kernel_time": 0.068418, "process_mem_max_rss": "251648", "process_out_blocks": "2359", "command_success": false, "process_in_blocks": "0"}
[0m17:33:45.471468 [debug] [MainThread]: Command `dbt run` failed at 17:33:45.471392 after 0.41 seconds
[0m17:33:45.471732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff745176d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74514490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74514f10>]}
[0m17:33:45.471947 [debug] [MainThread]: Flushing usage events
[0m17:34:47.362626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6691290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb67f8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb866a010>]}


============================== 17:34:47.364095 | e611482b-f0d7-45cc-932f-71342cbf729f ==============================
[0m17:34:47.364095 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:34:47.364456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:34:47.431762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e611482b-f0d7-45cc-932f-71342cbf729f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade3ee10>]}
[0m17:34:47.448682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e611482b-f0d7-45cc-932f-71342cbf729f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8aa2f10>]}
[0m17:34:47.449053 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:34:47.472594 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:34:47.515094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:47.515331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:47.531118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e611482b-f0d7-45cc-932f-71342cbf729f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6730810>]}
[0m17:34:47.571355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e611482b-f0d7-45cc-932f-71342cbf729f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad877f90>]}
[0m17:34:47.571652 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:34:47.571837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e611482b-f0d7-45cc-932f-71342cbf729f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc06850>]}
[0m17:34:47.572640 [info ] [MainThread]: 
[0m17:34:47.572935 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:34:47.574956 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:34:47.587778 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:34:47.588008 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:34:47.588198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:47.592243 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:34:47.592810 [debug] [ThreadPool]: On list_thrive: Close
[0m17:34:47.594003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:34:47.594255 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:34:47.596715 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:34:47.596908 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:34:47.597084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:47.600087 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:34:47.600645 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:34:47.600831 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:34:47.601119 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:47.601291 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:34:47.601463 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:34:47.601788 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:47.602141 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:34:47.602316 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:34:47.602495 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:34:47.602826 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:47.603023 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:34:47.604109 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:34:47.606079 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:34:47.606253 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:34:47.606413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:47.609517 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:34:47.609710 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:34:47.609884 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:34:47.617882 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:34:47.618420 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:34:47.618793 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:34:47.618984 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:34:47.620169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e611482b-f0d7-45cc-932f-71342cbf729f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada94290>]}
[0m17:34:47.620405 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:47.620588 [debug] [MainThread]: On master: BEGIN
[0m17:34:47.620780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:47.623633 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:34:47.623841 [debug] [MainThread]: On master: COMMIT
[0m17:34:47.624013 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:47.624181 [debug] [MainThread]: On master: COMMIT
[0m17:34:47.624446 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:34:47.624665 [debug] [MainThread]: On master: Close
[0m17:34:47.625389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:47.625625 [info ] [MainThread]: 
[0m17:34:47.626814 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:34:47.627104 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:34:47.627381 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:34:47.627568 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:34:47.630304 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:34:47.630844 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:34:47.642119 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:34:47.642626 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:34:47.642836 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:34:47.642999 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:34:47.646002 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:34:47.646206 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:34:47.646385 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m17:34:47.646760 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m17:34:47.646945 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:34:47.647145 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m17:34:47.648423 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m17:34:47.648600 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:34:47.650059 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:34:47.650740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e611482b-f0d7-45cc-932f-71342cbf729f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb672c250>]}
[0m17:34:47.651044 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.02s]
[0m17:34:47.651338 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:34:47.651567 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:34:47.652033 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:34:47.652285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:34:47.652476 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:34:47.653589 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:34:47.654160 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:34:47.655615 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:34:47.656025 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:34:47.656205 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:34:47.656371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:47.659276 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:34:47.659616 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:34:47.659819 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m17:34:47.660175 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m17:34:47.660343 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:34:47.660542 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m17:34:47.661426 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m17:34:47.661596 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:34:47.662954 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:34:47.663158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e611482b-f0d7-45cc-932f-71342cbf729f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd5d2d0>]}
[0m17:34:47.663404 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m17:34:47.663676 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:34:47.663892 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:34:47.664156 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:34:47.664398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:34:47.664602 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:34:47.665835 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:34:47.666234 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:34:47.667532 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:34:47.667935 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:34:47.668110 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:34:47.668255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:47.670859 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:34:47.671038 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:34:47.671182 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m17:34:47.671519 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:34:47.673907 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:34:47.674076 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:34:47.674341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:34:47.675374 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:34:47.675547 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:34:47.675792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:34:47.681823 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:34:47.682009 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:34:47.682159 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:34:47.682839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:34:47.684642 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:34:47.684852 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:34:47.685315 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:34:47.686241 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:34:47.687944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e611482b-f0d7-45cc-932f-71342cbf729f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaccf8b90>]}
[0m17:34:47.688215 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m17:34:47.688514 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:34:47.689102 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:47.689296 [debug] [MainThread]: On master: BEGIN
[0m17:34:47.689449 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:47.692509 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:34:47.692833 [debug] [MainThread]: On master: COMMIT
[0m17:34:47.693019 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:47.693149 [debug] [MainThread]: On master: COMMIT
[0m17:34:47.693346 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:34:47.693509 [debug] [MainThread]: On master: Close
[0m17:34:47.694310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:47.694472 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:34:47.694623 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:34:47.694761 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:34:47.694963 [info ] [MainThread]: 
[0m17:34:47.695157 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m17:34:47.695760 [debug] [MainThread]: Command end result
[0m17:34:47.731669 [info ] [MainThread]: 
[0m17:34:47.731948 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:34:47.732112 [info ] [MainThread]: 
[0m17:34:47.732322 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:34:47.732603 [info ] [MainThread]: 
[0m17:34:47.732951 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:34:47.733229 [info ] [MainThread]: 
[0m17:34:47.733448 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:34:47.733921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38921863, "process_user_time": 0.764947, "process_kernel_time": 0.047556, "process_mem_max_rss": "251664", "process_out_blocks": "2359", "command_success": false, "process_in_blocks": "0"}
[0m17:34:47.734156 [debug] [MainThread]: Command `dbt run` failed at 17:34:47.734119 after 0.39 seconds
[0m17:34:47.734350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac375250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac375750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85a0f90>]}
[0m17:34:47.734529 [debug] [MainThread]: Flushing usage events
[0m17:35:49.255664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d2cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d2ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d2d290>]}


============================== 17:35:49.256829 | 093f48e3-3bc5-40b1-9a78-3a17f1a54544 ==============================
[0m17:35:49.256829 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:35:49.257168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:49.325147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '093f48e3-3bc5-40b1-9a78-3a17f1a54544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff714a2150>]}
[0m17:35:49.342318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '093f48e3-3bc5-40b1-9a78-3a17f1a54544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71324390>]}
[0m17:35:49.342677 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:35:49.366071 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:35:49.408866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:35:49.409107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:35:49.424983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '093f48e3-3bc5-40b1-9a78-3a17f1a54544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710eb790>]}
[0m17:35:49.464997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '093f48e3-3bc5-40b1-9a78-3a17f1a54544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70ed7f90>]}
[0m17:35:49.465275 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:35:49.465465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '093f48e3-3bc5-40b1-9a78-3a17f1a54544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71268d90>]}
[0m17:35:49.466267 [info ] [MainThread]: 
[0m17:35:49.466551 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:49.468490 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:35:49.481021 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:35:49.481258 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:35:49.481456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:49.485540 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:35:49.486086 [debug] [ThreadPool]: On list_thrive: Close
[0m17:35:49.487030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:35:49.487283 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:35:49.489780 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:35:49.489983 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:35:49.490189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:49.492836 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:35:49.493412 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:35:49.493585 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:35:49.494010 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:49.494308 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:35:49.494514 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:35:49.494821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:49.495228 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:35:49.495416 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:35:49.495591 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:35:49.495862 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:49.496054 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:35:49.497269 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:35:49.499269 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:35:49.499440 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:35:49.499606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:49.502443 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:35:49.502633 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:35:49.502807 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:35:49.510771 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:35:49.511323 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:35:49.511704 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:35:49.511883 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:35:49.513108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '093f48e3-3bc5-40b1-9a78-3a17f1a54544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff711bf090>]}
[0m17:35:49.513340 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:49.513520 [debug] [MainThread]: On master: BEGIN
[0m17:35:49.513685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:49.516582 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:35:49.516765 [debug] [MainThread]: On master: COMMIT
[0m17:35:49.516949 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:49.517117 [debug] [MainThread]: On master: COMMIT
[0m17:35:49.517586 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:49.517910 [debug] [MainThread]: On master: Close
[0m17:35:49.518634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:49.518854 [info ] [MainThread]: 
[0m17:35:49.520090 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:35:49.520360 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:35:49.520645 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:35:49.520838 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:35:49.523671 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:35:49.524179 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:35:49.535290 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:35:49.535827 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:35:49.536086 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:35:49.536418 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:35:49.539622 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:35:49.539821 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:35:49.540013 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m17:35:49.540420 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    select
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    "SIGNUPDATE" as signup_date
from "thrive"."main"."raw_customers"
  );

[0m17:35:49.540610 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:49.540799 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m17:35:49.542029 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m17:35:49.542212 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:35:49.543650 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:35:49.544288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '093f48e3-3bc5-40b1-9a78-3a17f1a54544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff703c4a50>]}
[0m17:35:49.544596 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.02s]
[0m17:35:49.544878 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:35:49.545096 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:35:49.545570 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:35:49.545785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:35:49.545963 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:35:49.547078 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:35:49.547655 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:35:49.548981 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:35:49.549443 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:35:49.549621 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:35:49.549791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:49.552505 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:35:49.552813 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:35:49.552985 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m17:35:49.553341 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    select
    "ORDERID" as order_id,
    "CUSTOMERID" as customer_id,
    cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    cast("ORDERDATE" as TIMESTAMP) as order_date
from "thrive"."main"."raw_sales"
  );

[0m17:35:49.553510 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:49.553701 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m17:35:49.554565 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m17:35:49.554720 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:35:49.556097 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:35:49.556336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '093f48e3-3bc5-40b1-9a78-3a17f1a54544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7040e3d0>]}
[0m17:35:49.556600 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m17:35:49.556871 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:35:49.557096 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:35:49.557349 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:35:49.557576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:35:49.557776 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:35:49.558720 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:35:49.559184 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:35:49.560674 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:35:49.561136 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:35:49.561326 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:35:49.561501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:49.564156 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:35:49.564370 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:35:49.564550 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m17:35:49.564899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:49.567328 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:35:49.567512 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:35:49.567799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:49.568842 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:35:49.569007 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:35:49.569273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:49.575284 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:35:49.575481 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:35:49.575664 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:35:49.576330 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:49.578162 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:35:49.578352 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:35:49.578817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:49.579730 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:35:49.581386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '093f48e3-3bc5-40b1-9a78-3a17f1a54544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702fd350>]}
[0m17:35:49.581670 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m17:35:49.581957 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:35:49.582558 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:49.582745 [debug] [MainThread]: On master: BEGIN
[0m17:35:49.582896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:49.586071 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:35:49.586355 [debug] [MainThread]: On master: COMMIT
[0m17:35:49.586520 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:49.586658 [debug] [MainThread]: On master: COMMIT
[0m17:35:49.586894 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:49.587080 [debug] [MainThread]: On master: Close
[0m17:35:49.587754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:49.587938 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:35:49.588098 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:35:49.588251 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:35:49.588436 [info ] [MainThread]: 
[0m17:35:49.588638 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m17:35:49.589407 [debug] [MainThread]: Command end result
[0m17:35:49.627616 [info ] [MainThread]: 
[0m17:35:49.627883 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:35:49.628140 [info ] [MainThread]: 
[0m17:35:49.628417 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:35:49.628627 [info ] [MainThread]: 
[0m17:35:49.628807 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     cast("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      cast("ORDERDATE" as TIMESTAMP) as order_date
  from "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:35:49.629040 [info ] [MainThread]: 
[0m17:35:49.629390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:35:49.630036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39067513, "process_user_time": 0.725485, "process_kernel_time": 0.083516, "process_mem_max_rss": "251660", "process_out_blocks": "2359", "command_success": false, "process_in_blocks": "0"}
[0m17:35:49.630290 [debug] [MainThread]: Command `dbt run` failed at 17:35:49.630252 after 0.39 seconds
[0m17:35:49.630494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701e3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701e2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701e2810>]}
[0m17:35:49.630683 [debug] [MainThread]: Flushing usage events
[0m17:39:43.801516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d765f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d76ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d978410>]}


============================== 17:39:43.808449 | 2a977c11-63a7-47b3-8c38-802060363733 ==============================
[0m17:39:43.808449 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:39:43.808846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:39:43.876587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d6e2290>]}
[0m17:39:43.893678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fce3990>]}
[0m17:39:43.894019 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:39:43.917733 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:39:43.961407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:39:43.961730 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_customers.sql
[0m17:39:43.961952 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_sales.sql
[0m17:39:44.034769 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:39:44.035259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a7b010>]}
[0m17:39:44.095139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bba450>]}
[0m17:39:44.146036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee07ed0>]}
[0m17:39:44.146367 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:39:44.146675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ad4f50>]}
[0m17:39:44.147452 [info ] [MainThread]: 
[0m17:39:44.147777 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:39:44.149708 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:39:44.185987 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:39:44.186292 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:39:44.186502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:44.190980 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:39:44.191604 [debug] [ThreadPool]: On list_thrive: Close
[0m17:39:44.192586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:39:44.192848 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:39:44.195344 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:39:44.195528 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:39:44.195706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:44.198615 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:39:44.199141 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:39:44.199341 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:39:44.199661 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:39:44.199843 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:39:44.200010 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:39:44.200311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:39:44.200659 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:39:44.200829 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:39:44.201006 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:39:44.201260 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:39:44.201431 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:39:44.202652 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:39:44.204690 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:39:44.204865 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:39:44.205023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:44.208413 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:39:44.208609 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:39:44.208786 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:39:44.217291 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:39:44.217867 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:39:44.218212 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:39:44.218416 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:39:44.219577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee3ca10>]}
[0m17:39:44.219813 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:44.219981 [debug] [MainThread]: On master: BEGIN
[0m17:39:44.220154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:44.223128 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:39:44.223365 [debug] [MainThread]: On master: COMMIT
[0m17:39:44.223540 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:44.223703 [debug] [MainThread]: On master: COMMIT
[0m17:39:44.224151 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:39:44.224481 [debug] [MainThread]: On master: Close
[0m17:39:44.225256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:44.225515 [info ] [MainThread]: 
[0m17:39:44.226737 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:39:44.227011 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:39:44.227302 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:39:44.227500 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:39:44.230269 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:39:44.230921 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:39:44.241708 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:39:44.242437 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:39:44.242652 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:39:44.242852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:39:44.246536 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:39:44.246742 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:39:44.246901 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    CAST("SIGNUPDATE" as TIMESTAMP) as signup_date
FROM "thrive"."main"."raw_customers"
  );

[0m17:39:44.247481 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    CAST("SIGNUPDATE" as TIMESTAMP) as signup_date
FROM "thrive"."main"."raw_customers"
  );

[0m17:39:44.247664 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:44.247865 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m17:39:44.249202 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m17:39:44.249381 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:39:44.250854 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:39:44.251498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2e5690>]}
[0m17:39:44.251761 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.02s]
[0m17:39:44.252044 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:39:44.252274 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:39:44.252742 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:39:44.252972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:39:44.253159 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:39:44.254404 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:39:44.254916 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:39:44.256198 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:39:44.256655 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:39:44.256829 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:39:44.257009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:44.259952 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:39:44.260268 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:39:44.260458 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID" as order_id,  -- Check if it's ORDERID or ORDER_ID
    "CUSTOMERID" as customer_id,
    CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    CAST("ORDERDATE" as TIMESTAMP) as order_date
FROM "thrive"."main"."raw_sales"
  );

[0m17:39:44.260860 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID" as order_id,  -- Check if it's ORDERID or ORDER_ID
    "CUSTOMERID" as customer_id,
    CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    CAST("ORDERDATE" as TIMESTAMP) as order_date
FROM "thrive"."main"."raw_sales"
  );

[0m17:39:44.261035 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:44.261232 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m17:39:44.262096 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m17:39:44.262257 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:39:44.263683 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      CAST("ORDERDATE" as TIMESTAMP) as order_date
  FROM "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:39:44.263888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2bab90>]}
[0m17:39:44.264174 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m17:39:44.264481 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:39:44.264693 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:39:44.264944 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:39:44.265168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:39:44.265363 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:39:44.266593 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:39:44.267068 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:39:44.268371 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:39:44.268825 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:39:44.269009 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:39:44.269183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:44.271969 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:39:44.272147 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:39:44.272319 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m17:39:44.272643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:39:44.275881 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:39:44.276072 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:39:44.276345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:39:44.277399 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:39:44.277586 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:39:44.277844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:39:44.283694 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:39:44.283894 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:39:44.284074 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:39:44.284767 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:39:44.286480 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:39:44.286664 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:39:44.287466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:39:44.288427 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:39:44.290186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a977c11-63a7-47b3-8c38-802060363733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e43f850>]}
[0m17:39:44.290512 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.03s]
[0m17:39:44.290801 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:39:44.291424 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:44.291622 [debug] [MainThread]: On master: BEGIN
[0m17:39:44.291804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:39:44.294816 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:39:44.294996 [debug] [MainThread]: On master: COMMIT
[0m17:39:44.295158 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:44.295341 [debug] [MainThread]: On master: COMMIT
[0m17:39:44.295971 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:39:44.296260 [debug] [MainThread]: On master: Close
[0m17:39:44.296977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:44.297142 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:39:44.297295 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:39:44.297431 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:39:44.297632 [info ] [MainThread]: 
[0m17:39:44.297811 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m17:39:44.298183 [debug] [MainThread]: Command end result
[0m17:39:44.311079 [info ] [MainThread]: 
[0m17:39:44.311319 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:39:44.311478 [info ] [MainThread]: 
[0m17:39:44.311660 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:39:44.311823 [info ] [MainThread]: 
[0m17:39:44.311993 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      CAST("ORDERDATE" as TIMESTAMP) as order_date
  FROM "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:39:44.312163 [info ] [MainThread]: 
[0m17:39:44.312359 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:39:44.312747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5272924, "process_user_time": 0.956567, "process_kernel_time": 0.061421, "process_mem_max_rss": "251580", "process_out_blocks": "8479", "command_success": false, "process_in_blocks": "0"}
[0m17:39:44.312991 [debug] [MainThread]: Command `dbt run` failed at 17:39:44.312956 after 0.53 seconds
[0m17:39:44.313187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2379110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d765ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d764b50>]}
[0m17:39:44.313402 [debug] [MainThread]: Flushing usage events
[0m17:40:46.017885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb110e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10d8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b13810>]}


============================== 17:40:46.019064 | 7a897317-130c-4a52-89b9-c6d5614cc7c7 ==============================
[0m17:40:46.019064 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:40:46.019513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:46.088892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a897317-130c-4a52-89b9-c6d5614cc7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb116fc10>]}
[0m17:40:46.106011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a897317-130c-4a52-89b9-c6d5614cc7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34e3350>]}
[0m17:40:46.106395 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:40:46.130123 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:40:46.173663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:46.173896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:46.189887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a897317-130c-4a52-89b9-c6d5614cc7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8504e10>]}
[0m17:40:46.230083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a897317-130c-4a52-89b9-c6d5614cc7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82b3f10>]}
[0m17:40:46.230372 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:40:46.230699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a897317-130c-4a52-89b9-c6d5614cc7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb116df90>]}
[0m17:40:46.231511 [info ] [MainThread]: 
[0m17:40:46.231836 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:40:46.233817 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:40:46.246808 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:40:46.247039 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:40:46.247224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:46.251253 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:40:46.251841 [debug] [ThreadPool]: On list_thrive: Close
[0m17:40:46.252861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:40:46.253117 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:40:46.255574 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:40:46.255758 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:40:46.255928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:46.258730 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:40:46.259292 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:40:46.259483 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:40:46.259773 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:46.259951 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:40:46.260116 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:40:46.260408 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:46.260784 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:40:46.260968 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:40:46.261132 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:40:46.261607 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:46.261930 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:40:46.263014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:40:46.265096 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:40:46.265289 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:40:46.265456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:46.268519 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:40:46.268701 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:40:46.268882 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:40:46.277064 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:40:46.277644 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:40:46.277989 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:40:46.278164 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:40:46.279584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a897317-130c-4a52-89b9-c6d5614cc7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8517090>]}
[0m17:40:46.279870 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:46.280059 [debug] [MainThread]: On master: BEGIN
[0m17:40:46.280221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:46.283389 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:40:46.283656 [debug] [MainThread]: On master: COMMIT
[0m17:40:46.283856 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:46.284033 [debug] [MainThread]: On master: COMMIT
[0m17:40:46.284374 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:46.284610 [debug] [MainThread]: On master: Close
[0m17:40:46.285413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:46.285700 [info ] [MainThread]: 
[0m17:40:46.286900 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:40:46.287172 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:40:46.287492 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:40:46.287716 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:40:46.290510 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:40:46.290994 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:40:46.302243 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:40:46.303019 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:40:46.303220 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:40:46.303436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:46.306480 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:40:46.306677 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:40:46.306858 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    CAST("SIGNUPDATE" as TIMESTAMP) as signup_date
FROM "thrive"."main"."raw_customers"
  );

[0m17:40:46.307226 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    CAST("SIGNUPDATE" as TIMESTAMP) as signup_date
FROM "thrive"."main"."raw_customers"
  );

[0m17:40:46.307422 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:40:46.307647 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m17:40:46.308905 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m17:40:46.309073 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:40:46.312526 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:40:46.313260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a897317-130c-4a52-89b9-c6d5614cc7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa77f6550>]}
[0m17:40:46.313736 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.03s]
[0m17:40:46.314155 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:40:46.314588 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:40:46.315116 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:40:46.315402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:40:46.315626 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:40:46.316811 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:40:46.317305 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:40:46.318579 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:40:46.319023 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:40:46.319208 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:40:46.319398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:46.322100 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:40:46.322309 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:40:46.322485 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID" as order_id,  -- Check if it's ORDERID or ORDER_ID
    "CUSTOMERID" as customer_id,
    CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    CAST("ORDERDATE" as TIMESTAMP) as order_date
FROM "thrive"."main"."raw_sales"
  );

[0m17:40:46.322834 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID" as order_id,  -- Check if it's ORDERID or ORDER_ID
    "CUSTOMERID" as customer_id,
    CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    CAST("ORDERDATE" as TIMESTAMP) as order_date
FROM "thrive"."main"."raw_sales"
  );

[0m17:40:46.323001 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:40:46.323191 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m17:40:46.324011 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m17:40:46.324168 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:40:46.325624 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      CAST("ORDERDATE" as TIMESTAMP) as order_date
  FROM "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:40:46.325863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a897317-130c-4a52-89b9-c6d5614cc7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7835690>]}
[0m17:40:46.326111 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m17:40:46.326394 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:40:46.326604 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:40:46.326860 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:40:46.327116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:40:46.327314 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:40:46.328267 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:40:46.329096 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:40:46.330572 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:40:46.331114 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:40:46.331320 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:40:46.331514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:46.334207 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:40:46.334412 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:40:46.334696 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m17:40:46.335197 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:46.337805 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:40:46.338026 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:40:46.338349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:46.339446 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:40:46.339630 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:40:46.339884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:46.346872 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:40:46.347108 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:40:46.347335 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:40:46.348003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:46.349876 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:40:46.350045 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:40:46.350435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:46.351402 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:40:46.353402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a897317-130c-4a52-89b9-c6d5614cc7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa855bb50>]}
[0m17:40:46.353724 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.03s]
[0m17:40:46.354001 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:40:46.354668 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:46.354894 [debug] [MainThread]: On master: BEGIN
[0m17:40:46.355050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:46.358130 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:40:46.358305 [debug] [MainThread]: On master: COMMIT
[0m17:40:46.358462 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:46.358631 [debug] [MainThread]: On master: COMMIT
[0m17:40:46.358903 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:46.359078 [debug] [MainThread]: On master: Close
[0m17:40:46.359937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:46.360215 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:40:46.360533 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:40:46.360687 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:40:46.360888 [info ] [MainThread]: 
[0m17:40:46.361091 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:40:46.361518 [debug] [MainThread]: Command end result
[0m17:40:46.397525 [info ] [MainThread]: 
[0m17:40:46.397786 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:40:46.397959 [info ] [MainThread]: 
[0m17:40:46.398184 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:40:46.398608 [info ] [MainThread]: 
[0m17:40:46.398879 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      CAST("ORDERDATE" as TIMESTAMP) as order_date
  FROM "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:40:46.399082 [info ] [MainThread]: 
[0m17:40:46.399303 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:40:46.399735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39793617, "process_user_time": 0.761543, "process_kernel_time": 0.063546, "process_mem_max_rss": "251576", "process_out_blocks": "2361", "command_success": false, "process_in_blocks": "0"}
[0m17:40:46.399975 [debug] [MainThread]: Command `dbt run` failed at 17:40:46.399937 after 0.40 seconds
[0m17:40:46.400172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5e7a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45627d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45626d0>]}
[0m17:40:46.400377 [debug] [MainThread]: Flushing usage events
[0m17:41:47.926102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae48f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae41390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae48c90>]}


============================== 17:41:47.927256 | 9d0d25a4-c400-46a1-bed7-aa13b58f6912 ==============================
[0m17:41:47.927256 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:41:47.927584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:41:47.994640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d0d25a4-c400-46a1-bed7-aa13b58f6912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aeb4e10>]}
[0m17:41:48.011389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d0d25a4-c400-46a1-bed7-aa13b58f6912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d24fa90>]}
[0m17:41:48.011744 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:41:48.035486 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:41:48.078205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:41:48.078427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:41:48.094177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d0d25a4-c400-46a1-bed7-aa13b58f6912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8223ca10>]}
[0m17:41:48.134218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d0d25a4-c400-46a1-bed7-aa13b58f6912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82023a10>]}
[0m17:41:48.134522 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:41:48.134727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0d25a4-c400-46a1-bed7-aa13b58f6912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff823b56d0>]}
[0m17:41:48.135528 [info ] [MainThread]: 
[0m17:41:48.135846 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:41:48.137804 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:41:48.150775 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:41:48.151031 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:41:48.151214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:48.155172 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:41:48.155723 [debug] [ThreadPool]: On list_thrive: Close
[0m17:41:48.156580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:41:48.156830 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:41:48.159292 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:41:48.159482 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:41:48.159654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:48.162295 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:41:48.162820 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:41:48.163005 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:41:48.163314 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:48.163485 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:41:48.163681 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:41:48.163979 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:48.164327 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:41:48.164511 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:41:48.164904 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:41:48.165293 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:48.165499 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:41:48.166753 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:41:48.168935 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:41:48.169112 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:41:48.169275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:48.172221 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:41:48.172396 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:41:48.172565 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:41:48.180550 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:41:48.181123 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:41:48.181460 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:41:48.181635 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:41:48.182878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0d25a4-c400-46a1-bed7-aa13b58f6912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aea7c90>]}
[0m17:41:48.183110 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:48.183292 [debug] [MainThread]: On master: BEGIN
[0m17:41:48.183464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:48.186337 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:41:48.186539 [debug] [MainThread]: On master: COMMIT
[0m17:41:48.186725 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:48.186916 [debug] [MainThread]: On master: COMMIT
[0m17:41:48.187318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:41:48.187617 [debug] [MainThread]: On master: Close
[0m17:41:48.188320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:48.188534 [info ] [MainThread]: 
[0m17:41:48.189773 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:41:48.190080 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:41:48.190370 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:41:48.190564 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:41:48.193362 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:41:48.193891 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:41:48.204851 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:41:48.205673 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:41:48.205880 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:41:48.206072 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:41:48.208909 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:41:48.209128 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:41:48.209310 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    CAST("SIGNUPDATE" as TIMESTAMP) as signup_date
FROM "thrive"."main"."raw_customers"
  );

[0m17:41:48.209714 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID" as customer_id,
    "NAME" as customer_name,
    CAST("SIGNUPDATE" as TIMESTAMP) as signup_date
FROM "thrive"."main"."raw_customers"
  );

[0m17:41:48.209927 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:41:48.210167 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: ROLLBACK
[0m17:41:48.211440 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_customers'
[0m17:41:48.211608 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:41:48.213249 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:41:48.213998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0d25a4-c400-46a1-bed7-aa13b58f6912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8152d990>]}
[0m17:41:48.214324 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.02s]
[0m17:41:48.214615 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:41:48.214834 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:41:48.215347 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:41:48.215632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:41:48.215929 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:41:48.217043 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:41:48.217490 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:41:48.218803 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:41:48.219274 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:41:48.219455 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:41:48.219630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:48.222284 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:41:48.222463 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:41:48.222606 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID" as order_id,  -- Check if it's ORDERID or ORDER_ID
    "CUSTOMERID" as customer_id,
    CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    CAST("ORDERDATE" as TIMESTAMP) as order_date
FROM "thrive"."main"."raw_sales"
  );

[0m17:41:48.222922 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID" as order_id,  -- Check if it's ORDERID or ORDER_ID
    "CUSTOMERID" as customer_id,
    CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    CAST("ORDERDATE" as TIMESTAMP) as order_date
FROM "thrive"."main"."raw_sales"
  );

[0m17:41:48.223122 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:41:48.223354 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m17:41:48.224213 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m17:41:48.224394 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:41:48.225722 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      CAST("ORDERDATE" as TIMESTAMP) as order_date
  FROM "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:41:48.225944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0d25a4-c400-46a1-bed7-aa13b58f6912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814376d0>]}
[0m17:41:48.226207 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m17:41:48.226480 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:41:48.226695 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:41:48.226946 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:41:48.227160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:41:48.227331 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:41:48.228289 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:41:48.228667 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:41:48.230140 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:41:48.230621 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:41:48.230793 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:41:48.230967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:48.233614 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:41:48.233941 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:41:48.234137 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m17:41:48.234493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:48.236899 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:41:48.237086 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:41:48.237368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:48.238444 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:41:48.238627 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:41:48.238870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:48.244903 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:41:48.245109 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:41:48.245292 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:41:48.245975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:48.247804 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:41:48.248023 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:41:48.248488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:48.249432 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:41:48.251108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0d25a4-c400-46a1-bed7-aa13b58f6912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814c3890>]}
[0m17:41:48.251472 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m17:41:48.251751 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:41:48.252415 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:48.252614 [debug] [MainThread]: On master: BEGIN
[0m17:41:48.252775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:48.255704 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:41:48.255907 [debug] [MainThread]: On master: COMMIT
[0m17:41:48.256095 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:48.256270 [debug] [MainThread]: On master: COMMIT
[0m17:41:48.256527 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:41:48.256690 [debug] [MainThread]: On master: Close
[0m17:41:48.257379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:48.257531 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:41:48.257658 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:41:48.257773 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:41:48.257954 [info ] [MainThread]: 
[0m17:41:48.258144 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m17:41:48.258718 [debug] [MainThread]: Command end result
[0m17:41:48.295936 [info ] [MainThread]: 
[0m17:41:48.296232 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:41:48.296421 [info ] [MainThread]: 
[0m17:41:48.296643 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Binder Error: Referenced column "NAME" not found in FROM clause!
  Candidate bindings: "raw_customers.CUSTOMERID"
  LINE 7:     "NAME" as customer_name,
              ^
[0m17:41:48.296872 [info ] [MainThread]: 
[0m17:41:48.297245 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      CAST("ORDERDATE" as TIMESTAMP) as order_date
  FROM "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:41:48.297531 [info ] [MainThread]: 
[0m17:41:48.297720 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:41:48.298206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38861915, "process_user_time": 0.753761, "process_kernel_time": 0.050183, "process_mem_max_rss": "251648", "process_out_blocks": "2360", "command_success": false, "process_in_blocks": "0"}
[0m17:41:48.298463 [debug] [MainThread]: Command `dbt run` failed at 17:41:48.298420 after 0.39 seconds
[0m17:41:48.298663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbea150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbe9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80312810>]}
[0m17:41:48.298858 [debug] [MainThread]: Flushing usage events
[0m17:42:50.183905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1099e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f38690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4397250>]}


============================== 17:42:50.185067 | 067bb5c0-bf00-47b1-b947-f05e43db1259 ==============================
[0m17:42:50.185067 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:42:50.185399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:42:50.258168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f4ae90>]}
[0m17:42:50.275357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3343250>]}
[0m17:42:50.275757 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:42:50.299777 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:42:50.343519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:50.343948 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_customers.sql
[0m17:42:50.414089 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:42:50.414452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa122b710>]}
[0m17:42:50.471467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981ab690>]}
[0m17:42:50.511720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9689be90>]}
[0m17:42:50.512051 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:42:50.512235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969982d0>]}
[0m17:42:50.513022 [info ] [MainThread]: 
[0m17:42:50.513301 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:42:50.515276 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:42:50.553211 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:42:50.553534 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:42:50.553737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:50.557805 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:42:50.558502 [debug] [ThreadPool]: On list_thrive: Close
[0m17:42:50.559438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:42:50.559883 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:42:50.562614 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:42:50.562813 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:42:50.562987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:50.565877 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:42:50.566434 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:42:50.566607 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:42:50.567059 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:50.567321 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:42:50.567505 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:42:50.567833 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:50.568239 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:42:50.568428 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:42:50.568597 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:42:50.568954 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:50.569207 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:42:50.570303 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:42:50.572358 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:42:50.572543 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:42:50.572720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:50.575863 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:42:50.576125 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:42:50.576317 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:42:50.584451 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:42:50.585051 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:42:50.585391 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:42:50.585565 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:42:50.586753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa100fe50>]}
[0m17:42:50.587012 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:50.587186 [debug] [MainThread]: On master: BEGIN
[0m17:42:50.587349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:42:50.590283 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:42:50.590489 [debug] [MainThread]: On master: COMMIT
[0m17:42:50.590661 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:50.590840 [debug] [MainThread]: On master: COMMIT
[0m17:42:50.591113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:42:50.591300 [debug] [MainThread]: On master: Close
[0m17:42:50.592019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:50.592258 [info ] [MainThread]: 
[0m17:42:50.593534 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:42:50.593818 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:42:50.594113 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:42:50.594309 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:42:50.597170 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:42:50.597671 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:42:50.608405 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:42:50.608969 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:42:50.609248 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:42:50.609505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:42:50.613012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:42:50.613356 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:42:50.613550 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID" as customer_id,
    "EMAIL" as email,
    "FIRSTNAME" as first_name,
    "BILLINGPOSTCODE" as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:42:50.613882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:50.616242 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:42:50.616420 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:42:50.616684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:50.622225 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:42:50.622446 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:42:50.622638 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:42:50.623373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:42:50.625748 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:42:50.625941 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:42:50.626299 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:50.627326 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:42:50.629302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986a28d0>]}
[0m17:42:50.629593 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.03s]
[0m17:42:50.629889 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:42:50.630105 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:42:50.630342 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:42:50.630584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:42:50.630782 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:42:50.631732 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:42:50.632154 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:42:50.633503 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:42:50.633875 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:42:50.634047 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:42:50.634197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:50.637463 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:42:50.637684 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:42:50.637871 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID" as order_id,  -- Check if it's ORDERID or ORDER_ID
    "CUSTOMERID" as customer_id,
    CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    CAST("ORDERDATE" as TIMESTAMP) as order_date
FROM "thrive"."main"."raw_sales"
  );

[0m17:42:50.638283 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID" as order_id,  -- Check if it's ORDERID or ORDER_ID
    "CUSTOMERID" as customer_id,
    CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
    CAST("ORDERDATE" as TIMESTAMP) as order_date
FROM "thrive"."main"."raw_sales"
  );

[0m17:42:50.638455 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:42:50.638670 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: ROLLBACK
[0m17:42:50.639982 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_sales'
[0m17:42:50.640160 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:42:50.641499 [debug] [Thread-1 (]: Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      CAST("ORDERDATE" as TIMESTAMP) as order_date
  FROM "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:42:50.641717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e8e910>]}
[0m17:42:50.641978 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_sales ............................ [[31mERROR[0m in 0.01s]
[0m17:42:50.642241 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:42:50.642460 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:42:50.642970 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:42:50.643196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:42:50.643393 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:42:50.644522 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:42:50.644926 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:42:50.646250 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:42:50.646604 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:42:50.646764 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:42:50.646927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:50.649838 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:42:50.650174 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:42:50.650359 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID" as transaction_id,
    "CUSTOMERID" as customer_id,
    lower(trim("TCTYPE")) as type,
    cast("AMOUNT" as DECIMAL(10,2)) as amount,
    cast("CREATEDAT" as TIMESTAMP) as created_at
from "thrive"."main"."raw_tc_data"
  );

[0m17:42:50.650678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:50.651920 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:42:50.652093 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:42:50.652354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:50.653364 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:42:50.653521 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:42:50.653768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:50.655058 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:42:50.655217 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:42:50.655358 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:42:50.655896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:50.657095 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:42:50.657300 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:42:50.657719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:50.658239 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:42:50.659980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067bb5c0-bf00-47b1-b947-f05e43db1259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95eb3d10>]}
[0m17:42:50.660255 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m17:42:50.660501 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:42:50.661131 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:50.661330 [debug] [MainThread]: On master: BEGIN
[0m17:42:50.661486 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:42:50.664513 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:42:50.664717 [debug] [MainThread]: On master: COMMIT
[0m17:42:50.664871 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:50.665018 [debug] [MainThread]: On master: COMMIT
[0m17:42:50.665235 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:42:50.665407 [debug] [MainThread]: On master: Close
[0m17:42:50.666265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:50.666418 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:42:50.666543 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:42:50.666663 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:42:50.666843 [info ] [MainThread]: 
[0m17:42:50.667050 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m17:42:50.667439 [debug] [MainThread]: Command end result
[0m17:42:50.681650 [info ] [MainThread]: 
[0m17:42:50.681939 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:42:50.682118 [info ] [MainThread]: 
[0m17:42:50.682387 [error] [MainThread]:   Runtime Error in model stg_sales (models/staging/stg_sales.sql)
  Binder Error: Referenced column "TOTALAMOUNT" not found in FROM clause!
  Candidate bindings: "raw_sales.CUSTOMERID"
  LINE 8:     CAST("TOTALAMOUNT" as DECIMAL(10,2)) as total_amount,
      CAST("ORDERDATE" as TIMESTAMP) as order_date
  FROM "thrive"."main"."raw_sales"
    );
  ...
                   ^
[0m17:42:50.682636 [info ] [MainThread]: 
[0m17:42:50.682914 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:42:50.683332 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.51570636, "process_user_time": 0.858637, "process_kernel_time": 0.073139, "process_mem_max_rss": "251648", "process_out_blocks": "3746", "command_success": false, "process_in_blocks": "0"}
[0m17:42:50.683545 [debug] [MainThread]: Command `dbt run` failed at 17:42:50.683514 after 0.52 seconds
[0m17:42:50.683753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f3acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f38690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1099e90>]}
[0m17:42:50.683946 [debug] [MainThread]: Flushing usage events
[0m17:50:30.374065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91df9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b8c5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92002a10>]}


============================== 17:50:30.375955 | f4a53759-c024-45b1-b8ed-cf1373aee8d3 ==============================
[0m17:50:30.375955 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:50:30.376283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:50:30.448199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e2e6d0>]}
[0m17:50:30.465696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942031d0>]}
[0m17:50:30.466091 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:50:30.490415 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:50:30.534442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:50:30.534789 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_sales.sql
[0m17:50:30.535014 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_tc_data.sql
[0m17:50:30.535225 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_customers.sql
[0m17:50:30.607907 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:50:30.608282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e855d0>]}
[0m17:50:30.673699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893ec9d0>]}
[0m17:50:30.714626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83718150>]}
[0m17:50:30.714918 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:50:30.715102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8920dd90>]}
[0m17:50:30.715907 [info ] [MainThread]: 
[0m17:50:30.716185 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:50:30.718158 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:50:30.753472 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:50:30.753788 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:50:30.753982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:30.758201 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:50:30.758789 [debug] [ThreadPool]: On list_thrive: Close
[0m17:50:30.759941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:50:30.760202 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:50:30.762734 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:50:30.762922 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:50:30.763093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:30.765917 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:50:30.766455 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:50:30.766645 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:50:30.766934 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:30.767121 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:50:30.767289 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:50:30.767579 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:30.767963 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:50:30.768149 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:50:30.768314 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:50:30.768558 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:30.768759 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:50:30.769828 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:50:30.771824 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:50:30.771996 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:50:30.772156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:30.775075 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:50:30.775272 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:50:30.775481 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:50:30.783421 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:50:30.783999 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:50:30.784339 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:50:30.784527 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:50:30.785916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8931f910>]}
[0m17:50:30.786165 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:30.786343 [debug] [MainThread]: On master: BEGIN
[0m17:50:30.786526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:30.789469 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:50:30.789696 [debug] [MainThread]: On master: COMMIT
[0m17:50:30.789875 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:30.790042 [debug] [MainThread]: On master: COMMIT
[0m17:50:30.790477 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:50:30.790771 [debug] [MainThread]: On master: Close
[0m17:50:30.791518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:30.791742 [info ] [MainThread]: 
[0m17:50:30.792986 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:50:30.793287 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:50:30.793582 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:50:30.793781 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:50:30.796572 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:50:30.797097 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:50:30.807745 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:50:30.808284 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:50:30.808628 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:50:30.808927 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:30.812062 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:50:30.812267 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:50:30.812450 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:50:30.812786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:30.815224 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:50:30.815409 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:50:30.815674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:30.817337 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:50:30.817532 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:50:30.817811 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:30.823668 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:50:30.823865 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:50:30.824059 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:50:30.824782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:50:30.826498 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:50:30.826694 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:50:30.827085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:30.828062 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:50:30.830152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d702d0>]}
[0m17:50:30.830444 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:50:30.830716 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:50:30.830948 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:50:30.831194 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:50:30.831420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:50:30.831619 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:50:30.832623 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:50:30.832982 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:50:30.834363 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:50:30.834751 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:50:30.834928 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:50:30.835133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:30.838318 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:50:30.838549 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:50:30.838722 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:50:30.839044 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:30.840145 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:50:30.840303 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:50:30.840559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:30.841108 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:50:30.841283 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:50:30.841438 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:50:30.841962 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:30.842885 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:50:30.843054 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:50:30.843329 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:30.843867 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:50:30.845338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91eaa710>]}
[0m17:50:30.845639 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.01s]
[0m17:50:30.845898 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:50:30.846102 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:50:30.846439 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:50:30.846823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:50:30.847042 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:50:30.848252 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:50:30.848696 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:50:30.849943 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:50:30.850329 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:50:30.850529 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:50:30.850684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:30.853330 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:50:30.853521 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:50:30.853687 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT":timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:50:30.854540 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT":timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:50:30.854729 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:50:30.855044 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m17:50:30.856356 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m17:50:30.856534 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:50:30.858129 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ":"
[0m17:50:30.858344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4a53759-c024-45b1-b8ed-cf1373aee8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82dacd10>]}
[0m17:50:30.858636 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.01s]
[0m17:50:30.858917 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:50:30.859881 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:30.860070 [debug] [MainThread]: On master: BEGIN
[0m17:50:30.860248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:30.863281 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:50:30.863483 [debug] [MainThread]: On master: COMMIT
[0m17:50:30.863651 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:30.863790 [debug] [MainThread]: On master: COMMIT
[0m17:50:30.864047 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:50:30.864214 [debug] [MainThread]: On master: Close
[0m17:50:30.864902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:30.865085 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:50:30.865251 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:50:30.865400 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:50:30.865622 [info ] [MainThread]: 
[0m17:50:30.865847 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m17:50:30.866236 [debug] [MainThread]: Command end result
[0m17:50:30.880377 [info ] [MainThread]: 
[0m17:50:30.880611 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:30.880776 [info ] [MainThread]: 
[0m17:50:30.880991 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ":"
[0m17:50:30.881220 [info ] [MainThread]: 
[0m17:50:30.881568 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:50:30.881999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.52778536, "process_user_time": 0.92065, "process_kernel_time": 0.064465, "process_mem_max_rss": "251596", "process_out_blocks": "3746", "command_success": false, "process_in_blocks": "0"}
[0m17:50:30.882234 [debug] [MainThread]: Command `dbt run` failed at 17:50:30.882197 after 0.53 seconds
[0m17:50:30.882459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e408d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d062d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a49110>]}
[0m17:50:30.882681 [debug] [MainThread]: Flushing usage events
[0m17:51:49.802901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846e52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a64f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846e5a50>]}


============================== 17:51:49.810017 | ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16 ==============================
[0m17:51:49.810017 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:51:49.810348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m17:51:49.877623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8476ac10>]}
[0m17:51:49.894619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c63910>]}
[0m17:51:49.894969 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:51:49.918276 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:51:49.962397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:49.962643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:49.978798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb38590>]}
[0m17:51:50.030146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8476fed0>]}
[0m17:51:50.030465 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:51:50.030650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8464bad0>]}
[0m17:51:50.031471 [info ] [MainThread]: 
[0m17:51:50.031788 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:51:50.033774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:51:50.046572 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:51:50.046809 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:51:50.046987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:50.051141 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:51:50.051707 [debug] [ThreadPool]: On list_thrive: Close
[0m17:51:50.052696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:51:50.053049 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:51:50.055666 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:51:50.055847 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:51:50.056009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:50.058840 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:51:50.059378 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:51:50.059560 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:51:50.059814 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:50.059985 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:51:50.060155 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:51:50.060461 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:50.060827 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:51:50.061000 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:51:50.061161 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:51:50.061394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:50.061586 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:51:50.062675 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:51:50.064692 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:51:50.064867 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:51:50.065031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:50.068113 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:51:50.068338 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:51:50.068525 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:51:50.077793 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:51:50.078455 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:51:50.078825 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:51:50.079015 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:51:50.080273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84647190>]}
[0m17:51:50.080524 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:50.080689 [debug] [MainThread]: On master: BEGIN
[0m17:51:50.080834 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:50.084030 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:51:50.084357 [debug] [MainThread]: On master: COMMIT
[0m17:51:50.084576 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:50.084764 [debug] [MainThread]: On master: COMMIT
[0m17:51:50.085103 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:51:50.085350 [debug] [MainThread]: On master: Close
[0m17:51:50.086065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:50.086288 [info ] [MainThread]: 
[0m17:51:50.087550 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:51:50.087833 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:51:50.088126 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:51:50.088335 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:51:50.091209 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:51:50.091869 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:51:50.102673 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:51:50.103459 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:51:50.103757 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:51:50.103978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:50.107060 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:51:50.107266 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:51:50.107444 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:51:50.107787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:50.110557 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:51:50.110745 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:51:50.110995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:50.116261 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:51:50.116468 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:51:50.116649 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:51:50.117375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:51:50.119186 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:51:50.119385 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:51:50.119684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:50.120635 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:51:50.122458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae0fdd0>]}
[0m17:51:50.122743 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.03s]
[0m17:51:50.123009 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:51:50.123259 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:51:50.123527 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:51:50.123752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:51:50.123930 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:51:50.124950 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:51:50.125355 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:51:50.126625 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:51:50.126982 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:51:50.127161 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:51:50.127339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:50.130365 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:51:50.130590 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:51:50.130761 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:51:50.131110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:50.132216 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:51:50.132389 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:51:50.132668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:50.133281 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:51:50.133468 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:51:50.133639 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:51:50.134146 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:50.134988 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:51:50.135147 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:51:50.135447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:50.135943 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:51:50.137425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845ab710>]}
[0m17:51:50.137689 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.01s]
[0m17:51:50.137959 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:51:50.138165 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:51:50.138406 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:51:50.138618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:51:50.138794 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:51:50.139772 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:51:50.140129 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:51:50.141427 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:51:50.141813 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:51:50.141987 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:51:50.142128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:50.144658 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:51:50.144847 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:51:50.145005 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT":timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:51:50.145481 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT":timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:51:50.145799 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:51:50.146026 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m17:51:50.147482 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m17:51:50.147668 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:51:50.149041 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ":"
[0m17:51:50.149272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3e4ab1-e8ad-47dc-a248-f82cd1a38b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844c3110>]}
[0m17:51:50.149555 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.01s]
[0m17:51:50.149846 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:51:50.150666 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:50.150869 [debug] [MainThread]: On master: BEGIN
[0m17:51:50.151030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:50.153861 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:51:50.154051 [debug] [MainThread]: On master: COMMIT
[0m17:51:50.154224 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:50.154406 [debug] [MainThread]: On master: COMMIT
[0m17:51:50.154685 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:51:50.154861 [debug] [MainThread]: On master: Close
[0m17:51:50.155806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:50.156158 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:51:50.156346 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:51:50.156510 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:51:50.156728 [info ] [MainThread]: 
[0m17:51:50.156932 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:51:50.157350 [debug] [MainThread]: Command end result
[0m17:51:50.193644 [info ] [MainThread]: 
[0m17:51:50.193887 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:51:50.194069 [info ] [MainThread]: 
[0m17:51:50.194293 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ":"
[0m17:51:50.194544 [info ] [MainThread]: 
[0m17:51:50.194807 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:51:50.195324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.40883687, "process_user_time": 0.833928, "process_kernel_time": 0.066914, "process_mem_max_rss": "251580", "process_out_blocks": "8138", "command_success": false, "process_in_blocks": "0"}
[0m17:51:50.195549 [debug] [MainThread]: Command `dbt run` failed at 17:51:50.195514 after 0.41 seconds
[0m17:51:50.195762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892f9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892f91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b764c50>]}
[0m17:51:50.195955 [debug] [MainThread]: Flushing usage events
[0m17:52:51.937149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee6cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee38690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee6d910>]}


============================== 17:52:51.938327 | a06b217a-e7ad-4ac9-8792-9f4a8455bbbf ==============================
[0m17:52:51.938327 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:52:51.938803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:52.005614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a06b217a-e7ad-4ac9-8792-9f4a8455bbbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeed27d0>]}
[0m17:52:52.022542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a06b217a-e7ad-4ac9-8792-9f4a8455bbbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1243250>]}
[0m17:52:52.022891 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:52:52.046647 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:52:52.089886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:52:52.090149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:52:52.106069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a06b217a-e7ad-4ac9-8792-9f4a8455bbbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6264b10>]}
[0m17:52:52.146647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a06b217a-e7ad-4ac9-8792-9f4a8455bbbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa600c6d0>]}
[0m17:52:52.146947 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:52:52.147134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06b217a-e7ad-4ac9-8792-9f4a8455bbbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6388d50>]}
[0m17:52:52.147942 [info ] [MainThread]: 
[0m17:52:52.148245 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:52:52.150178 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:52:52.163041 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:52:52.163262 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:52:52.163474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:52.167414 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:52:52.167982 [debug] [ThreadPool]: On list_thrive: Close
[0m17:52:52.168904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:52:52.169149 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:52:52.171591 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:52:52.171774 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:52:52.171939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:52.174751 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:52:52.175303 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:52:52.175485 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:52:52.175753 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:52.175942 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:52:52.176115 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:52:52.176430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:52.176770 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:52:52.176976 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:52:52.177147 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:52:52.177428 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:52.177612 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:52:52.178677 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:52:52.180684 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:52:52.180865 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:52:52.181028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:52.183971 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:52:52.184152 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:52:52.184340 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:52:52.192326 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:52:52.192883 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:52:52.193227 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:52:52.193413 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:52:52.194587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06b217a-e7ad-4ac9-8792-9f4a8455bbbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeeeb010>]}
[0m17:52:52.194827 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:52.194998 [debug] [MainThread]: On master: BEGIN
[0m17:52:52.195179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:52.198033 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:52:52.198256 [debug] [MainThread]: On master: COMMIT
[0m17:52:52.198447 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:52.198630 [debug] [MainThread]: On master: COMMIT
[0m17:52:52.199023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:52.199324 [debug] [MainThread]: On master: Close
[0m17:52:52.200188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:52.200450 [info ] [MainThread]: 
[0m17:52:52.201767 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:52:52.202039 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:52:52.202336 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:52:52.202546 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:52:52.205358 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:52:52.205849 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:52:52.216779 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:52:52.217578 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:52:52.217819 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:52:52.218001 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:52:52.221022 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:52:52.221342 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:52:52.221584 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:52:52.221955 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:52.224255 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:52:52.224439 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:52:52.224713 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:52.225759 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:52:52.225950 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:52:52.226257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:52.232188 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:52:52.232419 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:52:52.232612 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:52:52.233321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:52:52.235092 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:52:52.235289 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:52:52.235714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:52.236632 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:52:52.238662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06b217a-e7ad-4ac9-8792-9f4a8455bbbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa602a510>]}
[0m17:52:52.238940 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:52:52.239216 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:52:52.239457 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:52:52.239725 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:52:52.239949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:52:52.240124 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:52:52.241183 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:52:52.241622 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:52:52.242926 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:52:52.243293 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:52:52.243463 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:52:52.243621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.246896 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:52:52.247093 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:52:52.247291 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:52:52.247647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:52.248747 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:52:52.248908 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:52:52.249158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:52.250188 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:52:52.250364 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:52:52.250601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:52.251234 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:52:52.251414 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:52:52.251584 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:52:52.252123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:52.252965 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:52:52.253118 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:52:52.253498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:52.253980 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:52:52.255538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06b217a-e7ad-4ac9-8792-9f4a8455bbbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62ba490>]}
[0m17:52:52.255802 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:52:52.256052 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:52:52.256259 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:52:52.256522 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:52:52.256759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:52:52.256936 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:52:52.257958 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:52:52.258390 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:52:52.259731 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:52:52.260124 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:52:52.260303 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:52:52.260456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.263536 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:52:52.263794 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:52:52.263988 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT":timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:52:52.264353 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT":timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:52:52.264544 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:52:52.264771 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m17:52:52.266413 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m17:52:52.266667 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:52:52.268444 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ":"
[0m17:52:52.268787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06b217a-e7ad-4ac9-8792-9f4a8455bbbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa602e990>]}
[0m17:52:52.269108 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.01s]
[0m17:52:52.269400 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:52:52.270325 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:52.270524 [debug] [MainThread]: On master: BEGIN
[0m17:52:52.270705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:52.274259 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:52:52.274538 [debug] [MainThread]: On master: COMMIT
[0m17:52:52.274761 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:52.274953 [debug] [MainThread]: On master: COMMIT
[0m17:52:52.275233 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:52.275451 [debug] [MainThread]: On master: Close
[0m17:52:52.276375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:52.276655 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:52:52.276832 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:52:52.277003 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:52:52.277252 [info ] [MainThread]: 
[0m17:52:52.277467 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:52:52.277863 [debug] [MainThread]: Command end result
[0m17:52:52.324615 [info ] [MainThread]: 
[0m17:52:52.324908 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:52:52.325110 [info ] [MainThread]: 
[0m17:52:52.325356 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ":"
[0m17:52:52.325551 [info ] [MainThread]: 
[0m17:52:52.325770 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:52:52.326221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4054221, "process_user_time": 0.780353, "process_kernel_time": 0.06803, "process_mem_max_rss": "251856", "process_out_blocks": "2884", "command_success": false, "process_in_blocks": "0"}
[0m17:52:52.326469 [debug] [MainThread]: Command `dbt run` failed at 17:52:52.326434 after 0.41 seconds
[0m17:52:52.326665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a89110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65b5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0414850>]}
[0m17:52:52.326843 [debug] [MainThread]: Flushing usage events
[0m17:53:14.505033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812c2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812fd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812c1950>]}


============================== 17:53:14.506184 | 76270a23-23a6-4333-b1e3-fab369330672 ==============================
[0m17:53:14.506184 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:53:14.506493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:53:14.573358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81354650>]}
[0m17:53:14.590352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836d3490>]}
[0m17:53:14.590700 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:53:14.614156 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:53:14.657504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:14.657838 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_tc_data.sql
[0m17:53:14.727840 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:53:14.728153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff788cbf90>]}
[0m17:53:14.789671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7863f1d0>]}
[0m17:53:14.829716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76a2ff90>]}
[0m17:53:14.830030 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:53:14.830233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78a46f50>]}
[0m17:53:14.831064 [info ] [MainThread]: 
[0m17:53:14.831345 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:53:14.833276 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:53:14.869627 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:53:14.869948 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:53:14.870155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:14.874404 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:53:14.875020 [debug] [ThreadPool]: On list_thrive: Close
[0m17:53:14.875985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:53:14.876248 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:53:14.878749 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:53:14.878952 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:53:14.879121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:14.882014 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:53:14.882562 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:53:14.882735 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:53:14.883002 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:14.883199 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:53:14.883363 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:53:14.883649 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:14.884030 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:53:14.884207 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:53:14.884380 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:53:14.884847 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:14.885140 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:53:14.886240 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:53:14.888402 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:53:14.888581 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:53:14.888743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:14.891748 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:53:14.891941 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:53:14.892124 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:53:14.900216 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:53:14.900825 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:53:14.901211 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:53:14.901387 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:53:14.902689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff785db110>]}
[0m17:53:14.903003 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:14.903183 [debug] [MainThread]: On master: BEGIN
[0m17:53:14.903349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:14.906344 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:53:14.906545 [debug] [MainThread]: On master: COMMIT
[0m17:53:14.906729 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:14.906929 [debug] [MainThread]: On master: COMMIT
[0m17:53:14.907383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:14.907701 [debug] [MainThread]: On master: Close
[0m17:53:14.908475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:14.908718 [info ] [MainThread]: 
[0m17:53:14.909972 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:53:14.910251 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:53:14.910535 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:53:14.910741 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:53:14.913540 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:53:14.914031 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:53:14.924777 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:53:14.925331 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:14.925691 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:53:14.925890 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:53:14.929148 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:53:14.929342 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:14.929499 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:53:14.929847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:14.932255 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:14.932424 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:53:14.932679 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:14.933721 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:14.933943 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:53:14.934255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:14.940869 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:53:14.941088 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:14.941305 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:53:14.942022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:53:14.943767 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:14.943958 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:53:14.944393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:14.945348 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:53:14.949090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75f58190>]}
[0m17:53:14.949483 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:53:14.949801 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:53:14.950036 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:53:14.950297 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:53:14.950552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:53:14.950745 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:53:14.951869 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:53:14.952305 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:53:14.953614 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:53:14.953986 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:14.954172 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:53:14.954335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:14.957683 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:53:14.958033 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:14.958218 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:53:14.958563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:14.959781 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:14.959958 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:53:14.960220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:14.961285 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:14.961466 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:53:14.961697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:14.962296 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:53:14.962470 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:14.962634 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:53:14.963177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:14.964027 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:14.964180 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:53:14.964495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:14.964980 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:53:14.966619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78530990>]}
[0m17:53:14.966959 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:53:14.967231 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:53:14.967441 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:53:14.967684 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:53:14.967913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:53:14.968086 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:53:14.969191 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:53:14.969564 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:53:14.970837 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:53:14.971222 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:53:14.971421 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:53:14.971594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:14.974723 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:53:14.974906 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:53:14.975093 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:53:14.975394 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:53:14.975567 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:53:14.975787 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m17:53:14.977091 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m17:53:14.977257 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:53:14.978748 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""EXPIREDAT""
[0m17:53:14.978996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76270a23-23a6-4333-b1e3-fab369330672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7874a090>]}
[0m17:53:14.979421 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.01s]
[0m17:53:14.979715 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:53:14.980661 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:14.980865 [debug] [MainThread]: On master: BEGIN
[0m17:53:14.981040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:14.984140 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:53:14.984307 [debug] [MainThread]: On master: COMMIT
[0m17:53:14.984474 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:14.984662 [debug] [MainThread]: On master: COMMIT
[0m17:53:14.985131 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:14.985478 [debug] [MainThread]: On master: Close
[0m17:53:14.986227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:14.986413 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:53:14.986574 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:53:14.986734 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:53:14.986957 [info ] [MainThread]: 
[0m17:53:14.987181 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m17:53:14.987585 [debug] [MainThread]: Command end result
[0m17:53:15.002170 [info ] [MainThread]: 
[0m17:53:15.002526 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:53:15.002750 [info ] [MainThread]: 
[0m17:53:15.002982 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""EXPIREDAT""
[0m17:53:15.003169 [info ] [MainThread]: 
[0m17:53:15.003345 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:53:15.003792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5150884, "process_user_time": 0.87349, "process_kernel_time": 0.061884, "process_mem_max_rss": "251716", "process_out_blocks": "3748", "command_success": false, "process_in_blocks": "0"}
[0m17:53:15.004033 [debug] [MainThread]: Command `dbt run` failed at 17:53:15.003996 after 0.52 seconds
[0m17:53:15.004236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78513d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f19110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812c0f90>]}
[0m17:53:15.004420 [debug] [MainThread]: Flushing usage events
[0m17:53:22.109353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2d17d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2d1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8b72d0>]}


============================== 17:53:22.110607 | b4739824-a6fb-4ade-b7eb-1142ffe7c4b1 ==============================
[0m17:53:22.110607 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:53:22.111013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:53:22.180212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4739824-a6fb-4ade-b7eb-1142ffe7c4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b64fb90>]}
[0m17:53:22.197377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4739824-a6fb-4ade-b7eb-1142ffe7c4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6dfa50>]}
[0m17:53:22.197751 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:53:22.221442 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:53:22.264817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:22.265072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:22.281045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4739824-a6fb-4ade-b7eb-1142ffe7c4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8279f950>]}
[0m17:53:22.321711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4739824-a6fb-4ade-b7eb-1142ffe7c4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824b3ed0>]}
[0m17:53:22.322025 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:53:22.322245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4739824-a6fb-4ade-b7eb-1142ffe7c4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8263b150>]}
[0m17:53:22.323057 [info ] [MainThread]: 
[0m17:53:22.323379 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:53:22.325388 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:53:22.338114 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:53:22.338344 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:53:22.338525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:22.342568 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:53:22.343128 [debug] [ThreadPool]: On list_thrive: Close
[0m17:53:22.344110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:53:22.344374 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:53:22.346847 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:53:22.347035 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:53:22.347205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:22.349886 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:53:22.350463 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:53:22.350641 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:53:22.351135 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:22.351410 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:53:22.351590 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:53:22.351947 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:22.352366 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:53:22.352564 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:53:22.352734 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:53:22.353016 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:22.353202 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:53:22.354287 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:53:22.356345 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:53:22.356531 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:53:22.356693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:22.359729 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:53:22.359915 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:53:22.360087 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:53:22.368045 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:53:22.368580 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:53:22.368928 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:53:22.369107 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:53:22.370456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4739824-a6fb-4ade-b7eb-1142ffe7c4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a48050>]}
[0m17:53:22.370697 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:22.370879 [debug] [MainThread]: On master: BEGIN
[0m17:53:22.371068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:22.373903 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:53:22.374086 [debug] [MainThread]: On master: COMMIT
[0m17:53:22.374248 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:22.374406 [debug] [MainThread]: On master: COMMIT
[0m17:53:22.374832 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:22.375128 [debug] [MainThread]: On master: Close
[0m17:53:22.375924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:22.376135 [info ] [MainThread]: 
[0m17:53:22.377327 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:53:22.377603 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:53:22.377900 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:53:22.378102 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:53:22.380891 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:53:22.381349 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:53:22.392453 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:53:22.393043 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:22.393322 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:53:22.393517 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:53:22.396446 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:53:22.396645 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:22.396823 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:53:22.397137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.399504 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:22.399674 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:53:22.399951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.401018 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:22.401191 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:53:22.401467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.407522 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:53:22.407736 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:22.407939 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:53:22.408628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.410335 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:53:22.410518 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:53:22.410952 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.411877 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:53:22.413925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4739824-a6fb-4ade-b7eb-1142ffe7c4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a043d0>]}
[0m17:53:22.414237 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:53:22.414515 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:53:22.414738 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:53:22.414981 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:53:22.415202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:53:22.415379 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:53:22.416395 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:53:22.416778 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:53:22.418144 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:53:22.418528 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:22.418718 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:53:22.418877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:22.422151 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:53:22.422354 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:22.422503 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:53:22.422800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.423909 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:22.424087 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:53:22.424331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.425358 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:22.425515 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:53:22.425745 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.426387 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:53:22.426541 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:22.426680 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:53:22.427196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.428046 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:53:22.428227 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:53:22.428592 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:22.429106 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:53:22.430771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4739824-a6fb-4ade-b7eb-1142ffe7c4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824d0890>]}
[0m17:53:22.431063 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:53:22.431328 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:53:22.431526 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:53:22.431770 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:53:22.431979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:53:22.432150 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:53:22.433147 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:53:22.433492 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:53:22.434826 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:53:22.435176 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:53:22.435342 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:53:22.435500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:22.438038 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:53:22.438211 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:53:22.438433 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:53:22.438964 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:53:22.439257 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:53:22.439523 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m17:53:22.440896 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m17:53:22.441082 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:53:22.442666 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""EXPIREDAT""
[0m17:53:22.442927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4739824-a6fb-4ade-b7eb-1142ffe7c4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a28b90>]}
[0m17:53:22.443250 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.01s]
[0m17:53:22.443567 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:53:22.444566 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:22.444795 [debug] [MainThread]: On master: BEGIN
[0m17:53:22.444962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:22.448367 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:53:22.448675 [debug] [MainThread]: On master: COMMIT
[0m17:53:22.448899 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:22.449081 [debug] [MainThread]: On master: COMMIT
[0m17:53:22.449419 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:22.449864 [debug] [MainThread]: On master: Close
[0m17:53:22.450764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:22.451012 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:53:22.451206 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:53:22.451354 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:53:22.451579 [info ] [MainThread]: 
[0m17:53:22.451874 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:53:22.452342 [debug] [MainThread]: Command end result
[0m17:53:22.491645 [info ] [MainThread]: 
[0m17:53:22.491948 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:53:22.492175 [info ] [MainThread]: 
[0m17:53:22.492592 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""EXPIREDAT""
[0m17:53:22.492822 [info ] [MainThread]: 
[0m17:53:22.493022 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:53:22.493431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.40076545, "process_user_time": 0.773829, "process_kernel_time": 0.064901, "process_mem_max_rss": "251656", "process_out_blocks": "2884", "command_success": false, "process_in_blocks": "0"}
[0m17:53:22.493657 [debug] [MainThread]: Command `dbt run` failed at 17:53:22.493616 after 0.40 seconds
[0m17:53:22.493865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff29110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a2f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a53a90>]}
[0m17:53:22.494046 [debug] [MainThread]: Flushing usage events
[0m17:54:06.032092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f08f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f3ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f3e1d0>]}


============================== 17:54:06.033431 | a93fb377-27e9-46b8-a85f-0679a205976e ==============================
[0m17:54:06.033431 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:54:06.033895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:06.111719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f97a50>]}
[0m17:54:06.130464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43130d0>]}
[0m17:54:06.131031 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:54:06.155907 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:54:06.201505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:06.201993 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_tc_data.sql
[0m17:54:06.282913 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:54:06.283414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996a2410>]}
[0m17:54:06.346031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9950b990>]}
[0m17:54:06.387037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9383bf50>]}
[0m17:54:06.387347 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:54:06.387622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93958bd0>]}
[0m17:54:06.388457 [info ] [MainThread]: 
[0m17:54:06.388769 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:06.390762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:54:06.430563 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:54:06.430846 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:54:06.431002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:06.435371 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:54:06.435952 [debug] [ThreadPool]: On list_thrive: Close
[0m17:54:06.437054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:54:06.437384 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:54:06.440027 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:06.440230 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:54:06.440409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:06.443332 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:06.443893 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:06.444113 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:54:06.444586 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:06.444877 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:06.445094 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:54:06.445390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:06.445760 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:54:06.445935 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:06.446127 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:54:06.446477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:06.446726 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:54:06.447965 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:54:06.450165 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:54:06.450349 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:54:06.450510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:06.453458 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:06.453638 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:54:06.453810 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:54:06.462104 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:54:06.462699 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:54:06.463071 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:54:06.463259 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:54:06.464582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99444750>]}
[0m17:54:06.464833 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:06.465014 [debug] [MainThread]: On master: BEGIN
[0m17:54:06.465196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:06.468471 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:54:06.468825 [debug] [MainThread]: On master: COMMIT
[0m17:54:06.469010 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:06.469228 [debug] [MainThread]: On master: COMMIT
[0m17:54:06.469519 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:06.469756 [debug] [MainThread]: On master: Close
[0m17:54:06.470493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:06.470713 [info ] [MainThread]: 
[0m17:54:06.471985 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:54:06.472298 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:54:06.472601 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:54:06.472786 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:54:06.475573 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:54:06.476064 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:54:06.486650 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:54:06.487385 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:06.487591 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:54:06.487780 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:06.490723 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:06.490926 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:06.491122 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:54:06.491445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:06.493804 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:06.493971 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:54:06.494294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:06.495395 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:06.495589 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:54:06.495845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:06.502414 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:54:06.502612 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:06.502784 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:54:06.503494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:06.505339 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:06.505509 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:54:06.505854 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:06.506815 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:54:06.508877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990f1890>]}
[0m17:54:06.509155 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:54:06.509458 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:54:06.509696 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:54:06.509944 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:54:06.510178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:54:06.510352 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:54:06.511314 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:54:06.511694 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:54:06.513024 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:54:06.513422 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:06.513597 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:54:06.513744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:06.516842 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:06.517050 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:06.517238 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:54:06.517578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:06.518752 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:06.518917 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:54:06.519168 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:06.520168 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:06.520333 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:54:06.520567 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:06.521166 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:54:06.521343 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:06.521500 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:54:06.522034 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:06.522931 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:06.523095 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:54:06.523478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:06.523967 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:54:06.525603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990f1890>]}
[0m17:54:06.525855 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:54:06.526141 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:54:06.526363 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:54:06.526615 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:54:06.526837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:54:06.527017 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:54:06.528029 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:54:06.528408 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:54:06.529683 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:54:06.530023 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:06.530187 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:54:06.530353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:06.533054 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:06.533401 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:06.533595 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:54:06.533897 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:54:06.534118 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:54:06.534358 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m17:54:06.535625 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m17:54:06.535790 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:54:06.537391 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""CUSTOMERID""
[0m17:54:06.537611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a93fb377-27e9-46b8-a85f-0679a205976e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990d3f90>]}
[0m17:54:06.537874 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.01s]
[0m17:54:06.538154 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:54:06.539003 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:06.539203 [debug] [MainThread]: On master: BEGIN
[0m17:54:06.539369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:06.542295 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:54:06.542491 [debug] [MainThread]: On master: COMMIT
[0m17:54:06.542631 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:06.542767 [debug] [MainThread]: On master: COMMIT
[0m17:54:06.543166 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:06.543455 [debug] [MainThread]: On master: Close
[0m17:54:06.544141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:06.544320 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:54:06.544476 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:54:06.544625 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:54:06.544827 [info ] [MainThread]: 
[0m17:54:06.545041 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m17:54:06.545438 [debug] [MainThread]: Command end result
[0m17:54:06.559708 [info ] [MainThread]: 
[0m17:54:06.559932 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:06.560102 [info ] [MainThread]: 
[0m17:54:06.560280 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""CUSTOMERID""
[0m17:54:06.560436 [info ] [MainThread]: 
[0m17:54:06.560597 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:54:06.561359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5457655, "process_user_time": 0.88107, "process_kernel_time": 0.067698, "process_mem_max_rss": "251612", "process_out_blocks": "3748", "command_success": false, "process_in_blocks": "0"}
[0m17:54:06.561596 [debug] [MainThread]: Command `dbt run` failed at 17:54:06.561562 after 0.55 seconds
[0m17:54:06.561793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f52e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa355bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6ca9ed0>]}
[0m17:54:06.561967 [debug] [MainThread]: Flushing usage events
[0m17:54:16.084554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d66fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2f8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2f8c90>]}


============================== 17:54:16.085766 | 2e470176-93e7-461e-90ec-a1f10f846ad3 ==============================
[0m17:54:16.085766 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:54:16.086068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:16.153306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e470176-93e7-461e-90ec-a1f10f846ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ac1690>]}
[0m17:54:16.170407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e470176-93e7-461e-90ec-a1f10f846ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6ffc50>]}
[0m17:54:16.170778 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:54:16.194806 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:54:16.245763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:16.246265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:16.263175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e470176-93e7-461e-90ec-a1f10f846ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946db550>]}
[0m17:54:16.304424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e470176-93e7-461e-90ec-a1f10f846ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944d3d10>]}
[0m17:54:16.304740 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:54:16.304982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e470176-93e7-461e-90ec-a1f10f846ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9486d3d0>]}
[0m17:54:16.305802 [info ] [MainThread]: 
[0m17:54:16.306119 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:16.308092 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:54:16.320731 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:54:16.320959 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:54:16.321139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:16.325166 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:54:16.325754 [debug] [ThreadPool]: On list_thrive: Close
[0m17:54:16.326851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:54:16.327173 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:54:16.329813 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:16.330004 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:54:16.330222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:16.333138 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:16.333715 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:16.333891 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:54:16.334255 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:16.334519 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:16.334735 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:54:16.335035 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:16.335402 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:54:16.335592 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:16.335775 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:54:16.336107 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:16.336343 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:54:16.337472 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:54:16.339565 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:54:16.339742 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:54:16.339904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:16.342947 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:16.343196 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:54:16.343385 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:54:16.351432 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:54:16.352002 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:54:16.352343 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:54:16.352533 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:54:16.353840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e470176-93e7-461e-90ec-a1f10f846ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a2fd90>]}
[0m17:54:16.354114 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:16.354306 [debug] [MainThread]: On master: BEGIN
[0m17:54:16.354508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:16.357547 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:54:16.357752 [debug] [MainThread]: On master: COMMIT
[0m17:54:16.357937 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:16.358107 [debug] [MainThread]: On master: COMMIT
[0m17:54:16.358446 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:16.358691 [debug] [MainThread]: On master: Close
[0m17:54:16.359437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:16.359680 [info ] [MainThread]: 
[0m17:54:16.360912 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:54:16.361187 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:54:16.361513 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:54:16.361722 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:54:16.364552 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:54:16.365059 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:54:16.376496 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:54:16.377173 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:16.377413 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:54:16.377622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:16.380457 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:16.380691 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:16.380899 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:54:16.381223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:16.383709 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:16.383897 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:54:16.384171 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:16.385270 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:16.385434 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:54:16.385672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:16.391702 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:54:16.391916 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:16.392101 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:54:16.392821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:16.394549 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:16.394738 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:54:16.395154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:16.396101 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:54:16.398129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e470176-93e7-461e-90ec-a1f10f846ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a54990>]}
[0m17:54:16.398563 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:54:16.398876 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:54:16.399108 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:54:16.399353 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:54:16.399616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:54:16.399827 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:54:16.400931 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:54:16.401297 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:54:16.402645 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:54:16.403043 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:16.403245 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:54:16.403546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:16.406566 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:16.406786 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:16.406971 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:54:16.407265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:16.408356 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:16.408548 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:54:16.408799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:16.409817 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:16.409986 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:54:16.410216 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:16.410893 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:54:16.411053 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:16.411214 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:54:16.411794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:16.412612 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:16.412792 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:54:16.413212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:16.413737 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:54:16.415364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e470176-93e7-461e-90ec-a1f10f846ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a01350>]}
[0m17:54:16.415679 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:54:16.415961 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:54:16.416169 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:54:16.416418 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:54:16.416682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:54:16.416875 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:54:16.417866 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:54:16.418218 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:54:16.419560 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:54:16.419910 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:16.420053 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:54:16.420191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:16.423005 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:16.423193 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:16.423340 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:54:16.423645 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:54:16.423832 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:54:16.424032 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m17:54:16.425341 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m17:54:16.425534 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:54:16.427123 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""CUSTOMERID""
[0m17:54:16.427406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e470176-93e7-461e-90ec-a1f10f846ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a254d0>]}
[0m17:54:16.427823 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.01s]
[0m17:54:16.428103 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:54:16.428961 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:16.429164 [debug] [MainThread]: On master: BEGIN
[0m17:54:16.429327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:16.432530 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:54:16.432744 [debug] [MainThread]: On master: COMMIT
[0m17:54:16.432897 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:16.433042 [debug] [MainThread]: On master: COMMIT
[0m17:54:16.433294 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:16.433535 [debug] [MainThread]: On master: Close
[0m17:54:16.434239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:16.434439 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:54:16.434598 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:54:16.434731 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:54:16.434921 [info ] [MainThread]: 
[0m17:54:16.435111 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:54:16.435517 [debug] [MainThread]: Command end result
[0m17:54:16.471616 [info ] [MainThread]: 
[0m17:54:16.471900 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:16.472069 [info ] [MainThread]: 
[0m17:54:16.472278 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""CUSTOMERID""
[0m17:54:16.472528 [info ] [MainThread]: 
[0m17:54:16.472859 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:54:16.473337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.40507546, "process_user_time": 0.757752, "process_kernel_time": 0.058443, "process_mem_max_rss": "251612", "process_out_blocks": "2884", "command_success": false, "process_in_blocks": "0"}
[0m17:54:16.473644 [debug] [MainThread]: Command `dbt run` failed at 17:54:16.473599 after 0.41 seconds
[0m17:54:16.473862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2099c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a1d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a1c2d0>]}
[0m17:54:16.474055 [debug] [MainThread]: Flushing usage events
[0m17:54:24.404848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9755cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97528690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97528c90>]}


============================== 17:54:24.406012 | e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2 ==============================
[0m17:54:24.406012 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:54:24.406332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m17:54:24.473388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975cd590>]}
[0m17:54:24.490637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9992f8d0>]}
[0m17:54:24.491015 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:54:24.514654 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:54:24.557587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:24.557852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:24.573734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e950590>]}
[0m17:54:24.614557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e703f90>]}
[0m17:54:24.614840 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:54:24.615017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea39c50>]}
[0m17:54:24.615812 [info ] [MainThread]: 
[0m17:54:24.616145 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:24.618001 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:54:24.630714 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:54:24.630955 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:54:24.631149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:24.635110 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:54:24.635697 [debug] [ThreadPool]: On list_thrive: Close
[0m17:54:24.636854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:54:24.637112 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:54:24.639605 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:24.639836 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:54:24.640062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:24.643085 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:24.643665 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:24.643858 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:54:24.644118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:24.644299 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:24.644467 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:54:24.644744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:24.645116 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:54:24.645295 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:24.645475 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:54:24.645718 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:24.645909 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:54:24.646976 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:54:24.649031 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:54:24.649207 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:54:24.649372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:24.652357 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:24.652560 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:54:24.652782 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:54:24.660737 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:54:24.661327 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:54:24.661687 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:54:24.661858 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:54:24.663137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97732910>]}
[0m17:54:24.663376 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:24.663571 [debug] [MainThread]: On master: BEGIN
[0m17:54:24.663784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:24.666883 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:54:24.667170 [debug] [MainThread]: On master: COMMIT
[0m17:54:24.667344 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:24.667525 [debug] [MainThread]: On master: COMMIT
[0m17:54:24.667843 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:24.668018 [debug] [MainThread]: On master: Close
[0m17:54:24.668693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:24.668915 [info ] [MainThread]: 
[0m17:54:24.670126 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:54:24.670405 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:54:24.670686 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:54:24.670884 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:54:24.673758 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:54:24.674250 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:54:24.692059 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:54:24.692982 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:24.693257 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:54:24.693479 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:24.696825 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:24.697057 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:24.697282 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:54:24.697676 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:24.700482 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:24.700692 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:54:24.700986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:24.702205 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:24.702422 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:54:24.702752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:24.708974 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:54:24.709203 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:24.709416 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:54:24.710284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:24.712231 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:24.712446 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:54:24.712937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:24.713953 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:54:24.716006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc6ed10>]}
[0m17:54:24.716475 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:54:24.716808 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:54:24.717055 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:54:24.717324 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:54:24.717592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:54:24.717785 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:54:24.719014 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:54:24.719443 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:54:24.720830 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:54:24.721180 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:24.721356 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:54:24.721584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:24.725101 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:54:24.725307 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:24.725476 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:54:24.725821 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:24.727051 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:24.727252 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:54:24.727590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:24.728725 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:24.728908 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:54:24.729184 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:24.729908 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:54:24.730069 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:24.730213 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:54:24.730784 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:24.731586 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:24.731754 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:54:24.732404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:24.733047 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:54:24.734950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec4b290>]}
[0m17:54:24.735272 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:54:24.735571 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:54:24.735784 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:54:24.736030 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:54:24.736250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:54:24.736433 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:54:24.737517 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:54:24.737954 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:54:24.739294 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:54:24.739660 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:24.739853 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:54:24.740014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:24.742993 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:24.743210 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:24.743382 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:54:24.743704 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:54:24.743899 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:54:24.744104 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: ROLLBACK
[0m17:54:24.745430 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.stg_tc_data'
[0m17:54:24.745737 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:54:24.747452 [debug] [Thread-1 (]: Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""CUSTOMERID""
[0m17:54:24.747679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ad1f3b-41aa-4cfe-aa6d-0693925b46e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db4bb50>]}
[0m17:54:24.747960 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_tc_data .......................... [[31mERROR[0m in 0.01s]
[0m17:54:24.748256 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:54:24.749194 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:24.749407 [debug] [MainThread]: On master: BEGIN
[0m17:54:24.749572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:24.752711 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:54:24.752926 [debug] [MainThread]: On master: COMMIT
[0m17:54:24.753085 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:24.753236 [debug] [MainThread]: On master: COMMIT
[0m17:54:24.753492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:24.753678 [debug] [MainThread]: On master: Close
[0m17:54:24.754477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:24.754745 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:54:24.754927 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:54:24.755088 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:54:24.755298 [info ] [MainThread]: 
[0m17:54:24.755522 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m17:54:24.755913 [debug] [MainThread]: Command end result
[0m17:54:24.793672 [info ] [MainThread]: 
[0m17:54:24.793939 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:24.794106 [info ] [MainThread]: 
[0m17:54:24.794322 [error] [MainThread]:   Runtime Error in model stg_tc_data (models/staging/stg_tc_data.sql)
  Parser Error: syntax error at or near ""CUSTOMERID""
[0m17:54:24.794546 [info ] [MainThread]: 
[0m17:54:24.794751 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:54:24.795165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.40668175, "process_user_time": 0.760796, "process_kernel_time": 0.065982, "process_mem_max_rss": "251536", "process_out_blocks": "2884", "command_success": false, "process_in_blocks": "0"}
[0m17:54:24.795400 [debug] [MainThread]: Command `dbt run` failed at 17:54:24.795355 after 0.41 seconds
[0m17:54:24.795606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2ca150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2c9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb25090>]}
[0m17:54:24.795794 [debug] [MainThread]: Flushing usage events
[0m17:54:40.377968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6d91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6d8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6d9010>]}


============================== 17:54:40.379197 | 724b03d4-d3c7-4ebf-be04-d70dafe71221 ==============================
[0m17:54:40.379197 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:54:40.379507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:54:40.446870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ded210>]}
[0m17:54:40.463996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cae31d0>]}
[0m17:54:40.464356 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:54:40.489489 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:54:40.533563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:40.533922 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_tc_data.sql
[0m17:54:40.604586 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:54:40.604917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8191b710>]}
[0m17:54:40.667350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ccccd0>]}
[0m17:54:40.707709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf6bf90>]}
[0m17:54:40.708002 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:54:40.708188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8192d790>]}
[0m17:54:40.708964 [info ] [MainThread]: 
[0m17:54:40.709249 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:40.711263 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:54:40.746646 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:54:40.746961 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:54:40.747230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:40.751506 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:54:40.752103 [debug] [ThreadPool]: On list_thrive: Close
[0m17:54:40.753012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:54:40.753284 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:54:40.755799 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:40.755999 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:54:40.756175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:40.759095 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:40.759687 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:40.759870 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:54:40.760325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:40.760624 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:40.760813 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:54:40.761121 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:40.761592 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:54:40.761794 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:54:40.761967 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:54:40.762212 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:40.762385 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:54:40.763543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:54:40.765648 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:54:40.765824 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:54:40.765984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:40.769010 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:54:40.769284 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:54:40.769480 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:54:40.777504 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:54:40.778052 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:54:40.778385 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:54:40.778567 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:54:40.779892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818bb3d0>]}
[0m17:54:40.780137 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:40.780307 [debug] [MainThread]: On master: BEGIN
[0m17:54:40.780486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:40.783574 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:54:40.783888 [debug] [MainThread]: On master: COMMIT
[0m17:54:40.784121 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:40.784290 [debug] [MainThread]: On master: COMMIT
[0m17:54:40.784631 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:40.784864 [debug] [MainThread]: On master: Close
[0m17:54:40.785622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:40.785857 [info ] [MainThread]: 
[0m17:54:40.787109 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:54:40.787387 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:54:40.787706 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:54:40.787892 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:54:40.790643 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:54:40.791129 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:54:40.801738 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:54:40.802318 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:40.802618 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:54:40.802823 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:40.806037 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:40.806343 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:40.806576 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:54:40.806937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.809350 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:40.809530 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:54:40.809817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.810879 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:40.811068 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:54:40.811336 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.817822 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:54:40.818024 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:40.818201 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:54:40.818918 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:40.820676 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:54:40.820864 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:54:40.821285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.822200 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:54:40.824240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a864d0>]}
[0m17:54:40.824537 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:54:40.824857 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:54:40.825090 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:54:40.825338 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:54:40.825570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:54:40.825751 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:54:40.826822 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:54:40.827232 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:54:40.828531 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:54:40.828899 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:40.829074 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:54:40.829224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:40.832542 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:40.832877 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:40.833076 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:54:40.833423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.834582 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:40.834787 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:54:40.835073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.836146 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:40.836314 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:54:40.836548 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.837148 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:54:40.837302 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:40.837447 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:54:40.837988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.838935 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:54:40.839093 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:54:40.839421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.839910 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:54:40.841473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd26b50>]}
[0m17:54:40.841728 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:54:40.842004 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:54:40.842229 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:54:40.842480 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:54:40.842705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:54:40.842881 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:54:40.843932 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:54:40.844331 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:54:40.845634 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:54:40.845982 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:40.846147 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:54:40.846298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:40.849066 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:40.849252 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:40.849429 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:54:40.849831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.850990 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:40.851151 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:54:40.851405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.851952 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:54:40.852111 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:40.852261 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:54:40.852792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.853685 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:54:40.853860 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:54:40.854126 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:40.854670 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:54:40.856286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '724b03d4-d3c7-4ebf-be04-d70dafe71221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b55ba90>]}
[0m17:54:40.856542 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.01s]
[0m17:54:40.856815 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:54:40.857441 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:40.857642 [debug] [MainThread]: On master: BEGIN
[0m17:54:40.857817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:40.860723 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:54:40.860916 [debug] [MainThread]: On master: COMMIT
[0m17:54:40.861087 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:40.861225 [debug] [MainThread]: On master: COMMIT
[0m17:54:40.861612 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:40.861894 [debug] [MainThread]: On master: Close
[0m17:54:40.862677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:40.862909 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:54:40.863063 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:54:40.863182 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:54:40.863357 [info ] [MainThread]: 
[0m17:54:40.863559 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m17:54:40.864114 [debug] [MainThread]: Command end result
[0m17:54:40.879372 [info ] [MainThread]: 
[0m17:54:40.879680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:40.879863 [info ] [MainThread]: 
[0m17:54:40.880065 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:54:40.880498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5192817, "process_user_time": 0.887612, "process_kernel_time": 0.064607, "process_mem_max_rss": "251608", "process_out_blocks": "4272", "process_in_blocks": "0"}
[0m17:54:40.880748 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:40.880709 after 0.52 seconds
[0m17:54:40.880940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6d1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6d1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6d0e10>]}
[0m17:54:40.881108 [debug] [MainThread]: Flushing usage events
[0m17:55:08.339090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fb3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fb8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ffff90>]}


============================== 17:55:08.340285 | 18702b66-abf9-4f06-b69d-16714498e72e ==============================
[0m17:55:08.340285 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:55:08.340609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:55:08.410267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18702b66-abf9-4f06-b69d-16714498e72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82052450>]}
[0m17:55:08.428376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18702b66-abf9-4f06-b69d-16714498e72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843bf690>]}
[0m17:55:08.428805 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:55:08.452813 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:55:08.496467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:08.496732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:08.512599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18702b66-abf9-4f06-b69d-16714498e72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff793e55d0>]}
[0m17:55:08.554437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18702b66-abf9-4f06-b69d-16714498e72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79193fd0>]}
[0m17:55:08.554769 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:55:08.555025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18702b66-abf9-4f06-b69d-16714498e72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff793b4150>]}
[0m17:55:08.555839 [info ] [MainThread]: 
[0m17:55:08.556182 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:55:08.558120 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:55:08.571578 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:55:08.571830 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:55:08.572007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:08.576132 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:55:08.576742 [debug] [ThreadPool]: On list_thrive: Close
[0m17:55:08.577898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:55:08.578251 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:55:08.580906 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:08.581108 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:55:08.581279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:08.584127 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:55:08.584678 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:08.584876 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:55:08.585310 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:08.585689 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:08.585893 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:55:08.586145 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:08.586496 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:55:08.586672 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:08.586855 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:55:08.587228 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:08.587458 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:55:08.588821 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:55:08.590851 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:55:08.591026 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:55:08.591189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:08.593876 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:55:08.594053 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:55:08.594229 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:55:08.602327 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:55:08.602929 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:55:08.603277 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:55:08.603446 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:55:08.604878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18702b66-abf9-4f06-b69d-16714498e72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff791b2c50>]}
[0m17:55:08.605139 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:08.605312 [debug] [MainThread]: On master: BEGIN
[0m17:55:08.605475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:08.608704 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:55:08.609013 [debug] [MainThread]: On master: COMMIT
[0m17:55:08.609207 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:08.609369 [debug] [MainThread]: On master: COMMIT
[0m17:55:08.609722 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:08.609943 [debug] [MainThread]: On master: Close
[0m17:55:08.610652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:08.610883 [info ] [MainThread]: 
[0m17:55:08.612131 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:55:08.612428 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:55:08.612755 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:55:08.612966 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:55:08.615841 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:55:08.616316 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:55:08.627530 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:55:08.628243 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:08.628471 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:55:08.628692 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:08.632189 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:55:08.632385 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:08.632545 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:55:08.632912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.635343 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:08.635550 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:55:08.635849 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.636970 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:08.637157 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:55:08.637421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.643380 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:55:08.643595 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:08.643792 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:55:08.644508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:55:08.646196 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:08.646393 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:55:08.646857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.647779 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:55:08.649861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18702b66-abf9-4f06-b69d-16714498e72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff795f8950>]}
[0m17:55:08.650182 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:55:08.650464 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:55:08.650714 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:55:08.650973 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:55:08.651195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:55:08.651370 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:55:08.652395 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:55:08.652805 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:55:08.654246 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:55:08.654651 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:08.654831 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:55:08.655000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:08.658318 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:55:08.658622 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:08.658831 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:55:08.659227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.660435 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:08.660612 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:55:08.660898 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.661973 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:08.662159 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:55:08.662430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.663154 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:55:08.663322 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:08.663475 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:55:08.664049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.664895 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:08.665065 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:55:08.665496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.666065 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:55:08.667767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18702b66-abf9-4f06-b69d-16714498e72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79193710>]}
[0m17:55:08.668120 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:55:08.668401 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:55:08.668603 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:55:08.668853 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:55:08.669098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:55:08.669306 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:55:08.670421 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:55:08.670861 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:55:08.672200 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:55:08.672585 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:08.672764 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:55:08.672975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:08.676980 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:55:08.677217 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:08.677377 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:55:08.677777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.679778 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:08.679988 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:55:08.680284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.681255 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:08.681411 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:55:08.681762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.703708 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:55:08.704026 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:08.704238 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:55:08.705167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:55:08.706100 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:08.706284 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:55:08.706770 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:08.707302 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:55:08.709116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18702b66-abf9-4f06-b69d-16714498e72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78632650>]}
[0m17:55:08.709398 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.04s]
[0m17:55:08.709662 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:55:08.710327 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:08.710536 [debug] [MainThread]: On master: BEGIN
[0m17:55:08.710707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:08.713893 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:55:08.714067 [debug] [MainThread]: On master: COMMIT
[0m17:55:08.714237 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:08.714390 [debug] [MainThread]: On master: COMMIT
[0m17:55:08.714599 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:08.714769 [debug] [MainThread]: On master: Close
[0m17:55:08.715480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:08.715652 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:55:08.715813 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:55:08.716001 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:55:08.716340 [info ] [MainThread]: 
[0m17:55:08.716572 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m17:55:08.716970 [debug] [MainThread]: Command end result
[0m17:55:08.730465 [info ] [MainThread]: 
[0m17:55:08.730685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:08.730929 [info ] [MainThread]: 
[0m17:55:08.731135 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:55:08.731536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.40949413, "process_user_time": 0.771765, "process_kernel_time": 0.075663, "process_mem_max_rss": "251628", "process_out_blocks": "3409", "process_in_blocks": "0"}
[0m17:55:08.731774 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:08.731738 after 0.41 seconds
[0m17:55:08.732052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d5a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d58e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d58ed0>]}
[0m17:55:08.732250 [debug] [MainThread]: Flushing usage events
[0m17:55:18.290333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4950bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4901890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4950b50>]}


============================== 17:55:18.291509 | e26f1909-7ea1-4b34-a2e4-31ffe46ace04 ==============================
[0m17:55:18.291509 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:55:18.291834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:55:18.359712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e26f1909-7ea1-4b34-a2e4-31ffe46ace04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb498df90>]}
[0m17:55:18.376785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e26f1909-7ea1-4b34-a2e4-31ffe46ace04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d13290>]}
[0m17:55:18.377130 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:55:18.401137 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:55:18.444341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:18.444583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:18.460659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e26f1909-7ea1-4b34-a2e4-31ffe46ace04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabf35e50>]}
[0m17:55:18.508126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e26f1909-7ea1-4b34-a2e4-31ffe46ace04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabae7f50>]}
[0m17:55:18.508489 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:55:18.508729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e26f1909-7ea1-4b34-a2e4-31ffe46ace04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc6efd0>]}
[0m17:55:18.509679 [info ] [MainThread]: 
[0m17:55:18.510014 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:55:18.512007 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:55:18.525879 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:55:18.526136 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:55:18.526333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:18.530642 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:55:18.531270 [debug] [ThreadPool]: On list_thrive: Close
[0m17:55:18.532241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:55:18.532527 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:55:18.535094 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:18.535299 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:55:18.535485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:18.538443 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:55:18.539056 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:18.539247 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:55:18.539638 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:18.539898 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:18.540094 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:55:18.540367 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:18.540754 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:55:18.540939 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:18.541104 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:55:18.541383 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:18.541644 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:55:18.542900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m17:55:18.545091 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:55:18.545388 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:55:18.545646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:18.548954 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:55:18.549177 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:55:18.549343 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:55:18.559677 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:55:18.561152 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:55:18.562815 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:55:18.564603 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:55:18.566084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e26f1909-7ea1-4b34-a2e4-31ffe46ace04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac008810>]}
[0m17:55:18.566399 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:18.566757 [debug] [MainThread]: On master: BEGIN
[0m17:55:18.567086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:18.583073 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m17:55:18.583367 [debug] [MainThread]: On master: COMMIT
[0m17:55:18.583579 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:18.583763 [debug] [MainThread]: On master: COMMIT
[0m17:55:18.584046 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:18.584266 [debug] [MainThread]: On master: Close
[0m17:55:18.587638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:18.587897 [info ] [MainThread]: 
[0m17:55:18.595630 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:55:18.601180 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:55:18.601843 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:55:18.606592 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:55:18.610139 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:55:18.613011 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:55:18.642200 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:55:18.651879 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:18.652141 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:55:18.652346 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:18.658688 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:55:18.659558 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:18.659922 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:55:18.661773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.664750 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:18.665039 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:55:18.665503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.666859 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:18.667102 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:55:18.667458 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.674395 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:55:18.674673 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:18.674879 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:55:18.675639 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:55:18.677790 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:18.678002 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:55:18.678413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.679430 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:55:18.681531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e26f1909-7ea1-4b34-a2e4-31ffe46ace04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb530d790>]}
[0m17:55:18.681949 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.08s]
[0m17:55:18.682273 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:55:18.682525 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:55:18.682790 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:55:18.683065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:55:18.683286 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:55:18.684524 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:55:18.684953 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:55:18.686413 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:55:18.686840 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:18.687036 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:55:18.687200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:18.690762 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:55:18.691004 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:18.691207 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:55:18.691579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.692901 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:18.693094 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:55:18.693369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.694473 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:18.694658 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:55:18.694910 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.695611 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:55:18.695796 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:18.695976 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:55:18.696562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.697434 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:18.697851 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:55:18.698347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.698994 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:55:18.700670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e26f1909-7ea1-4b34-a2e4-31ffe46ace04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf36f50>]}
[0m17:55:18.701044 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:55:18.701353 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:55:18.701622 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:55:18.701909 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:55:18.702171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:55:18.702353 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:55:18.703580 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:55:18.704038 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:55:18.705574 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:55:18.705946 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:18.706109 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:55:18.706269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:18.709288 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:55:18.709501 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:18.709674 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:55:18.710007 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.712245 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:18.712444 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:55:18.712807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.713892 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:18.714075 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:55:18.714347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.739437 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:55:18.739759 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:18.739968 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:55:18.740831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:55:18.741862 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:18.742068 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:55:18.742546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:18.743097 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:55:18.744911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e26f1909-7ea1-4b34-a2e4-31ffe46ace04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf79550>]}
[0m17:55:18.745374 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.04s]
[0m17:55:18.745698 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:55:18.746447 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:18.746659 [debug] [MainThread]: On master: BEGIN
[0m17:55:18.746824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:18.750041 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:55:18.750233 [debug] [MainThread]: On master: COMMIT
[0m17:55:18.750383 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:18.750529 [debug] [MainThread]: On master: COMMIT
[0m17:55:18.750831 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:18.751048 [debug] [MainThread]: On master: Close
[0m17:55:18.751779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:18.752048 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:55:18.752300 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:55:18.752564 [info ] [MainThread]: 
[0m17:55:18.752801 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m17:55:18.753258 [debug] [MainThread]: Command end result
[0m17:55:18.768116 [info ] [MainThread]: 
[0m17:55:18.768556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:18.768834 [info ] [MainThread]: 
[0m17:55:18.769082 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:55:18.769587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49575582, "process_user_time": 0.791848, "process_kernel_time": 0.053124, "process_mem_max_rss": "251540", "process_out_blocks": "3409", "process_in_blocks": "0"}
[0m17:55:18.771781 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:18.771728 after 0.50 seconds
[0m17:55:18.772698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96aa150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96a8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96a8ed0>]}
[0m17:55:18.774204 [debug] [MainThread]: Flushing usage events
[0m17:55:26.288861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae4f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae18690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae111d0>]}


============================== 17:55:26.290049 | 2ce69a39-3edd-495a-94ce-a12e9fbbe356 ==============================
[0m17:55:26.290049 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:55:26.290534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:55:26.360992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ce69a39-3edd-495a-94ce-a12e9fbbe356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaeba7d0>]}
[0m17:55:26.378392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ce69a39-3edd-495a-94ce-a12e9fbbe356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2444390>]}
[0m17:55:26.378745 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:55:26.402493 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:55:26.446200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:26.446440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:26.462623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ce69a39-3edd-495a-94ce-a12e9fbbe356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa22534d0>]}
[0m17:55:26.503811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ce69a39-3edd-495a-94ce-a12e9fbbe356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ff3f90>]}
[0m17:55:26.504131 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:55:26.504444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce69a39-3edd-495a-94ce-a12e9fbbe356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2396650>]}
[0m17:55:26.505250 [info ] [MainThread]: 
[0m17:55:26.505583 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:55:26.507495 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:55:26.520639 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:55:26.520872 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:55:26.521053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:26.525250 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:55:26.525834 [debug] [ThreadPool]: On list_thrive: Close
[0m17:55:26.526752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:55:26.527009 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:55:26.529495 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:26.529705 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:55:26.529914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:26.532685 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:55:26.533226 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:26.533404 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:55:26.533700 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:26.533870 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:26.534032 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:55:26.534301 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:26.534668 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:55:26.534841 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:55:26.535004 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:55:26.535490 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:26.535793 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:55:26.536876 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:55:26.539054 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:55:26.539229 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:55:26.539390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:26.542625 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:55:26.542812 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:55:26.542979 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:55:26.551027 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:55:26.551626 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:55:26.551980 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:55:26.552151 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:55:26.553350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce69a39-3edd-495a-94ce-a12e9fbbe356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa155b010>]}
[0m17:55:26.553608 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:26.553802 [debug] [MainThread]: On master: BEGIN
[0m17:55:26.553990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:26.557120 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:55:26.557314 [debug] [MainThread]: On master: COMMIT
[0m17:55:26.557499 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:26.557670 [debug] [MainThread]: On master: COMMIT
[0m17:55:26.558091 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:26.558394 [debug] [MainThread]: On master: Close
[0m17:55:26.559126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:26.559355 [info ] [MainThread]: 
[0m17:55:26.560569 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m17:55:26.560844 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m17:55:26.561134 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m17:55:26.561324 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m17:55:26.564185 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m17:55:26.564689 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m17:55:26.576464 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m17:55:26.577019 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:26.577243 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m17:55:26.577429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:26.580895 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:55:26.581092 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:26.581251 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m17:55:26.581594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.584061 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:26.584238 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:55:26.584503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.585551 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:26.585723 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:55:26.585970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.591843 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:55:26.592046 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:26.592238 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m17:55:26.592950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:55:26.594627 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m17:55:26.594814 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m17:55:26.595172 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.596128 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m17:55:26.599735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce69a39-3edd-495a-94ce-a12e9fbbe356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14cead0>]}
[0m17:55:26.600122 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m17:55:26.600412 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m17:55:26.600649 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m17:55:26.600900 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m17:55:26.601141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m17:55:26.601346 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m17:55:26.602455 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m17:55:26.602879 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m17:55:26.604451 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m17:55:26.604888 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:26.605062 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m17:55:26.605214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:26.608119 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:55:26.608403 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:26.608610 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m17:55:26.608952 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.610088 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:26.610250 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:55:26.610501 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.611521 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:26.611692 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:55:26.611929 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.612569 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:55:26.612746 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:26.612901 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m17:55:26.613451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.614455 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m17:55:26.614655 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m17:55:26.615063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.615562 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m17:55:26.617084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce69a39-3edd-495a-94ce-a12e9fbbe356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1531610>]}
[0m17:55:26.617359 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m17:55:26.617635 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m17:55:26.617840 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m17:55:26.618076 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m17:55:26.618291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m17:55:26.618497 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m17:55:26.619499 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m17:55:26.619916 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m17:55:26.621237 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m17:55:26.621618 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:26.621804 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m17:55:26.621959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:26.625260 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:55:26.625483 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:26.625674 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m17:55:26.626022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.628185 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:26.628383 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m17:55:26.628998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.630199 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:26.630383 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m17:55:26.630667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.666742 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:55:26.667250 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:26.667954 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m17:55:26.670549 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:26.671905 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m17:55:26.672104 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m17:55:26.672602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:26.673237 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m17:55:26.674963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce69a39-3edd-495a-94ce-a12e9fbbe356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1470b10>]}
[0m17:55:26.675317 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.06s]
[0m17:55:26.675625 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m17:55:26.676287 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:26.676493 [debug] [MainThread]: On master: BEGIN
[0m17:55:26.676708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:26.680324 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:55:26.680646 [debug] [MainThread]: On master: COMMIT
[0m17:55:26.680986 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:26.681300 [debug] [MainThread]: On master: COMMIT
[0m17:55:26.681685 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:26.681932 [debug] [MainThread]: On master: Close
[0m17:55:26.682979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:26.683177 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:55:26.683327 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:55:26.683510 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m17:55:26.683733 [info ] [MainThread]: 
[0m17:55:26.683932 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:55:26.684389 [debug] [MainThread]: Command end result
[0m17:55:26.701822 [info ] [MainThread]: 
[0m17:55:26.702210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:26.702513 [info ] [MainThread]: 
[0m17:55:26.702798 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:55:26.703329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43109196, "process_user_time": 0.796666, "process_kernel_time": 0.064951, "process_mem_max_rss": "251416", "process_out_blocks": "3409", "process_in_blocks": "0"}
[0m17:55:26.703635 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:26.703579 after 0.43 seconds
[0m17:55:26.703853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafbba150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafbb8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa69250>]}
[0m17:55:26.704091 [debug] [MainThread]: Flushing usage events
[0m17:57:23.001827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacad1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacad8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacad1b90>]}


============================== 17:57:23.003036 | 8e91b65b-8bee-41a4-9cfc-15493ad13fd5 ==============================
[0m17:57:23.003036 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:57:23.003464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:57:23.071286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e91b65b-8bee-41a4-9cfc-15493ad13fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4251450>]}
[0m17:57:23.088121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e91b65b-8bee-41a4-9cfc-15493ad13fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeee2c10>]}
[0m17:57:23.088467 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:57:23.112679 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:57:23.156824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:23.157102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:23.173433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e91b65b-8bee-41a4-9cfc-15493ad13fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb22dd0>]}
[0m17:57:23.217707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e91b65b-8bee-41a4-9cfc-15493ad13fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d70c50>]}
[0m17:57:23.217975 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:57:23.218304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e91b65b-8bee-41a4-9cfc-15493ad13fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3fec350>]}
[0m17:57:23.219091 [info ] [MainThread]: 
[0m17:57:23.219566 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:23.221610 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:57:23.234603 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:57:23.234826 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:57:23.235002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:23.239114 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:57:23.239330 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:57:23.239533 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:57:23.247903 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:57:23.248583 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:57:23.248946 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:57:23.249121 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:57:23.250586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e91b65b-8bee-41a4-9cfc-15493ad13fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa428bf50>]}
[0m17:57:23.250839 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:23.251019 [debug] [MainThread]: On master: BEGIN
[0m17:57:23.251191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:23.254331 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:57:23.254516 [debug] [MainThread]: On master: COMMIT
[0m17:57:23.254681 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:23.254842 [debug] [MainThread]: On master: COMMIT
[0m17:57:23.255272 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:23.255572 [debug] [MainThread]: On master: Close
[0m17:57:23.256284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:23.256516 [info ] [MainThread]: 
[0m17:57:23.257665 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:23.257894 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:57:23.258327 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:57:23.258557 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:23.264929 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:23.265846 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:23.271180 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:23.271786 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:23.271943 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:57:23.272091 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:23.275395 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:23.275598 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:23.275769 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:57:23.283329 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:57:23.283555 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:23.283800 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:57:23.285135 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:57:23.285334 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:57:23.287225 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:23.287496 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:57:23.287805 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:23.288045 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:23.288533 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:57:23.288794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:57:23.288993 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:23.292039 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:23.292611 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:23.293510 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:23.293934 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:23.294099 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:57:23.294256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:23.297010 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:23.297209 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:23.297410 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:57:23.303918 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:57:23.304103 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:23.304314 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:57:23.305409 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:57:23.305596 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:57:23.307357 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:57:23.307624 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:57:23.307909 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:23.308140 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:23.308359 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:57:23.308597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:57:23.308798 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:23.311134 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:23.311672 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:23.312534 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:23.312970 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:23.313237 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:57:23.313415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:23.316102 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:23.316278 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:23.316450 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:23.323222 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:23.323437 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:23.323648 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:57:23.324574 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:57:23.324738 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:57:23.326337 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:23.326563 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:57:23.326810 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:23.327009 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:23.327242 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:57:23.327480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:57:23.327655 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:23.329121 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:23.329676 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:23.330525 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:23.331004 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:23.331202 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:57:23.331383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:23.334084 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:23.334267 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:23.334435 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:23.341162 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:23.341743 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:23.342080 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:57:23.343237 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:57:23.343449 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:57:23.345587 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:23.345887 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:57:23.346181 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:23.347016 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:23.347235 [debug] [MainThread]: On master: BEGIN
[0m17:57:23.347407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:23.350809 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:57:23.351033 [debug] [MainThread]: On master: COMMIT
[0m17:57:23.351288 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:23.351487 [debug] [MainThread]: On master: COMMIT
[0m17:57:23.351768 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:23.351962 [debug] [MainThread]: On master: Close
[0m17:57:23.352742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:23.352935 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:57:23.353123 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:57:23.353367 [info ] [MainThread]: 
[0m17:57:23.353583 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:57:23.354067 [debug] [MainThread]: Command end result
[0m17:57:23.393192 [info ] [MainThread]: 
[0m17:57:23.393579 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:57:23.393758 [info ] [MainThread]: 
[0m17:57:23.393955 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:23.394212 [info ] [MainThread]: 
[0m17:57:23.394403 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:57:23.394587 [info ] [MainThread]: 
[0m17:57:23.394830 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:23.395018 [info ] [MainThread]: 
[0m17:57:23.395222 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:23.395389 [info ] [MainThread]: 
[0m17:57:23.395559 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:57:23.395960 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.4110479, "process_user_time": 0.753105, "process_kernel_time": 0.078218, "process_mem_max_rss": "251636", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:57:23.396184 [debug] [MainThread]: Command `dbt test` failed at 17:57:23.396151 after 0.41 seconds
[0m17:57:23.396383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb187e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb187dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacaf5590>]}
[0m17:57:23.396570 [debug] [MainThread]: Flushing usage events
[0m17:57:31.437933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa71150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f34c050>]}


============================== 17:57:31.439087 | 9ad5198d-9a7e-4f28-a103-a0d188f232f8 ==============================
[0m17:57:31.439087 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:57:31.439518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select int_fifo_matched', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:31.507276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ad5198d-9a7e-4f28-a103-a0d188f232f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ccb4d0>]}
[0m17:57:31.524607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ad5198d-9a7e-4f28-a103-a0d188f232f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09c3210>]}
[0m17:57:31.524948 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:57:31.549387 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:57:31.593229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:31.593459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:31.609538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad5198d-9a7e-4f28-a103-a0d188f232f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b38510>]}
[0m17:57:31.653089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ad5198d-9a7e-4f28-a103-a0d188f232f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9584ff50>]}
[0m17:57:31.653392 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:57:31.653711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad5198d-9a7e-4f28-a103-a0d188f232f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bba690>]}
[0m17:57:31.654479 [info ] [MainThread]: 
[0m17:57:31.654821 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:31.656769 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:57:31.669207 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:57:31.669432 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:57:31.669609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:31.673558 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:57:31.673771 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:57:31.673962 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:57:31.682131 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:57:31.682741 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:57:31.683090 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:57:31.683289 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:57:31.684762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad5198d-9a7e-4f28-a103-a0d188f232f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b39510>]}
[0m17:57:31.685039 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:31.685231 [debug] [MainThread]: On master: BEGIN
[0m17:57:31.685410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:31.688502 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:57:31.688800 [debug] [MainThread]: On master: COMMIT
[0m17:57:31.689003 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:31.689192 [debug] [MainThread]: On master: COMMIT
[0m17:57:31.689553 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:31.689795 [debug] [MainThread]: On master: Close
[0m17:57:31.690563 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:31.690786 [info ] [MainThread]: 
[0m17:57:31.691868 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:31.692109 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:57:31.692498 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:57:31.692689 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:31.698848 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:31.699398 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:31.704638 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:31.705080 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:31.705275 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:57:31.705454 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:31.708444 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:31.708650 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:31.708833 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:57:31.716194 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:57:31.716401 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:31.716605 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:57:31.717946 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:57:31.718120 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:57:31.719738 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:31.720038 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:57:31.720384 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:31.720617 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:31.721073 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:57:31.721333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:57:31.721539 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:31.724501 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:31.724989 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:31.725897 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:31.726298 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:31.726479 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:57:31.726645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:31.729424 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:31.729658 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:31.729849 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:57:31.736279 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:57:31.736625 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:31.736944 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:57:31.737877 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:57:31.738071 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:57:31.739708 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:57:31.739964 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:57:31.740227 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:31.740428 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:31.740642 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:57:31.740865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:57:31.741051 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:31.743377 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:31.743847 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:31.744749 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:31.745226 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:31.745414 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:57:31.745584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:31.748372 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:31.748686 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:31.748861 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:31.755697 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:31.755912 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:31.756181 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:57:31.757134 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:57:31.757339 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:57:31.759247 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:31.759572 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:57:31.759870 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:31.760139 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:31.760394 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:57:31.760665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:57:31.760860 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:31.762473 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:31.762936 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:31.763847 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:31.764312 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:31.764495 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:57:31.764666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:31.767392 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:31.767591 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:31.767762 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:31.774262 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:31.774554 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:31.774816 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:57:31.775787 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:57:31.776034 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:57:31.777739 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:31.777985 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:57:31.778290 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:31.778913 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:31.779224 [debug] [MainThread]: On master: BEGIN
[0m17:57:31.779404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:31.782399 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:57:31.782589 [debug] [MainThread]: On master: COMMIT
[0m17:57:31.782763 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:31.782927 [debug] [MainThread]: On master: COMMIT
[0m17:57:31.783201 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:31.783377 [debug] [MainThread]: On master: Close
[0m17:57:31.784298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:31.784574 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:57:31.784750 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:57:31.784945 [info ] [MainThread]: 
[0m17:57:31.785162 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:57:31.785603 [debug] [MainThread]: Command end result
[0m17:57:31.823392 [info ] [MainThread]: 
[0m17:57:31.823801 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:57:31.824037 [info ] [MainThread]: 
[0m17:57:31.824318 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:31.824516 [info ] [MainThread]: 
[0m17:57:31.824750 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:57:31.824925 [info ] [MainThread]: 
[0m17:57:31.825128 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:31.825290 [info ] [MainThread]: 
[0m17:57:31.825477 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:31.825634 [info ] [MainThread]: 
[0m17:57:31.825798 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:57:31.826197 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.40469232, "process_user_time": 0.747131, "process_kernel_time": 0.071629, "process_mem_max_rss": "251920", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:57:31.826424 [debug] [MainThread]: Command `dbt test` failed at 17:57:31.826392 after 0.40 seconds
[0m17:57:31.826611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa335dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa058da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b65810>]}
[0m17:57:31.826782 [debug] [MainThread]: Flushing usage events
[0m17:57:45.775221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa238eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2350c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa238c790>]}


============================== 17:57:45.776388 | c250a173-4aad-4fe3-89da-d0cc81d9cdc5 ==============================
[0m17:57:45.776388 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:57:45.776823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:57:45.844781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c250a173-4aad-4fe3-89da-d0cc81d9cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99af8d10>]}
[0m17:57:45.862847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c250a173-4aad-4fe3-89da-d0cc81d9cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa475f290>]}
[0m17:57:45.863240 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:57:45.887005 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:57:45.930140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:45.930403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:45.946494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c250a173-4aad-4fe3-89da-d0cc81d9cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23e5d90>]}
[0m17:57:45.990732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c250a173-4aad-4fe3-89da-d0cc81d9cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995efe90>]}
[0m17:57:45.991019 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:57:45.991328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c250a173-4aad-4fe3-89da-d0cc81d9cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9982e850>]}
[0m17:57:45.992099 [info ] [MainThread]: 
[0m17:57:45.992454 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:45.994448 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:57:46.006945 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:57:46.007172 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:57:46.007350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:46.011291 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:57:46.011548 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:57:46.011735 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:57:46.019854 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:57:46.020498 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:57:46.020829 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:57:46.021001 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:57:46.022653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c250a173-4aad-4fe3-89da-d0cc81d9cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9988ff10>]}
[0m17:57:46.022878 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:46.023052 [debug] [MainThread]: On master: BEGIN
[0m17:57:46.023212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:46.026275 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:57:46.026535 [debug] [MainThread]: On master: COMMIT
[0m17:57:46.026725 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:46.026893 [debug] [MainThread]: On master: COMMIT
[0m17:57:46.027169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:46.027339 [debug] [MainThread]: On master: Close
[0m17:57:46.028157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:46.028388 [info ] [MainThread]: 
[0m17:57:46.029516 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:46.029745 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:57:46.030137 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:57:46.030361 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:46.036548 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:46.037067 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:46.041999 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:46.042417 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:46.042602 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:57:46.042782 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:46.045765 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:46.045972 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:57:46.046147 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:57:46.053523 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:57:46.053741 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:46.053952 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:57:46.055410 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:57:46.055623 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:57:46.057166 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:46.057468 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:57:46.057787 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:57:46.058046 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:46.058546 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:57:46.058814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:57:46.059005 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:46.061883 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:46.062385 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:46.063364 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:46.063771 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:46.063953 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:57:46.064105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:46.066896 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:46.067105 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:57:46.067304 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:57:46.074113 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:57:46.074325 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:46.074598 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:57:46.075541 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:57:46.075742 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:57:46.077283 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:57:46.077537 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:57:46.077798 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:57:46.078016 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:46.078223 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:57:46.078492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:57:46.078684 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:46.081009 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:46.081506 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:46.082376 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:46.082761 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:46.082946 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:57:46.083097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:46.085808 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:46.085993 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:57:46.086139 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:46.093050 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:46.093230 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:46.093469 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:57:46.094336 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:57:46.094518 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:57:46.096383 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:46.096726 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:57:46.097029 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:57:46.097242 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:46.097490 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:57:46.097757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:57:46.097937 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:46.099449 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:46.099952 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:46.100820 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:46.101241 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:46.101443 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:57:46.101648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:46.104432 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:46.104718 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:57:46.104900 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:46.111758 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:46.111972 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:46.112192 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:57:46.113118 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:57:46.113318 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:57:46.115256 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:46.115551 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:57:46.115844 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:57:46.116522 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:46.116718 [debug] [MainThread]: On master: BEGIN
[0m17:57:46.116888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:46.120031 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:57:46.120349 [debug] [MainThread]: On master: COMMIT
[0m17:57:46.120557 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:46.120718 [debug] [MainThread]: On master: COMMIT
[0m17:57:46.121071 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:46.121368 [debug] [MainThread]: On master: Close
[0m17:57:46.122116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:46.122298 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:57:46.122484 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:57:46.122681 [info ] [MainThread]: 
[0m17:57:46.122871 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:57:46.123369 [debug] [MainThread]: Command end result
[0m17:57:46.160586 [info ] [MainThread]: 
[0m17:57:46.161101 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:57:46.161345 [info ] [MainThread]: 
[0m17:57:46.161623 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:46.161931 [info ] [MainThread]: 
[0m17:57:46.162239 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:57:46.162445 [info ] [MainThread]: 
[0m17:57:46.162644 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:46.162817 [info ] [MainThread]: 
[0m17:57:46.163041 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:57:46.163235 [info ] [MainThread]: 
[0m17:57:46.163441 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:57:46.163874 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.40504625, "process_user_time": 0.760794, "process_kernel_time": 0.063065, "process_mem_max_rss": "251868", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:57:46.164117 [debug] [MainThread]: Command `dbt test` failed at 17:57:46.164075 after 0.41 seconds
[0m17:57:46.164334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36cee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36cef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23509d0>]}
[0m17:57:46.164531 [debug] [MainThread]: Flushing usage events
[0m17:58:14.659780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d001810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d008690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d008c90>]}


============================== 17:58:14.660923 | e197addc-9b51-47a1-bee1-11de8cd4c177 ==============================
[0m17:58:14.660923 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:58:14.661244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select int_fifo_matched', 'send_anonymous_usage_stats': 'True'}
[0m17:58:14.730035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e197addc-9b51-47a1-bee1-11de8cd4c177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d003410>]}
[0m17:58:14.747420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e197addc-9b51-47a1-bee1-11de8cd4c177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8462c250>]}
[0m17:58:14.747783 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:58:14.772075 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:58:14.815059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:14.815295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:14.831394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e197addc-9b51-47a1-bee1-11de8cd4c177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84404790>]}
[0m17:58:14.875962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e197addc-9b51-47a1-bee1-11de8cd4c177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84573850>]}
[0m17:58:14.876271 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:58:14.876484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e197addc-9b51-47a1-bee1-11de8cd4c177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8451c2d0>]}
[0m17:58:14.877336 [info ] [MainThread]: 
[0m17:58:14.877652 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:14.879688 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:58:14.892535 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:58:14.892811 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:58:14.893014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:14.896923 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:58:14.897150 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:58:14.897327 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:58:14.905479 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:58:14.906108 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:58:14.906431 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:58:14.906602 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:58:14.908069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e197addc-9b51-47a1-bee1-11de8cd4c177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838b5250>]}
[0m17:58:14.908306 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:14.908550 [debug] [MainThread]: On master: BEGIN
[0m17:58:14.908752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:14.912208 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:58:14.912504 [debug] [MainThread]: On master: COMMIT
[0m17:58:14.912709 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:14.912890 [debug] [MainThread]: On master: COMMIT
[0m17:58:14.913232 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:14.913473 [debug] [MainThread]: On master: Close
[0m17:58:14.914284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:14.914503 [info ] [MainThread]: 
[0m17:58:14.915559 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:14.915804 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:58:14.916210 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:58:14.916405 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:14.922602 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:14.923140 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:14.928186 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:14.928609 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:14.928787 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:58:14.928942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:14.932224 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:14.932427 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:14.932614 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:58:14.940257 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:58:14.940491 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:14.940740 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:58:14.942073 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:58:14.942282 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:58:14.944306 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:14.944590 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:58:14.944902 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:14.945128 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:14.945578 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:58:14.945869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:58:14.946072 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:14.949146 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:14.949644 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:14.950552 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:14.951061 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:14.951281 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:58:14.951465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:14.954315 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:14.954525 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:14.954750 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:14.961527 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:14.961792 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:14.962017 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:58:14.962939 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:58:14.963129 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:58:14.964670 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:58:14.964945 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:58:14.965233 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:14.965457 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:14.965720 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:58:14.965978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:58:14.966199 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:14.968509 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:14.968985 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:14.969894 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:14.970279 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:14.970462 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:58:14.970605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:14.973516 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:14.973875 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:14.974069 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:14.981051 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:14.981254 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:14.981461 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:58:14.982375 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:58:14.982544 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:58:14.984139 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:14.984350 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:58:14.984609 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:14.984811 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:14.985027 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:58:14.985244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:58:14.985440 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:14.987008 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:14.987481 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:14.988362 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:14.988799 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:14.988981 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:58:14.989154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:14.991828 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:14.992008 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:14.992173 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:14.998709 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:14.998992 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:14.999393 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:58:15.000386 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:58:15.000629 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:58:15.002538 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:15.002853 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:58:15.003151 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:15.003793 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:15.004014 [debug] [MainThread]: On master: BEGIN
[0m17:58:15.004194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:15.007196 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:58:15.007406 [debug] [MainThread]: On master: COMMIT
[0m17:58:15.007558 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:15.007785 [debug] [MainThread]: On master: COMMIT
[0m17:58:15.008064 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:15.008246 [debug] [MainThread]: On master: Close
[0m17:58:15.009192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:15.009474 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:58:15.009672 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:58:15.009944 [info ] [MainThread]: 
[0m17:58:15.010158 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:58:15.010620 [debug] [MainThread]: Command end result
[0m17:58:15.050515 [info ] [MainThread]: 
[0m17:58:15.050814 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:58:15.050979 [info ] [MainThread]: 
[0m17:58:15.051216 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:15.051458 [info ] [MainThread]: 
[0m17:58:15.051657 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:58:15.051824 [info ] [MainThread]: 
[0m17:58:15.051990 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:15.052140 [info ] [MainThread]: 
[0m17:58:15.052304 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:15.052452 [info ] [MainThread]: 
[0m17:58:15.052617 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:58:15.053042 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.40974018, "process_user_time": 0.770799, "process_kernel_time": 0.060747, "process_mem_max_rss": "251832", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:58:15.053273 [debug] [MainThread]: Command `dbt test` failed at 17:58:15.053236 after 0.41 seconds
[0m17:58:15.053470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8460ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91dae090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8418fbd0>]}
[0m17:58:15.053666 [debug] [MainThread]: Flushing usage events
[0m17:58:25.263934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8508bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8508690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa853e1d0>]}


============================== 17:58:25.265142 | 039ccfd2-d46e-4f54-bd36-3d715030038f ==============================
[0m17:58:25.265142 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:58:25.265455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select int_fifo_matched', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:25.342327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '039ccfd2-d46e-4f54-bd36-3d715030038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8596150>]}
[0m17:58:25.362698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '039ccfd2-d46e-4f54-bd36-3d715030038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa90f7d0>]}
[0m17:58:25.363276 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:58:25.390743 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:58:25.438971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:25.439287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:25.456518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '039ccfd2-d46e-4f54-bd36-3d715030038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa94110>]}
[0m17:58:25.502359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '039ccfd2-d46e-4f54-bd36-3d715030038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7a4d10>]}
[0m17:58:25.502687 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:58:25.502909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '039ccfd2-d46e-4f54-bd36-3d715030038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa859e790>]}
[0m17:58:25.503750 [info ] [MainThread]: 
[0m17:58:25.504067 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:25.506163 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:58:25.519085 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:58:25.519355 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:58:25.519537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:25.523580 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:58:25.523823 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:58:25.524021 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:58:25.532502 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:58:25.533198 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:58:25.533607 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:58:25.533813 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:58:25.535264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '039ccfd2-d46e-4f54-bd36-3d715030038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9edb5010>]}
[0m17:58:25.535506 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:25.535694 [debug] [MainThread]: On master: BEGIN
[0m17:58:25.535882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:25.539281 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:58:25.539508 [debug] [MainThread]: On master: COMMIT
[0m17:58:25.539710 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:25.540008 [debug] [MainThread]: On master: COMMIT
[0m17:58:25.540321 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:25.540497 [debug] [MainThread]: On master: Close
[0m17:58:25.541291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:25.541538 [info ] [MainThread]: 
[0m17:58:25.542709 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:25.542971 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:58:25.543397 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:58:25.543604 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:25.550078 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:25.550652 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:25.556052 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:25.556524 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:25.556698 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:58:25.556848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:25.560130 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:25.560338 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:25.560546 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:58:25.568122 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:58:25.568332 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:25.568587 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:58:25.569927 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:58:25.570119 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:58:25.572165 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:25.572438 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:58:25.572751 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:25.573009 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:25.573538 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:58:25.573837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:58:25.574064 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:25.579894 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:25.581538 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:25.584232 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:25.585395 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:25.585739 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:58:25.586002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:25.590951 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:58:25.591381 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:25.591648 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:25.598983 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:25.599209 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:25.599432 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:58:25.600446 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:58:25.600679 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:58:25.602580 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:58:25.602970 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.03s]
[0m17:58:25.603310 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:25.603538 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:25.603847 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:58:25.604137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:58:25.604330 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:25.606970 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:25.607519 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:25.608511 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:25.609014 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:25.609201 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:58:25.609385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:25.612412 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:25.612614 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:25.612828 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:25.619759 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:25.620036 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:25.620294 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:58:25.621302 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:58:25.621538 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:58:25.623455 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:25.623880 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:58:25.624189 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:25.624415 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:25.624696 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:58:25.625000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:58:25.625223 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:25.626878 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:25.627379 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:25.628373 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:25.628871 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:25.629077 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:58:25.629253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:25.632320 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:25.632522 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:25.632713 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:25.640065 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:25.640310 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:25.640553 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:58:25.641539 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:58:25.641738 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:58:25.643371 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:25.643648 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:58:25.644061 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:25.644759 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:25.644944 [debug] [MainThread]: On master: BEGIN
[0m17:58:25.645125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:25.648525 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:58:25.648789 [debug] [MainThread]: On master: COMMIT
[0m17:58:25.648982 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:25.649151 [debug] [MainThread]: On master: COMMIT
[0m17:58:25.649453 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:25.649733 [debug] [MainThread]: On master: Close
[0m17:58:25.650545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:25.650744 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:58:25.650919 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:58:25.651142 [info ] [MainThread]: 
[0m17:58:25.651354 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m17:58:25.651851 [debug] [MainThread]: Command end result
[0m17:58:25.691546 [info ] [MainThread]: 
[0m17:58:25.691988 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:58:25.692177 [info ] [MainThread]: 
[0m17:58:25.692401 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:25.692588 [info ] [MainThread]: 
[0m17:58:25.692796 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:58:25.692992 [info ] [MainThread]: 
[0m17:58:25.693171 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:25.693324 [info ] [MainThread]: 
[0m17:58:25.693490 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:25.693654 [info ] [MainThread]: 
[0m17:58:25.693850 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:58:25.694287 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.44802046, "process_user_time": 0.784186, "process_kernel_time": 0.072201, "process_mem_max_rss": "251992", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:58:25.694517 [debug] [MainThread]: Command `dbt test` failed at 17:58:25.694482 after 0.45 seconds
[0m17:58:25.694729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f67bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f679f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f678710>]}
[0m17:58:25.694921 [debug] [MainThread]: Flushing usage events
[0m17:58:33.661916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa591dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab90f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa5ce5d0>]}


============================== 17:58:33.663102 | 9a384126-7b72-48f3-a468-696e8858fc1c ==============================
[0m17:58:33.663102 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:58:33.663417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:58:33.730680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a384126-7b72-48f3-a468-696e8858fc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa63ba50>]}
[0m17:58:33.747667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a384126-7b72-48f3-a468-696e8858fc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9a3350>]}
[0m17:58:33.748014 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:58:33.772911 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:58:33.818725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:33.819009 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:33.835400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a384126-7b72-48f3-a468-696e8858fc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1987c50>]}
[0m17:58:33.882312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a384126-7b72-48f3-a468-696e8858fc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1831250>]}
[0m17:58:33.882608 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:58:33.882797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a384126-7b72-48f3-a468-696e8858fc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa181f3d0>]}
[0m17:58:33.883550 [info ] [MainThread]: 
[0m17:58:33.883871 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:33.886167 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:58:33.898422 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:58:33.898679 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:58:33.898863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:33.902663 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:58:33.902869 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:58:33.903058 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:58:33.911203 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:58:33.911867 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:58:33.912212 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:58:33.912387 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:58:33.913917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a384126-7b72-48f3-a468-696e8858fc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1aa6350>]}
[0m17:58:33.914173 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:33.914346 [debug] [MainThread]: On master: BEGIN
[0m17:58:33.914519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:33.917564 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:58:33.917807 [debug] [MainThread]: On master: COMMIT
[0m17:58:33.917992 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:33.918165 [debug] [MainThread]: On master: COMMIT
[0m17:58:33.918614 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:33.918910 [debug] [MainThread]: On master: Close
[0m17:58:33.919704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:33.919928 [info ] [MainThread]: 
[0m17:58:33.921048 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:33.921301 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:58:33.921751 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:58:33.921952 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:33.928094 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:33.928664 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:33.933859 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:33.934285 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:33.934476 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:58:33.934629 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:33.937834 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:33.938038 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:33.938206 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:58:33.945582 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:58:33.945849 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:33.946143 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:58:33.947454 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:58:33.947678 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:58:33.949428 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:33.949686 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:58:33.950026 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:33.950272 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:33.950747 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:58:33.951037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:58:33.951242 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:33.954264 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:33.954770 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:33.955706 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:33.956159 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:33.956342 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:58:33.956517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:33.959398 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:33.959611 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:33.959805 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:33.967329 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:33.967668 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:33.967980 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:58:33.969006 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:58:33.969231 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:58:33.971201 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:58:33.971555 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:58:33.971895 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:33.972162 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:33.972447 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:58:33.972758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:58:33.972992 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:33.975527 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:33.976109 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:33.977136 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:33.977530 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:33.977736 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:58:33.977941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:33.981345 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:33.981586 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:33.981798 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:33.989476 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:33.989847 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:33.990101 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:58:33.991170 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:58:33.991366 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:58:33.993092 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:33.993363 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:58:33.993685 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:33.993935 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:33.994209 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:58:33.994482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:58:33.994741 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:33.996606 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:33.997112 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:33.998021 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:33.998466 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:33.998715 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:58:33.998917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:34.002221 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:34.002410 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:34.002580 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:34.009884 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:34.010144 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:34.010379 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:58:34.011296 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:58:34.011482 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:58:34.013123 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:34.013376 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:58:34.013690 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:34.014358 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:34.014549 [debug] [MainThread]: On master: BEGIN
[0m17:58:34.014735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:34.017809 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:58:34.017989 [debug] [MainThread]: On master: COMMIT
[0m17:58:34.018157 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:34.018320 [debug] [MainThread]: On master: COMMIT
[0m17:58:34.018602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:34.018810 [debug] [MainThread]: On master: Close
[0m17:58:34.019498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:34.019688 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:58:34.019866 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:58:34.020062 [info ] [MainThread]: 
[0m17:58:34.020276 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m17:58:34.020731 [debug] [MainThread]: Command end result
[0m17:58:34.060435 [info ] [MainThread]: 
[0m17:58:34.060756 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:58:34.060931 [info ] [MainThread]: 
[0m17:58:34.061170 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:34.061391 [info ] [MainThread]: 
[0m17:58:34.061622 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:58:34.061818 [info ] [MainThread]: 
[0m17:58:34.061999 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:34.062154 [info ] [MainThread]: 
[0m17:58:34.062325 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:34.062496 [info ] [MainThread]: 
[0m17:58:34.062667 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:58:34.063082 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.41741276, "process_user_time": 0.765897, "process_kernel_time": 0.063073, "process_mem_max_rss": "251848", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:58:34.063302 [debug] [MainThread]: Command `dbt test` failed at 17:58:34.063269 after 0.42 seconds
[0m17:58:34.063481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf33df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa5e1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa5e2e50>]}
[0m17:58:34.063682 [debug] [MainThread]: Flushing usage events
[0m17:58:48.068140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c468950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca47210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca46850>]}


============================== 17:58:48.069270 | 27682512-ddb2-412d-aae1-729523ab918d ==============================
[0m17:58:48.069270 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:58:48.069620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:48.138130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27682512-ddb2-412d-aae1-729523ab918d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73b66d90>]}
[0m17:58:48.155359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27682512-ddb2-412d-aae1-729523ab918d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e873110>]}
[0m17:58:48.155735 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:58:48.179786 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:58:48.224156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:48.224423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:48.240778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27682512-ddb2-412d-aae1-729523ab918d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c08fd0>]}
[0m17:58:48.286092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27682512-ddb2-412d-aae1-729523ab918d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73700190>]}
[0m17:58:48.286396 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:58:48.286607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27682512-ddb2-412d-aae1-729523ab918d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7392bd10>]}
[0m17:58:48.287417 [info ] [MainThread]: 
[0m17:58:48.287735 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:48.289824 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:58:48.302598 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:58:48.302836 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:58:48.303028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:48.306766 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:58:48.306972 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:58:48.307155 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:58:48.315411 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:58:48.316049 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:58:48.316383 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:58:48.316553 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:58:48.318287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27682512-ddb2-412d-aae1-729523ab918d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7392af50>]}
[0m17:58:48.318605 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:48.318831 [debug] [MainThread]: On master: BEGIN
[0m17:58:48.319025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:48.322654 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:58:48.322948 [debug] [MainThread]: On master: COMMIT
[0m17:58:48.323147 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:48.323320 [debug] [MainThread]: On master: COMMIT
[0m17:58:48.323670 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:48.323918 [debug] [MainThread]: On master: Close
[0m17:58:48.324706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:48.324936 [info ] [MainThread]: 
[0m17:58:48.326059 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:48.326301 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:58:48.326717 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:58:48.326918 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:48.333251 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:48.333787 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:48.339013 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:48.339454 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:48.339653 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:58:48.339823 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:48.343241 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:48.343441 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:58:48.343621 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:58:48.351494 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:58:48.351710 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:48.351924 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:58:48.353305 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:58:48.353493 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:58:48.355111 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:48.355371 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:58:48.355711 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:58:48.355957 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:48.356415 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:58:48.356672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:58:48.356896 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:48.359855 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:48.360341 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:48.361221 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:48.361705 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:48.361907 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:58:48.362085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:48.365154 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:48.365372 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:58:48.365569 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:48.372473 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:48.372703 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:48.372997 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:58:48.373936 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:58:48.374137 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:58:48.376036 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:58:48.376391 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:58:48.376692 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:58:48.376935 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:48.377185 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:58:48.377458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:58:48.377670 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:48.380073 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:48.380550 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:48.381476 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:48.381902 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:48.382127 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:58:48.382290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:48.385014 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:48.385211 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:58:48.385410 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:48.392282 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:48.392498 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:48.392755 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:58:48.393701 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:58:48.393915 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:58:48.395525 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:48.395787 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:58:48.396094 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:58:48.396324 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:48.396561 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:58:48.396833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:58:48.397025 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:48.398522 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:48.399010 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:48.399904 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:48.400363 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:48.400544 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:58:48.400733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:48.403488 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:48.403696 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:58:48.403887 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:48.410587 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:48.410840 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:58:48.411084 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:58:48.411974 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:58:48.412166 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:58:48.413824 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:48.414072 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:58:48.414359 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:58:48.415035 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:48.415213 [debug] [MainThread]: On master: BEGIN
[0m17:58:48.415376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:48.418389 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:58:48.418574 [debug] [MainThread]: On master: COMMIT
[0m17:58:48.418774 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:48.418946 [debug] [MainThread]: On master: COMMIT
[0m17:58:48.419228 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:48.419405 [debug] [MainThread]: On master: Close
[0m17:58:48.420105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:48.420286 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:58:48.420450 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:58:48.420648 [info ] [MainThread]: 
[0m17:58:48.420828 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:58:48.421244 [debug] [MainThread]: Command end result
[0m17:58:48.459449 [info ] [MainThread]: 
[0m17:58:48.459788 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:58:48.460017 [info ] [MainThread]: 
[0m17:58:48.460431 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:48.460747 [info ] [MainThread]: 
[0m17:58:48.460980 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:58:48.461185 [info ] [MainThread]: 
[0m17:58:48.461373 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:48.461536 [info ] [MainThread]: 
[0m17:58:48.461741 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:58:48.461925 [info ] [MainThread]: 
[0m17:58:48.462124 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:58:48.462572 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.41095713, "process_user_time": 0.780089, "process_kernel_time": 0.064838, "process_mem_max_rss": "251996", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:58:48.462807 [debug] [MainThread]: Command `dbt test` failed at 17:58:48.462766 after 0.41 seconds
[0m17:58:48.463008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810b9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c462310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c463fd0>]}
[0m17:58:48.463194 [debug] [MainThread]: Flushing usage events
[0m17:59:16.120281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8821d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa716dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c40e90>]}


============================== 17:59:16.121433 | f3335697-09b8-403d-9a52-4568718fb0c1 ==============================
[0m17:59:16.121433 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:59:16.121787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select int_fifo_matched', 'send_anonymous_usage_stats': 'True'}
[0m17:59:16.188966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3335697-09b8-403d-9a52-4568718fb0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88ccc50>]}
[0m17:59:16.205614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3335697-09b8-403d-9a52-4568718fb0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac2f310>]}
[0m17:59:16.205989 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:59:16.230002 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:59:16.273612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:16.273853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:16.289924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3335697-09b8-403d-9a52-4568718fb0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffec210>]}
[0m17:59:16.338947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3335697-09b8-403d-9a52-4568718fb0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fac4e10>]}
[0m17:59:16.339440 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:59:16.339691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3335697-09b8-403d-9a52-4568718fb0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd3ac90>]}
[0m17:59:16.340605 [info ] [MainThread]: 
[0m17:59:16.340946 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:16.343000 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:59:16.356476 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:16.356705 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:59:16.356877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:16.360783 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:59:16.361005 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:16.361172 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:59:16.369662 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:59:16.370357 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:59:16.370728 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:59:16.370929 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:59:16.372458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3335697-09b8-403d-9a52-4568718fb0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffe0950>]}
[0m17:59:16.372698 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:16.372887 [debug] [MainThread]: On master: BEGIN
[0m17:59:16.373062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:16.376391 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:59:16.376682 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.376922 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:16.377124 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.377477 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:16.377710 [debug] [MainThread]: On master: Close
[0m17:59:16.378445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:16.378680 [info ] [MainThread]: 
[0m17:59:16.379846 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:16.380102 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:59:16.380506 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:59:16.380781 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:16.387255 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:16.387803 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:16.393107 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:16.393521 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:16.393700 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:59:16.393879 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:16.397183 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:16.397417 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:16.397656 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:59:16.405403 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:59:16.405670 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:16.405898 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:59:16.407359 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:59:16.407570 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:59:16.409295 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:16.409581 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:59:16.409910 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:16.410165 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:16.410650 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:59:16.410917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:59:16.411128 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:16.414372 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:16.414874 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:16.415797 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:16.416227 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:16.416417 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:59:16.416597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.419552 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:16.419826 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:16.420037 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:59:16.427060 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:59:16.427341 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:16.427544 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:59:16.428473 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:59:16.428639 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:59:16.430223 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:59:16.430467 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:59:16.430738 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:16.431053 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:16.431308 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:59:16.431564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:59:16.431753 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:16.434203 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:16.434669 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:16.435609 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:16.435962 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:16.436157 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:59:16.436318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.438943 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:16.439129 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:16.439298 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:16.445733 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:16.445959 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:16.446197 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:59:16.447310 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:59:16.447529 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:59:16.449149 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:16.449371 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:59:16.449643 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:16.449877 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:16.450097 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:59:16.450350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:59:16.450537 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:16.452132 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:16.452615 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:16.453526 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:16.453985 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:16.454189 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:59:16.454363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.457001 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:16.457194 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:16.457361 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:16.463769 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:16.464047 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:16.464359 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:59:16.465320 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:59:16.465501 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:59:16.467369 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:16.467660 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:59:16.467978 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:16.468647 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:16.468921 [debug] [MainThread]: On master: BEGIN
[0m17:59:16.469113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:16.472208 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:59:16.472438 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.472666 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:16.472840 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.473181 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:16.473397 [debug] [MainThread]: On master: Close
[0m17:59:16.474210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:16.474385 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:59:16.474545 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:59:16.474750 [info ] [MainThread]: 
[0m17:59:16.475016 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:59:16.475458 [debug] [MainThread]: Command end result
[0m17:59:16.513349 [info ] [MainThread]: 
[0m17:59:16.513659 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:59:16.513851 [info ] [MainThread]: 
[0m17:59:16.514046 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:16.514207 [info ] [MainThread]: 
[0m17:59:16.514386 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:59:16.514565 [info ] [MainThread]: 
[0m17:59:16.514791 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:16.514981 [info ] [MainThread]: 
[0m17:59:16.515237 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:16.515488 [info ] [MainThread]: 
[0m17:59:16.515728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:59:16.516240 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.41238645, "process_user_time": 0.75316, "process_kernel_time": 0.070108, "process_mem_max_rss": "251844", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:59:16.516483 [debug] [MainThread]: Command `dbt test` failed at 17:59:16.516444 after 0.41 seconds
[0m17:59:16.516691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad479250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab356990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99e8b90>]}
[0m17:59:16.516915 [debug] [MainThread]: Flushing usage events
[0m17:59:27.200681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d40f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d48690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d48c90>]}


============================== 17:59:27.201808 | c7eeda8e-4de9-4f27-9b03-38deb90e4211 ==============================
[0m17:59:27.201808 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:59:27.202219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:59:27.269766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7eeda8e-4de9-4f27-9b03-38deb90e4211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dd6450>]}
[0m17:59:27.287123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7eeda8e-4de9-4f27-9b03-38deb90e4211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4152e10>]}
[0m17:59:27.287460 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:59:27.311292 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:59:27.356659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:27.356974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:27.376732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7eeda8e-4de9-4f27-9b03-38deb90e4211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99183690>]}
[0m17:59:27.422516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7eeda8e-4de9-4f27-9b03-38deb90e4211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fdfdd0>]}
[0m17:59:27.422837 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:59:27.423152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7eeda8e-4de9-4f27-9b03-38deb90e4211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992d0110>]}
[0m17:59:27.424001 [info ] [MainThread]: 
[0m17:59:27.424350 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:27.426666 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:59:27.439158 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:27.439405 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:59:27.439579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:27.443424 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:59:27.443629 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:27.443838 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:59:27.451881 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:59:27.452507 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:59:27.452884 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:59:27.453072 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:59:27.454775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7eeda8e-4de9-4f27-9b03-38deb90e4211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fd3c50>]}
[0m17:59:27.455123 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:27.455325 [debug] [MainThread]: On master: BEGIN
[0m17:59:27.455491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:27.458603 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:59:27.458799 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.458993 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:27.459158 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.459496 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:27.459724 [debug] [MainThread]: On master: Close
[0m17:59:27.460583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:27.461025 [info ] [MainThread]: 
[0m17:59:27.462316 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:27.462554 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:59:27.463075 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:59:27.463274 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:27.469619 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:27.470131 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:27.475259 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:27.475634 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:27.475818 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:59:27.475990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:27.479324 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:27.479542 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:27.479712 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:59:27.487314 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:59:27.487516 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:27.487724 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:59:27.489051 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:59:27.489265 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:59:27.490948 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:27.491270 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:59:27.491706 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:27.491970 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:27.492475 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:59:27.492820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:59:27.493045 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:27.496199 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:27.496713 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:27.497661 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:27.498154 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:27.498347 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:59:27.498526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:27.501450 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:27.501696 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:27.501902 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:59:27.509199 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:59:27.509600 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:27.509925 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:59:27.511018 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:59:27.511227 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:59:27.513078 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:59:27.513354 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:59:27.513651 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:27.513910 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:27.514177 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:59:27.514434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:59:27.514639 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:27.517343 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:27.517964 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:27.519175 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:27.519668 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:27.519878 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:59:27.520059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:27.523255 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:27.523472 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:27.523665 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:27.530629 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:27.530841 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:27.531088 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:59:27.532062 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:59:27.532243 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:59:27.533834 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:27.534096 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:59:27.534362 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:27.534577 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:27.534808 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:59:27.535018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:59:27.535191 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:27.536772 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:27.537275 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:27.538216 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:27.538654 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:27.538842 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:59:27.539040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:27.542038 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:27.542262 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:27.542433 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:27.549048 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:27.549328 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:27.549549 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:59:27.550541 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:59:27.550735 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:59:27.552737 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:27.553160 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:59:27.553475 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:27.554144 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:27.554332 [debug] [MainThread]: On master: BEGIN
[0m17:59:27.554503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:27.557507 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:59:27.557699 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.557887 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:27.558076 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.558364 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:27.558575 [debug] [MainThread]: On master: Close
[0m17:59:27.559468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:27.559724 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:59:27.559918 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:59:27.560205 [info ] [MainThread]: 
[0m17:59:27.560410 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m17:59:27.560867 [debug] [MainThread]: Command end result
[0m17:59:27.600122 [info ] [MainThread]: 
[0m17:59:27.600424 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:59:27.600614 [info ] [MainThread]: 
[0m17:59:27.600821 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:27.600979 [info ] [MainThread]: 
[0m17:59:27.601190 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:59:27.601374 [info ] [MainThread]: 
[0m17:59:27.601549 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:27.601701 [info ] [MainThread]: 
[0m17:59:27.601882 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:27.602070 [info ] [MainThread]: 
[0m17:59:27.602278 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:59:27.602686 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.4182225, "process_user_time": 0.761497, "process_kernel_time": 0.069409, "process_mem_max_rss": "251836", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:59:27.602914 [debug] [MainThread]: Command `dbt test` failed at 17:59:27.602881 after 0.42 seconds
[0m17:59:27.603138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6aede10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6aedbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ece0d0>]}
[0m17:59:27.603330 [debug] [MainThread]: Flushing usage events
[0m17:59:35.908752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ffc5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fc0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9200ff90>]}


============================== 17:59:35.909912 | c694fe76-85b5-4c50-8dee-0de5efd35922 ==============================
[0m17:59:35.909912 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:59:35.910248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:59:35.977626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c694fe76-85b5-4c50-8dee-0de5efd35922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920699d0>]}
[0m17:59:35.994813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c694fe76-85b5-4c50-8dee-0de5efd35922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943d3510>]}
[0m17:59:35.995186 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:59:36.018987 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:59:36.062742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:36.062999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:36.079202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c694fe76-85b5-4c50-8dee-0de5efd35922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893b3d90>]}
[0m17:59:36.123449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c694fe76-85b5-4c50-8dee-0de5efd35922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8925fe50>]}
[0m17:59:36.123720 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:59:36.123913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c694fe76-85b5-4c50-8dee-0de5efd35922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92040b90>]}
[0m17:59:36.124678 [info ] [MainThread]: 
[0m17:59:36.124979 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:36.126993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:59:36.139441 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:36.139667 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:59:36.139866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:36.143709 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:59:36.143920 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:36.144134 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:59:36.152434 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:59:36.153070 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:59:36.153395 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:59:36.153569 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:59:36.155008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c694fe76-85b5-4c50-8dee-0de5efd35922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92062490>]}
[0m17:59:36.155255 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:36.155441 [debug] [MainThread]: On master: BEGIN
[0m17:59:36.155612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:36.158660 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:59:36.158862 [debug] [MainThread]: On master: COMMIT
[0m17:59:36.159058 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:36.159231 [debug] [MainThread]: On master: COMMIT
[0m17:59:36.159665 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:36.159978 [debug] [MainThread]: On master: Close
[0m17:59:36.160848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:36.161093 [info ] [MainThread]: 
[0m17:59:36.162174 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:36.162402 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:59:36.162818 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:59:36.163022 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:36.169175 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:36.169668 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:36.174861 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:36.175252 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:36.175423 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:59:36.175579 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:36.178910 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:36.179221 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:36.179405 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:59:36.186631 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:59:36.186851 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:36.187074 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:59:36.188425 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:59:36.188628 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:59:36.190386 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:36.190665 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:59:36.191023 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:36.191252 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:36.191673 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:59:36.191944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:59:36.192164 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:36.195173 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:36.195650 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:36.196572 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:36.196944 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:36.197132 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:59:36.197293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:36.200040 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:36.200228 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:36.200386 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:59:36.207220 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:59:36.207476 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:36.207696 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:59:36.208693 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:59:36.208948 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:59:36.210515 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:59:36.210745 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:59:36.211037 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:36.211265 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:36.211492 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:59:36.211727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:59:36.211931 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:36.214149 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:36.214623 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:36.215536 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:36.215976 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:36.216150 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:59:36.216310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:36.218877 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:36.219059 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:36.219237 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:36.226037 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:36.226341 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:36.226568 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:59:36.227514 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:59:36.227700 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:59:36.229301 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:36.229551 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:59:36.229870 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:36.230101 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:36.230341 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:59:36.230608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:59:36.230822 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:36.232325 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:36.232802 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:36.233696 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:36.234147 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:36.234328 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:59:36.234499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:36.237421 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:36.237821 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:36.238030 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:36.244729 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:36.244973 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:36.245236 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:59:36.246195 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:59:36.246385 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:59:36.248218 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:36.248454 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:59:36.248746 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:36.249523 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:36.249704 [debug] [MainThread]: On master: BEGIN
[0m17:59:36.249898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:36.253026 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:59:36.253312 [debug] [MainThread]: On master: COMMIT
[0m17:59:36.253511 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:36.253682 [debug] [MainThread]: On master: COMMIT
[0m17:59:36.254026 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:36.254260 [debug] [MainThread]: On master: Close
[0m17:59:36.254950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:36.255113 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:59:36.255272 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:59:36.255467 [info ] [MainThread]: 
[0m17:59:36.255687 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:59:36.256159 [debug] [MainThread]: Command end result
[0m17:59:36.293040 [info ] [MainThread]: 
[0m17:59:36.293548 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:59:36.293831 [info ] [MainThread]: 
[0m17:59:36.294112 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:36.294325 [info ] [MainThread]: 
[0m17:59:36.294572 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:59:36.294782 [info ] [MainThread]: 
[0m17:59:36.295015 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:36.295191 [info ] [MainThread]: 
[0m17:59:36.295386 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:36.295555 [info ] [MainThread]: 
[0m17:59:36.295722 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:59:36.296147 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.4039182, "process_user_time": 0.749532, "process_kernel_time": 0.066603, "process_mem_max_rss": "251844", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:59:36.296360 [debug] [MainThread]: Command `dbt test` failed at 17:59:36.296327 after 0.40 seconds
[0m17:59:36.296535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d6df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8913bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fe7dd0>]}
[0m17:59:36.296720 [debug] [MainThread]: Flushing usage events
[0m17:59:44.736552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ccea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c98c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c91bd0>]}


============================== 17:59:44.737880 | 431c59a4-b190-4ae8-a9b0-6c497fb662e6 ==============================
[0m17:59:44.737880 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:59:44.738265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m17:59:44.738165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b65c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b628690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b65cc90>]}


============================== 17:59:44.739649 | b2f1b189-3246-43d8-843b-6dab7f9e5e07 ==============================
[0m17:59:44.739649 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:59:44.740641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m17:59:44.744561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9463cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94608690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94608c90>]}


============================== 17:59:44.745871 | 25d31483-d9ce-45ec-b4af-a9b714983bc7 ==============================
[0m17:59:44.745871 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:59:44.746392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:59:44.770980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddef0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca78490>]}


============================== 17:59:44.772441 | d3e994ca-ad92-4bda-aa76-4b640267ae38 ==============================
[0m17:59:44.772441 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:59:44.772815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m17:59:44.822532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '431c59a4-b190-4ae8-a9b0-6c497fb662e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d31f10>]}
[0m17:59:44.824055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2f1b189-3246-43d8-843b-6dab7f9e5e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6cecd0>]}
[0m17:59:44.829667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25d31483-d9ce-45ec-b4af-a9b714983bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946a25d0>]}
[0m17:59:44.842116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '431c59a4-b190-4ae8-a9b0-6c497fb662e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50a3510>]}
[0m17:59:44.843667 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:59:44.844740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2f1b189-3246-43d8-843b-6dab7f9e5e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7da33510>]}
[0m17:59:44.845699 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:59:44.849413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25d31483-d9ce-45ec-b4af-a9b714983bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc34390>]}
[0m17:59:44.849937 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:59:44.858572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3e994ca-ad92-4bda-aa76-4b640267ae38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb190d0>]}
[0m17:59:44.878627 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:59:44.880795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3e994ca-ad92-4bda-aa76-4b640267ae38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee7f550>]}
[0m17:59:44.882001 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:59:44.882526 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:59:44.882540 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:59:44.909594 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:59:44.944018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:44.944560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:44.945218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:44.947430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:44.947891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:44.950422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:44.966597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25d31483-d9ce-45ec-b4af-a9b714983bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9f38d0>]}
[0m17:59:44.968195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '431c59a4-b190-4ae8-a9b0-6c497fb662e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0c8f90>]}
[0m17:59:44.970743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:44.971064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:44.975138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2f1b189-3246-43d8-843b-6dab7f9e5e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d7d150>]}
[0m17:59:44.989507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3e994ca-ad92-4bda-aa76-4b640267ae38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83eb2c10>]}
[0m17:59:45.018733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25d31483-d9ce-45ec-b4af-a9b714983bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7e3d50>]}
[0m17:59:45.019073 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:59:45.019438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25d31483-d9ce-45ec-b4af-a9b714983bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8badacd0>]}
[0m17:59:45.020375 [info ] [MainThread]: 
[0m17:59:45.021481 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:45.022806 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:59:45.029630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '431c59a4-b190-4ae8-a9b0-6c497fb662e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e77fd0>]}
[0m17:59:45.030219 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:59:45.030831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '431c59a4-b190-4ae8-a9b0-6c497fb662e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a21d750>]}
[0m17:59:45.033036 [info ] [MainThread]: 
[0m17:59:45.033423 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:45.034082 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:59:45.035587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2f1b189-3246-43d8-843b-6dab7f9e5e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72803f50>]}
[0m17:59:45.035944 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:59:45.036160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f1b189-3246-43d8-843b-6dab7f9e5e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7298b150>]}
[0m17:59:45.036935 [info ] [MainThread]: 
[0m17:59:45.037313 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:45.037239 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:59:45.037615 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:59:45.037852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:45.037893 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:59:45.046381 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:59:45.047264 [debug] [ThreadPool]: On list_thrive: Close
[0m17:59:45.047258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3e994ca-ad92-4bda-aa76-4b640267ae38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c53f10>]}
[0m17:59:45.047730 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:59:45.048144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3e994ca-ad92-4bda-aa76-4b640267ae38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fc9190>]}
[0m17:59:45.048915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:59:45.049405 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:59:45.049724 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:59:45.049849 [info ] [MainThread]: 
[0m17:59:45.049916 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:59:45.050509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:45.050297 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:45.051477 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m17:59:45.052857 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:59:45.053288 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:59:45.053600 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:59:45.053508 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:59:45.053816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:45.053962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:45.056871 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:59:45.056917 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:59:45.057124 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:59:45.057211 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:59:45.057299 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:59:45.057669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:45.057858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:45.057917 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:59:45.058162 [info ] [MainThread]: 
[0m17:59:45.058108 [debug] [MainThread]: Connection 'list_thrive' was properly closed.
[0m17:59:45.058197 [debug] [ThreadPool]: On list_thrive: Close
[0m17:59:45.058427 [info ] [MainThread]: 
[0m17:59:45.058370 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m17:59:45.058718 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m17:59:45.058820 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4074). See also https://duckdb.org/docs/connect/concurrency
[0m17:59:45.059083 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4074). See also https://duckdb.org/docs/connect/concurrency
[0m17:59:45.059342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.33952567, "process_user_time": 0.75275, "process_kernel_time": 0.063315, "process_mem_max_rss": "251840", "process_in_blocks": "400", "process_out_blocks": "923", "command_success": false}
[0m17:59:45.059572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34497026, "process_user_time": 0.739277, "process_kernel_time": 0.073625, "process_mem_max_rss": "251940", "process_out_blocks": "921", "command_success": false, "process_in_blocks": "0"}
[0m17:59:45.061457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:59:45.061763 [debug] [MainThread]: Command `dbt run` failed at 17:59:45.061720 after 0.35 seconds
[0m17:59:45.061778 [debug] [MainThread]: Command `dbt run` failed at 17:59:45.061685 after 0.34 seconds
[0m17:59:45.061848 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:59:45.061993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b62ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6286d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803ca010>]}
[0m17:59:45.062082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9460ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad47410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b805210>]}
[0m17:59:45.062225 [debug] [MainThread]: Flushing usage events
[0m17:59:45.062318 [debug] [MainThread]: Flushing usage events
[0m17:59:45.065065 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:59:45.065390 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:59:45.065767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:45.069822 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:59:45.070635 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:59:45.070859 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m17:59:45.071238 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:45.071499 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:59:45.071724 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m17:59:45.072088 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:45.072598 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:59:45.072671 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m17:59:45.073007 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:59:45.073030 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m17:59:45.073322 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m17:59:45.073377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:45.073754 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:45.073946 [debug] [ThreadPool]: On create_thrive_main: Close
[0m17:59:45.077043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m17:59:45.078154 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:59:45.078878 [debug] [ThreadPool]: On list_thrive: Close
[0m17:59:45.079891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m17:59:45.079900 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:45.080348 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:59:45.080194 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m17:59:45.080551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:45.083224 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m17:59:45.083592 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:59:45.085054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:45.087740 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:59:45.087859 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m17:59:45.087953 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:45.088137 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:59:45.088322 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:59:45.089304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:45.090660 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m17:59:45.092419 [info ] [MainThread]: 
[0m17:59:45.092660 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m17:59:45.092917 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4074). See also https://duckdb.org/docs/connect/concurrency
[0m17:59:45.093413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34585375, "process_user_time": 0.756938, "process_kernel_time": 0.062324, "process_mem_max_rss": "251772", "process_out_blocks": "923", "command_success": false, "process_in_blocks": "0"}
[0m17:59:45.093689 [debug] [MainThread]: Command `dbt run` failed at 17:59:45.093647 after 0.35 seconds
[0m17:59:45.093916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca7abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831bcbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916c9110>]}
[0m17:59:45.094136 [debug] [MainThread]: Flushing usage events
[0m17:59:45.098593 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:59:45.100036 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:59:45.100682 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:59:45.102401 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:59:45.103893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '431c59a4-b190-4ae8-a9b0-6c497fb662e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994c4250>]}
[0m17:59:45.104210 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:45.104418 [debug] [MainThread]: On master: BEGIN
[0m17:59:45.104602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:45.108610 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:59:45.108934 [debug] [MainThread]: On master: COMMIT
[0m17:59:45.109175 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:45.109386 [debug] [MainThread]: On master: COMMIT
[0m17:59:45.109762 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:45.110016 [debug] [MainThread]: On master: Close
[0m17:59:45.110884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:45.111154 [info ] [MainThread]: 
[0m17:59:45.112547 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m17:59:45.112854 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m17:59:45.113170 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m17:59:45.113376 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m17:59:45.116351 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m17:59:45.117042 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m17:59:45.130157 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m17:59:45.130923 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m17:59:45.131172 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m17:59:45.131391 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:45.134936 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:59:45.135146 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m17:59:45.135374 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    cast(transaction_id as varchar) as transaction_id,
    cast(redeem_id as varchar) as redeem_id
from source_data
    );
  
  
[0m17:59:45.143177 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    cast(transaction_id as varchar) as transaction_id,
    cast(redeem_id as varchar) as redeem_id
from source_data
    );
  
  
[0m17:59:45.143463 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:45.143751 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m17:59:45.145125 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m17:59:45.145322 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m17:59:45.147088 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      cast(transaction_id as varchar) as transaction_id,
      cast(redeem_id as varchar) as redeem_id
  from source_data
      );
    
    ...
                             ^
[0m17:59:45.147801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '431c59a4-b190-4ae8-a9b0-6c497fb662e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99394890>]}
[0m17:59:45.148125 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.03s]
[0m17:59:45.148458 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m17:59:45.149286 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:45.149524 [debug] [MainThread]: On master: BEGIN
[0m17:59:45.149701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:45.152725 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:59:45.152942 [debug] [MainThread]: On master: COMMIT
[0m17:59:45.153120 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:45.153285 [debug] [MainThread]: On master: COMMIT
[0m17:59:45.153641 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:45.153870 [debug] [MainThread]: On master: Close
[0m17:59:45.154848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:45.155069 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:59:45.155249 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m17:59:45.155449 [info ] [MainThread]: 
[0m17:59:45.155649 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m17:59:45.155980 [debug] [MainThread]: Command end result
[0m17:59:45.177241 [info ] [MainThread]: 
[0m17:59:45.177631 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:59:45.177855 [info ] [MainThread]: 
[0m17:59:45.178087 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      cast(transaction_id as varchar) as transaction_id,
      cast(redeem_id as varchar) as redeem_id
  from source_data
      );
    
    ...
                             ^
[0m17:59:45.178280 [info ] [MainThread]: 
[0m17:59:45.178465 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:59:45.178989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.46866563, "process_user_time": 0.830585, "process_kernel_time": 0.086852, "process_mem_max_rss": "251668", "process_out_blocks": "1817", "command_success": false, "process_in_blocks": "0"}
[0m17:59:45.179270 [debug] [MainThread]: Command `dbt run` failed at 17:59:45.179231 after 0.47 seconds
[0m17:59:45.179522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c98510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c9aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78e9110>]}
[0m17:59:45.179730 [debug] [MainThread]: Flushing usage events
[0m17:59:50.397847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c31c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2e8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c31d4d0>]}


============================== 17:59:50.399006 | e1c9e074-d439-421c-a2be-b10f71e7316d ==============================
[0m17:59:50.399006 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:59:50.399449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:59:50.467300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1c9e074-d439-421c-a2be-b10f71e7316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2e3290>]}
[0m17:59:50.484281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1c9e074-d439-421c-a2be-b10f71e7316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6f2f10>]}
[0m17:59:50.484642 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m17:59:50.509054 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:59:50.552985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:50.553255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:50.569208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1c9e074-d439-421c-a2be-b10f71e7316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff936d3f10>]}
[0m17:59:50.613173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1c9e074-d439-421c-a2be-b10f71e7316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93580a50>]}
[0m17:59:50.613437 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m17:59:50.613746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1c9e074-d439-421c-a2be-b10f71e7316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c388950>]}
[0m17:59:50.614483 [info ] [MainThread]: 
[0m17:59:50.614821 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:50.616790 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m17:59:50.629187 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:50.629418 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m17:59:50.629618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:50.633268 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:59:50.633476 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m17:59:50.633677 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m17:59:50.641789 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:59:50.642444 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m17:59:50.642781 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m17:59:50.642954 [debug] [ThreadPool]: On list_thrive_main: Close
[0m17:59:50.644444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1c9e074-d439-421c-a2be-b10f71e7316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff938581d0>]}
[0m17:59:50.644717 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:50.644891 [debug] [MainThread]: On master: BEGIN
[0m17:59:50.645059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:50.648032 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:59:50.648237 [debug] [MainThread]: On master: COMMIT
[0m17:59:50.648437 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:50.648639 [debug] [MainThread]: On master: COMMIT
[0m17:59:50.649095 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:50.649409 [debug] [MainThread]: On master: Close
[0m17:59:50.650294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:50.650578 [info ] [MainThread]: 
[0m17:59:50.651677 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:50.651898 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_transaction_id ..................... [RUN]
[0m17:59:50.652307 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:59:50.652570 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:50.658794 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:50.659291 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:50.664428 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:50.664854 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:50.665051 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: BEGIN
[0m17:59:50.665230 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:50.668337 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:50.668536 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"
[0m17:59:50.668728 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:59:50.676092 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from "thrive"."main"."int_fifo_matched"
where transaction_id is null



      
    ) dbt_internal_test
[0m17:59:50.676289 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:50.676522 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: ROLLBACK
[0m17:59:50.677833 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614'
[0m17:59:50.678034 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614: Close
[0m17:59:50.679735 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:50.679994 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:59:50.680321 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614
[0m17:59:50.680586 [debug] [Thread-1 (]: Began running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:50.681032 [info ] [Thread-1 (]: 2 of 4 START test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [RUN]
[0m17:59:50.681300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_transaction_id.72960cd614, now test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c)
[0m17:59:50.681549 [debug] [Thread-1 (]: Began compiling node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:50.684609 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:50.685100 [debug] [Thread-1 (]: Began executing node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:50.686042 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:50.686478 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:50.686658 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: BEGIN
[0m17:59:50.686825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:50.689563 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:50.689762 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"
[0m17:59:50.689943 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:59:50.696674 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select redeem_id as from_field
    from "thrive"."main"."int_fifo_matched"
    where redeem_id is not null
),

parent as (
    select transaction_id as to_field
    from "thrive"."main"."stg_tc_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:59:50.696945 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:50.697157 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: ROLLBACK
[0m17:59:50.698111 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c'
[0m17:59:50.698278 [debug] [Thread-1 (]: On test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c: Close
[0m17:59:50.699935 [debug] [Thread-1 (]: Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:59:50.700191 [error] [Thread-1 (]: 2 of 4 ERROR relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_  [[31mERROR[0m in 0.02s]
[0m17:59:50.700478 [debug] [Thread-1 (]: Finished running node test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c
[0m17:59:50.700691 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:50.700901 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m17:59:50.701117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_.007af2db5c, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m17:59:50.701296 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:50.703668 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:50.704146 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:50.705068 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:50.705509 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:50.705714 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m17:59:50.705885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:50.708594 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:50.708790 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m17:59:50.708950 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:50.715786 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:50.716012 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:50.716240 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m17:59:50.717150 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m17:59:50.717336 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m17:59:50.719363 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:50.719729 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeem_id ................................. [[31mERROR[0m in 0.02s]
[0m17:59:50.720062 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m17:59:50.720303 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:50.720569 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_transaction_id ....................... [RUN]
[0m17:59:50.720855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48)
[0m17:59:50.721046 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:50.722604 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:50.723055 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:50.723959 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:50.724417 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:50.724601 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: BEGIN
[0m17:59:50.724774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:50.727420 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:50.727627 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"
[0m17:59:50.727818 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:50.734380 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:50.734592 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:59:50.734807 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: ROLLBACK
[0m17:59:50.735720 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48'
[0m17:59:50.735898 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48: Close
[0m17:59:50.737764 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:50.738006 [error] [Thread-1 (]: 4 of 4 ERROR unique_int_fifo_matched_transaction_id ............................ [[31mERROR[0m in 0.02s]
[0m17:59:50.738281 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48
[0m17:59:50.738940 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:50.739142 [debug] [MainThread]: On master: BEGIN
[0m17:59:50.739308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:50.742369 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:59:50.742690 [debug] [MainThread]: On master: COMMIT
[0m17:59:50.742876 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:50.743039 [debug] [MainThread]: On master: COMMIT
[0m17:59:50.743397 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:50.743640 [debug] [MainThread]: On master: Close
[0m17:59:50.744353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:50.744560 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m17:59:50.744737 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_transaction_id.a8b089bb48' was properly closed.
[0m17:59:50.744937 [info ] [MainThread]: 
[0m17:59:50.745157 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:59:50.745644 [debug] [MainThread]: Command end result
[0m17:59:50.783639 [info ] [MainThread]: 
[0m17:59:50.783937 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:59:50.784132 [info ] [MainThread]: 
[0m17:59:50.784375 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 14: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:50.784565 [info ] [MainThread]: 
[0m17:59:50.784774 [error] [MainThread]:   Runtime Error in test relationships_int_fifo_matched_redeem_id__transaction_id__ref_stg_tc_data_ (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 13:     from "thrive"."main"."int_fifo_matched"
                    ^
[0m17:59:50.784999 [info ] [MainThread]: 
[0m17:59:50.785339 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeem_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:50.785555 [info ] [MainThread]: 
[0m17:59:50.785780 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_transaction_id (models/intermediate/schema.yml)
  Catalog Error: Table with name int_fifo_matched does not exist!
  Did you mean "sqlite_temp_schema"?
  LINE 15: from "thrive"."main"."int_fifo_matched"
                ^
[0m17:59:50.786034 [info ] [MainThread]: 
[0m17:59:50.786248 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:59:50.786679 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.4053051, "process_user_time": 0.750499, "process_kernel_time": 0.068679, "process_mem_max_rss": "251812", "process_out_blocks": "1852", "command_success": false, "process_in_blocks": "0"}
[0m17:59:50.786913 [debug] [MainThread]: Command `dbt test` failed at 17:59:50.786875 after 0.41 seconds
[0m17:59:50.787112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f39250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2e13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2e3d90>]}
[0m17:59:50.787310 [debug] [MainThread]: Flushing usage events
[0m18:00:46.640446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9065cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90628690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9065cfd0>]}


============================== 18:00:46.641869 | 3baf51de-8d3e-4614-ab6d-472be033b36a ==============================
[0m18:00:46.641869 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:00:46.642245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:46.678756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9527eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95248690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95241290>]}


============================== 18:00:46.680132 | fed6280a-1a70-4b6b-b1dc-349069b0d90b ==============================
[0m18:00:46.680132 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:00:46.680509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intermediate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:46.681268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34ce810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3498690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3498c90>]}


============================== 18:00:46.682571 | af83a9a3-1e56-4b40-9845-e8abf2fd7c34 ==============================
[0m18:00:46.682571 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:00:46.685902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:46.695837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fa1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fa8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa31fa90>]}


============================== 18:00:46.697136 | 6d916ead-f821-403e-b9f2-c0082c90a33d ==============================
[0m18:00:46.697136 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:00:46.697982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:46.726210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3baf51de-8d3e-4614-ab6d-472be033b36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906c3fd0>]}
[0m18:00:46.748334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3baf51de-8d3e-4614-ab6d-472be033b36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9066c390>]}
[0m18:00:46.749024 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:00:46.762574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed6280a-1a70-4b6b-b1dc-349069b0d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952d55d0>]}
[0m18:00:46.766855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af83a9a3-1e56-4b40-9845-e8abf2fd7c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3493150>]}
[0m18:00:46.776189 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:00:46.778508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d916ead-f821-403e-b9f2-c0082c90a33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa02f9d0>]}
[0m18:00:46.783069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed6280a-1a70-4b6b-b1dc-349069b0d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9764f810>]}
[0m18:00:46.785034 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:00:46.791283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af83a9a3-1e56-4b40-9845-e8abf2fd7c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58a3350>]}
[0m18:00:46.792029 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:00:46.798319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d916ead-f821-403e-b9f2-c0082c90a33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3af610>]}
[0m18:00:46.799260 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:00:46.815972 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:00:46.823918 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:00:46.829002 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:00:46.832845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:46.834042 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:00:46.879555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:46.881238 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:00:46.882219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:46.882775 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:00:46.895899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:46.896337 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:00:46.920312 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:46.921892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3baf51de-8d3e-4614-ab6d-472be033b36a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dc2450>]}
[0m18:00:46.962498 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:46.962963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fed6280a-1a70-4b6b-b1dc-349069b0d90b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7ae950>]}
[0m18:00:46.963374 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:46.963789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af83a9a3-1e56-4b40-9845-e8abf2fd7c34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aad57d0>]}
[0m18:00:46.979140 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:46.979535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d916ead-f821-403e-b9f2-c0082c90a33d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ff19d0>]}
[0m18:00:46.995430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3baf51de-8d3e-4614-ab6d-472be033b36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878a8950>]}
[0m18:00:47.037263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fed6280a-1a70-4b6b-b1dc-349069b0d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4a39d0>]}
[0m18:00:47.041872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af83a9a3-1e56-4b40-9845-e8abf2fd7c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7a9a90>]}
[0m18:00:47.052506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3baf51de-8d3e-4614-ab6d-472be033b36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d8fd50>]}
[0m18:00:47.052844 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:00:47.053092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3baf51de-8d3e-4614-ab6d-472be033b36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d62190>]}
[0m18:00:47.053947 [info ] [MainThread]: 
[0m18:00:47.054432 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:47.055084 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:00:47.056375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d916ead-f821-403e-b9f2-c0082c90a33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa03e4d0>]}
[0m18:00:47.106281 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:00:47.106596 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:00:47.106893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:47.113961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fed6280a-1a70-4b6b-b1dc-349069b0d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9b7e50>]}
[0m18:00:47.114438 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:00:47.114504 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:00:47.115020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed6280a-1a70-4b6b-b1dc-349069b0d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aad3ad0>]}
[0m18:00:47.116316 [debug] [ThreadPool]: On list_thrive: Close
[0m18:00:47.116921 [info ] [MainThread]: 
[0m18:00:47.117334 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:47.118017 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:00:47.118678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af83a9a3-1e56-4b40-9845-e8abf2fd7c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a883990>]}
[0m18:00:47.119314 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:00:47.119455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:00:47.119907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d916ead-f821-403e-b9f2-c0082c90a33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8384b2d0>]}
[0m18:00:47.119877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af83a9a3-1e56-4b40-9845-e8abf2fd7c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7f22d0>]}
[0m18:00:47.121125 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:00:47.121008 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:00:47.122058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d916ead-f821-403e-b9f2-c0082c90a33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15d2690>]}
[0m18:00:47.122023 [info ] [MainThread]: 
[0m18:00:47.122992 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:47.123033 [info ] [MainThread]: 
[0m18:00:47.123400 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:47.123906 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:00:47.123592 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:00:47.125328 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:00:47.125542 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:00:47.125743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:47.129123 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:00:47.130018 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:00:47.130223 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:00:47.130465 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:47.130632 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:00:47.130791 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:00:47.131310 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:47.131839 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:00:47.132093 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:00:47.132312 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:00:47.132658 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:47.132909 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:00:47.136066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:00:47.139351 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:00:47.139752 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:00:47.139988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:47.143427 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:00:47.143808 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:00:47.144128 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:00:47.152804 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:00:47.153617 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:00:47.154065 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:00:47.154363 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:00:47.156111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3baf51de-8d3e-4614-ab6d-472be033b36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e9af50>]}
[0m18:00:47.156502 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:47.156729 [debug] [MainThread]: On master: BEGIN
[0m18:00:47.156954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:47.160572 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m18:00:47.160844 [debug] [MainThread]: On master: COMMIT
[0m18:00:47.161056 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:47.161273 [debug] [MainThread]: On master: COMMIT
[0m18:00:47.161649 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:47.161954 [debug] [MainThread]: On master: Close
[0m18:00:47.162868 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:47.163106 [info ] [MainThread]: 
[0m18:00:47.164406 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:00:47.164708 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:00:47.165069 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:00:47.165290 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:00:47.168333 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:00:47.168571 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:00:47.168707 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:00:47.169118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:47.169367 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:00:47.171547 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:00:47.171707 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:00:47.171999 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:00:47.172225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:47.171942 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:00:47.172446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:47.174231 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:00:47.174948 [debug] [ThreadPool]: On list_thrive: Close
[0m18:00:47.175004 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:00:47.175256 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:00:47.175882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:47.176090 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:00:47.176337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:00:47.176156 [debug] [MainThread]: Connection 'list_thrive' was properly closed.
[0m18:00:47.176578 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:00:47.177051 [info ] [MainThread]: 
[0m18:00:47.176857 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:00:47.177295 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m18:00:47.177547 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4489). See also https://duckdb.org/docs/connect/concurrency
[0m18:00:47.177972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.52079314, "process_user_time": 0.883829, "process_kernel_time": 0.06558, "process_mem_max_rss": "251620", "process_out_blocks": "1784", "command_success": false, "process_in_blocks": "0"}
[0m18:00:47.178203 [debug] [MainThread]: Command `dbt run` failed at 18:00:47.178166 after 0.52 seconds
[0m18:00:47.178391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34e1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e7a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34e0610>]}
[0m18:00:47.178609 [debug] [MainThread]: Flushing usage events
[0m18:00:47.179738 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:00:47.179922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:47.180054 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:00:47.180206 [debug] [MainThread]: Connection 'list_thrive' was properly closed.
[0m18:00:47.180367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:47.180529 [info ] [MainThread]: 
[0m18:00:47.180888 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m18:00:47.181324 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4489). However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/connect/concurrency
[0m18:00:47.182689 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:00:47.183100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50610876, "process_user_time": 0.883204, "process_kernel_time": 0.064306, "process_mem_max_rss": "252136", "process_out_blocks": "1784", "command_success": false, "process_in_blocks": "0"}
[0m18:00:47.183522 [debug] [MainThread]: Command `dbt run` failed at 18:00:47.183458 after 0.51 seconds
[0m18:00:47.183781 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:00:47.183880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9faab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fab590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83894f50>]}
[0m18:00:47.184125 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:00:47.184199 [debug] [MainThread]: Flushing usage events
[0m18:00:47.184409 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:47.185323 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:00:47.186445 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:00:47.186888 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: BEGIN
[0m18:00:47.186718 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:00:47.187486 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:47.187355 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:00:47.187711 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:00:47.187899 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:00:47.188178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:47.188584 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:00:47.188750 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:00:47.188905 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:00:47.189167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:47.189283 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4489). See also https://duckdb.org/docs/connect/concurrency
[0m18:00:47.189330 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:00:47.190034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3baf51de-8d3e-4614-ab6d-472be033b36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85eabcd0>]}
[0m18:00:47.190459 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.02s]
[0m18:00:47.190775 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:00:47.191716 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:47.191956 [debug] [MainThread]: On master: BEGIN
[0m18:00:47.192161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:47.192387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:00:47.195154 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:00:47.195408 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:00:47.195629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:47.195646 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:00:47.195918 [debug] [MainThread]: On master: COMMIT
[0m18:00:47.196205 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:47.196417 [debug] [MainThread]: On master: COMMIT
[0m18:00:47.196761 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:47.197024 [debug] [MainThread]: On master: Close
[0m18:00:47.197767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:47.198019 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:00:47.198573 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:00:47.198853 [info ] [MainThread]: 
[0m18:00:47.199118 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m18:00:47.199511 [debug] [MainThread]: Command end result
[0m18:00:47.199672 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:00:47.199962 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:00:47.200199 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:00:47.210884 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:00:47.211909 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:00:47.212693 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:00:47.213342 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:00:47.216679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed6280a-1a70-4b6b-b1dc-349069b0d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c492950>]}
[0m18:00:47.217955 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:47.218269 [debug] [MainThread]: On master: BEGIN
[0m18:00:47.218511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:47.218418 [info ] [MainThread]: 
[0m18:00:47.218768 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:00:47.219367 [info ] [MainThread]: 
[0m18:00:47.220689 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4489). See also https://duckdb.org/docs/connect/concurrency
[0m18:00:47.220993 [info ] [MainThread]: 
[0m18:00:47.221586 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:00:47.222338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.601347, "process_user_time": 0.962666, "process_kernel_time": 0.074818, "process_mem_max_rss": "251968", "process_out_blocks": "2675", "command_success": false, "process_in_blocks": "0"}
[0m18:00:47.222628 [debug] [MainThread]: Command `dbt run` failed at 18:00:47.222590 after 0.60 seconds
[0m18:00:47.222877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9062a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90628310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930d5490>]}
[0m18:00:47.223078 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m18:00:47.223111 [debug] [MainThread]: Flushing usage events
[0m18:00:47.223346 [debug] [MainThread]: On master: COMMIT
[0m18:00:47.223579 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:47.223775 [debug] [MainThread]: On master: COMMIT
[0m18:00:47.224126 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:47.224312 [debug] [MainThread]: On master: Close
[0m18:00:47.225843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:47.226143 [info ] [MainThread]: 
[0m18:00:47.228132 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:00:47.228468 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:00:47.228846 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:00:47.229075 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:00:47.232405 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:00:47.233066 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:00:47.246075 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:00:47.246698 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:00:47.246953 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:00:47.247185 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:47.251086 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:00:47.251308 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:00:47.251483 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id:: int as transaction_id,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m18:00:47.259970 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id:: int as transaction_id,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m18:00:47.260242 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:00:47.260514 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:00:47.262238 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:00:47.262528 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:00:47.264351 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id:: int as transaction_id,
      redeem_id::int as redeem_id
  from source_data
      );
    
    ...
                             ^
[0m18:00:47.265037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed6280a-1a70-4b6b-b1dc-349069b0d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ec8050>]}
[0m18:00:47.265355 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.04s]
[0m18:00:47.265681 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:00:47.266595 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:47.266817 [debug] [MainThread]: On master: BEGIN
[0m18:00:47.267001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:47.270219 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:00:47.270458 [debug] [MainThread]: On master: COMMIT
[0m18:00:47.270646 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:47.270823 [debug] [MainThread]: On master: COMMIT
[0m18:00:47.271113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:47.271282 [debug] [MainThread]: On master: Close
[0m18:00:47.272186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:47.272370 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:00:47.272555 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:00:47.272752 [info ] [MainThread]: 
[0m18:00:47.272976 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:00:47.273307 [debug] [MainThread]: Command end result
[0m18:00:47.288610 [info ] [MainThread]: 
[0m18:00:47.288955 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:00:47.289372 [info ] [MainThread]: 
[0m18:00:47.289630 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id:: int as transaction_id,
      redeem_id::int as redeem_id
  from source_data
      );
    
    ...
                             ^
[0m18:00:47.289858 [info ] [MainThread]: 
[0m18:00:47.290083 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:00:47.290507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6339719, "process_user_time": 0.983784, "process_kernel_time": 0.072947, "process_mem_max_rss": "251980", "process_out_blocks": "2680", "command_success": false, "process_in_blocks": "0"}
[0m18:00:47.290734 [debug] [MainThread]: Command `dbt run` failed at 18:00:47.290700 after 0.63 seconds
[0m18:00:47.290942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9524b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e99110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95243f50>]}
[0m18:00:47.291157 [debug] [MainThread]: Flushing usage events
[0m18:01:48.968592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88128ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88540d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8849fad0>]}


============================== 18:01:48.970125 | 7851b5c6-ac2a-417f-9606-4d0a0f18cc3b ==============================
[0m18:01:48.970125 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:01:48.973849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m18:01:48.992001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995b2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bd0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bd29d0>]}


============================== 18:01:48.993386 | 5e435004-2713-4c21-86c4-33f8ec401534 ==============================
[0m18:01:48.993386 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:01:48.993755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:01:49.032907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fbcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fbc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fbff90>]}


============================== 18:01:49.034893 | 1227acd7-025b-4858-be12-3df17d188388 ==============================
[0m18:01:49.034893 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:01:49.035380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:01:49.053158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed0cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecd8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed0e110>]}
[0m18:01:49.054526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7851b5c6-ac2a-417f-9606-4d0a0f18cc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8815e1d0>]}


============================== 18:01:49.054613 | 7432f9b7-825b-4a31-928f-65d914b786c8 ==============================
[0m18:01:49.054613 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:01:49.057859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m18:01:49.073942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e435004-2713-4c21-86c4-33f8ec401534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9032e750>]}
[0m18:01:49.077008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7851b5c6-ac2a-417f-9606-4d0a0f18cc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a533250>]}
[0m18:01:49.077527 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:01:49.093052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e435004-2713-4c21-86c4-33f8ec401534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af8f6d0>]}
[0m18:01:49.093618 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:01:49.105095 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:01:49.118700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1227acd7-025b-4858-be12-3df17d188388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d721d90>]}
[0m18:01:49.122918 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:01:49.135783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7432f9b7-825b-4a31-928f-65d914b786c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee36a10>]}
[0m18:01:49.139079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1227acd7-025b-4858-be12-3df17d188388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8838f490>]}
[0m18:01:49.140985 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:01:49.156854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7432f9b7-825b-4a31-928f-65d914b786c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff910df550>]}
[0m18:01:49.157401 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:01:49.161243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:49.161577 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:49.167980 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:01:49.180056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7851b5c6-ac2a-417f-9606-4d0a0f18cc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f558810>]}
[0m18:01:49.182284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:49.182692 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:49.184312 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:01:49.202605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e435004-2713-4c21-86c4-33f8ec401534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ffb4dd0>]}
[0m18:01:49.223308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:49.223628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:49.236730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7851b5c6-ac2a-417f-9606-4d0a0f18cc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f303fd0>]}
[0m18:01:49.237334 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:01:49.237734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7851b5c6-ac2a-417f-9606-4d0a0f18cc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881bdf90>]}
[0m18:01:49.238730 [info ] [MainThread]: 
[0m18:01:49.239480 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:49.240261 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:01:49.242083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1227acd7-025b-4858-be12-3df17d188388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3b63d0>]}
[0m18:01:49.244467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:49.244903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:49.256497 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:01:49.256835 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:01:49.257439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:49.265358 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:01:49.266369 [debug] [ThreadPool]: On list_thrive: Close
[0m18:01:49.267925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:01:49.268286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7432f9b7-825b-4a31-928f-65d914b786c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff860cefd0>]}
[0m18:01:49.269132 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:01:49.272848 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:01:49.273105 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:01:49.273534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:49.276791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e435004-2713-4c21-86c4-33f8ec401534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd51c50>]}
[0m18:01:49.277179 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:01:49.277407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e435004-2713-4c21-86c4-33f8ec401534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c2c1d0>]}
[0m18:01:49.278238 [info ] [MainThread]: 
[0m18:01:49.278272 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:01:49.278570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:49.279154 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:01:49.279304 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:01:49.280177 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:01:49.280781 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:49.281456 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:01:49.281782 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:01:49.282311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:49.283009 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:01:49.283339 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:01:49.283589 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:01:49.284174 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:49.284472 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:01:49.288229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:01:49.290669 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:01:49.291839 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:01:49.292842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:49.292849 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:01:49.294063 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:01:49.294724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:49.297121 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:01:49.297605 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:01:49.297379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1227acd7-025b-4858-be12-3df17d188388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d156090>]}
[0m18:01:49.297794 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:01:49.298086 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:01:49.298528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1227acd7-025b-4858-be12-3df17d188388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d4f5350>]}
[0m18:01:49.298790 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:01:49.299061 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:01:49.299558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:49.299780 [debug] [MainThread]: Connection 'list_thrive' was properly closed.
[0m18:01:49.299984 [info ] [MainThread]: 
[0m18:01:49.300243 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m18:01:49.300604 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4893). See also https://duckdb.org/docs/connect/concurrency
[0m18:01:49.300705 [info ] [MainThread]: 
[0m18:01:49.301175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3323916, "process_user_time": 0.724035, "process_kernel_time": 0.043121, "process_mem_max_rss": "251880", "process_out_blocks": "921", "command_success": false, "process_in_blocks": "0"}
[0m18:01:49.301564 [debug] [MainThread]: Command `dbt run` failed at 18:01:49.301491 after 0.33 seconds
[0m18:01:49.301827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b88310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b8a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd83910>]}
[0m18:01:49.301685 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:49.302058 [debug] [MainThread]: Flushing usage events
[0m18:01:49.302795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:01:49.312364 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m18:01:49.313159 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:01:49.313522 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:01:49.313686 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:01:49.315180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7851b5c6-ac2a-417f-9606-4d0a0f18cc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6ad410>]}
[0m18:01:49.315542 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:49.316183 [debug] [MainThread]: On master: BEGIN
[0m18:01:49.316471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:49.317601 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:01:49.316856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7432f9b7-825b-4a31-928f-65d914b786c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8623c1d0>]}
[0m18:01:49.318232 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:01:49.317998 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:01:49.318642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7432f9b7-825b-4a31-928f-65d914b786c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8621f810>]}
[0m18:01:49.318868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:49.319786 [info ] [MainThread]: 
[0m18:01:49.320482 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:49.321135 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:01:49.322190 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m18:01:49.322463 [debug] [MainThread]: On master: COMMIT
[0m18:01:49.322716 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:49.322784 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:01:49.322969 [debug] [MainThread]: On master: COMMIT
[0m18:01:49.323015 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:01:49.323325 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:49.323504 [debug] [MainThread]: On master: Close
[0m18:01:49.323477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:49.323696 [debug] [MainThread]: Connection 'list_thrive' was properly closed.
[0m18:01:49.324396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:49.324673 [info ] [MainThread]: 
[0m18:01:49.324775 [info ] [MainThread]: 
[0m18:01:49.325034 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m18:01:49.325985 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4893). See also https://duckdb.org/docs/connect/concurrency
[0m18:01:49.326452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3132807, "process_user_time": 0.718417, "process_kernel_time": 0.05441, "process_mem_max_rss": "251600", "process_out_blocks": "921", "command_success": false, "process_in_blocks": "0"}
[0m18:01:49.326809 [debug] [MainThread]: Command `dbt run` failed at 18:01:49.326709 after 0.31 seconds
[0m18:01:49.327135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86192750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d18a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d185210>]}
[0m18:01:49.327079 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:01:49.327370 [debug] [MainThread]: Flushing usage events
[0m18:01:49.327459 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:01:49.327823 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:01:49.328080 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:01:49.331439 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:01:49.332207 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:01:49.335749 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:01:49.336844 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:01:49.337897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:49.345339 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m18:01:49.346032 [debug] [ThreadPool]: On list_thrive: Close
[0m18:01:49.347737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:01:49.347795 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:01:49.348092 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:01:49.351056 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:01:49.351081 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:01:49.351344 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:01:49.351507 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:01:49.351703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:49.351915 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:49.354623 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:01:49.355721 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:01:49.356174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:49.356182 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:01:49.356382 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m18:01:49.356567 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:01:49.356979 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id:: int as transaction_id,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m18:01:49.356775 [info ] [MainThread]: 
[0m18:01:49.358016 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m18:01:49.359076 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 4893). See also https://duckdb.org/docs/connect/concurrency
[0m18:01:49.359639 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.32826, "process_user_time": 0.732146, "process_kernel_time": 0.044129, "process_mem_max_rss": "251904", "process_out_blocks": "923", "command_success": false, "process_in_blocks": "0"}
[0m18:01:49.360892 [debug] [MainThread]: Command `dbt run` failed at 18:01:49.360846 after 0.33 seconds
[0m18:01:49.361092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecdaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecdb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939291d0>]}
[0m18:01:49.361283 [debug] [MainThread]: Flushing usage events
[0m18:01:49.366490 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id:: int as transaction_id,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m18:01:49.366782 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:01:49.367060 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:01:49.368350 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:01:49.368593 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:01:49.370390 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id:: int as transaction_id,
      redeem_id::int as redeem_id
  from source_data
      );
    
    ...
                             ^
[0m18:01:49.371082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7851b5c6-ac2a-417f-9606-4d0a0f18cc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e820950>]}
[0m18:01:49.371398 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.04s]
[0m18:01:49.371709 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:01:49.372586 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:49.372802 [debug] [MainThread]: On master: BEGIN
[0m18:01:49.373016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:49.376618 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m18:01:49.376885 [debug] [MainThread]: On master: COMMIT
[0m18:01:49.377134 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:49.377329 [debug] [MainThread]: On master: COMMIT
[0m18:01:49.377633 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:49.377867 [debug] [MainThread]: On master: Close
[0m18:01:49.378652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:49.378858 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:01:49.379059 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:01:49.379263 [info ] [MainThread]: 
[0m18:01:49.379500 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m18:01:49.379869 [debug] [MainThread]: Command end result
[0m18:01:49.394452 [info ] [MainThread]: 
[0m18:01:49.394718 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:01:49.394936 [info ] [MainThread]: 
[0m18:01:49.395333 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id:: int as transaction_id,
      redeem_id::int as redeem_id
  from source_data
      );
    
    ...
                             ^
[0m18:01:49.395577 [info ] [MainThread]: 
[0m18:01:49.395760 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:01:49.396178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.44694418, "process_user_time": 0.798047, "process_kernel_time": 0.073837, "process_mem_max_rss": "251844", "process_out_blocks": "1817", "command_success": false, "process_in_blocks": "0"}
[0m18:01:49.396420 [debug] [MainThread]: Command `dbt run` failed at 18:01:49.396383 after 0.45 seconds
[0m18:01:49.396631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8812aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88128810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd79110>]}
[0m18:01:49.396821 [debug] [MainThread]: Flushing usage events
[0m18:02:51.303807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb51ab150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5188690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb518b010>]}


============================== 18:02:51.305083 | ec7a5ccb-3d16-4461-a9c6-94456e3351b6 ==============================
[0m18:02:51.305083 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:02:51.305385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:02:51.359477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a4e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a18690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a5ff90>]}


============================== 18:02:51.360871 | 49a232a9-be8e-477e-8164-147730a8d336 ==============================
[0m18:02:51.360871 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:02:51.361268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intermediate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:02:51.367242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98741b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9877e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98748f10>]}


============================== 18:02:51.368572 | 46f2cfac-86b3-4a27-90e1-e1ff4e176bdc ==============================
[0m18:02:51.368572 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:02:51.368942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:02:51.370114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31feed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31c8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31fccd0>]}


============================== 18:02:51.374299 | 99c6a4da-cf9a-4471-9608-22390fb96911 ==============================
[0m18:02:51.374299 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:02:51.374768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:02:51.384228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec7a5ccb-3d16-4461-a9c6-94456e3351b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb522a310>]}
[0m18:02:51.406392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec7a5ccb-3d16-4461-a9c6-94456e3351b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb51cc390>]}
[0m18:02:51.409195 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:02:51.438865 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:02:51.445613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49a232a9-be8e-477e-8164-147730a8d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a9fa50>]}
[0m18:02:51.445880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46f2cfac-86b3-4a27-90e1-e1ff4e176bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987d7b10>]}
[0m18:02:51.458476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99c6a4da-cf9a-4471-9608-22390fb96911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa326a7d0>]}
[0m18:02:51.465763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49a232a9-be8e-477e-8164-147730a8d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a5c390>]}
[0m18:02:51.466384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46f2cfac-86b3-4a27-90e1-e1ff4e176bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab4f310>]}
[0m18:02:51.467201 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:02:51.467589 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:02:51.477374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99c6a4da-cf9a-4471-9608-22390fb96911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55cfed0>]}
[0m18:02:51.477888 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:02:51.491134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:02:51.491473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:02:51.498968 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:02:51.499641 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:02:51.507318 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:02:51.509313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec7a5ccb-3d16-4461-a9c6-94456e3351b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5c4a10>]}
[0m18:02:51.557040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:02:51.558747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:02:51.565047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:02:51.565458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:02:51.568573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:02:51.569014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:02:51.575779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec7a5ccb-3d16-4461-a9c6-94456e3351b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac353b50>]}
[0m18:02:51.576688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49a232a9-be8e-477e-8164-147730a8d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e16d210>]}
[0m18:02:51.577840 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:02:51.578251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7a5ccb-3d16-4461-a9c6-94456e3351b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac70da50>]}
[0m18:02:51.579094 [info ] [MainThread]: 
[0m18:02:51.579584 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:02:51.580119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:02:51.583836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46f2cfac-86b3-4a27-90e1-e1ff4e176bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb74a10>]}
[0m18:02:51.592705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99c6a4da-cf9a-4471-9608-22390fb96911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9af1d0>]}
[0m18:02:51.594176 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:02:51.594489 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:02:51.594738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:51.599432 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:02:51.600127 [debug] [ThreadPool]: On list_thrive: Close
[0m18:02:51.601093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:02:51.601382 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:02:51.604296 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:02:51.604590 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:02:51.604817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:51.608818 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:02:51.609802 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:02:51.610180 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:02:51.610659 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:51.611043 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:02:51.611406 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:02:51.611933 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:51.612580 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:02:51.612938 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:02:51.613238 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:02:51.613828 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:51.614273 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:02:51.617614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:02:51.620213 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:02:51.620492 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:02:51.620740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:51.624286 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:02:51.624567 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:02:51.624805 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:02:51.633815 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:02:51.634443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49a232a9-be8e-477e-8164-147730a8d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ab0610>]}
[0m18:02:51.634801 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:02:51.635108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a232a9-be8e-477e-8164-147730a8d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ab06d0>]}
[0m18:02:51.635984 [info ] [MainThread]: 
[0m18:02:51.636363 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:02:51.635831 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:02:51.636924 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:02:51.636988 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:02:51.639001 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:02:51.641394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7a5ccb-3d16-4461-a9c6-94456e3351b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac343590>]}
[0m18:02:51.641727 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:51.642252 [debug] [MainThread]: On master: BEGIN
[0m18:02:51.642622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:51.642985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46f2cfac-86b3-4a27-90e1-e1ff4e176bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f923fd0>]}
[0m18:02:51.643443 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:02:51.643832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f2cfac-86b3-4a27-90e1-e1ff4e176bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8faab150>]}
[0m18:02:51.644731 [info ] [MainThread]: 
[0m18:02:51.646366 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:02:51.647669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:02:51.650368 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m18:02:51.651038 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:02:51.651195 [debug] [MainThread]: On master: COMMIT
[0m18:02:51.651534 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:51.651376 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:02:51.653242 [debug] [MainThread]: On master: COMMIT
[0m18:02:51.654063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:51.654362 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:51.655873 [debug] [MainThread]: On master: Close
[0m18:02:51.657089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99c6a4da-cf9a-4471-9608-22390fb96911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3a3f90>]}
[0m18:02:51.658052 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:51.658359 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:02:51.658471 [info ] [MainThread]: 
[0m18:02:51.658716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99c6a4da-cf9a-4471-9608-22390fb96911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a72d350>]}
[0m18:02:51.660056 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:02:51.660440 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:02:51.660811 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:02:51.661029 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:02:51.660991 [info ] [MainThread]: 
[0m18:02:51.662202 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:02:51.662332 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:02:51.662353 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:02:51.662601 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:02:51.662835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:51.662989 [debug] [ThreadPool]: On list_thrive: Close
[0m18:02:51.663112 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:02:51.664126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:02:51.664227 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:02:51.664415 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:02:51.665399 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:02:51.670191 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:02:51.670708 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:02:51.670728 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:02:51.671007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:51.671618 [debug] [ThreadPool]: On list_thrive: Close
[0m18:02:51.673745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:02:51.674169 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:02:51.676912 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:02:51.677240 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:02:51.677181 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:02:51.677507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:51.678333 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:02:51.678477 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:02:51.678571 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:02:51.678807 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:02:51.679002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:51.679343 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:51.679683 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:02:51.680067 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:02:51.680289 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:02:51.680314 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:02:51.680779 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:51.680779 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:02:51.681526 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:02:51.681730 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:02:51.681824 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:02:51.682188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:51.682239 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:02:51.682197 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:02:51.682427 [debug] [MainThread]: Connection 'list_thrive' was properly closed.
[0m18:02:51.682592 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:02:51.682724 [info ] [MainThread]: 
[0m18:02:51.683043 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m18:02:51.683382 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 5204). See also https://duckdb.org/docs/connect/concurrency
[0m18:02:51.683072 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:02:51.683860 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:02:51.683238 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:51.684374 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:02:51.684429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:51.684250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34001124, "process_user_time": 0.718142, "process_kernel_time": 0.052228, "process_mem_max_rss": "251824", "process_out_blocks": "921", "command_success": false, "process_in_blocks": "0"}
[0m18:02:51.684700 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m18:02:51.684938 [info ] [MainThread]: 
[0m18:02:51.685183 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m18:02:51.685444 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 5204). See also https://duckdb.org/docs/connect/concurrency
[0m18:02:51.685161 [debug] [MainThread]: Command `dbt run` failed at 18:02:51.684800 after 0.34 seconds
[0m18:02:51.686470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.341746, "process_user_time": 0.710641, "process_kernel_time": 0.062231, "process_mem_max_rss": "251956", "process_out_blocks": "923", "command_success": false, "process_in_blocks": "0"}
[0m18:02:51.686506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31cac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31c8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7f6490>]}
[0m18:02:51.686808 [debug] [MainThread]: Command `dbt run` failed at 18:02:51.686766 after 0.34 seconds
[0m18:02:51.686860 [debug] [MainThread]: Flushing usage events
[0m18:02:51.687153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9874acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9874af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcc5b50>]}
[0m18:02:51.687446 [debug] [MainThread]: Flushing usage events
[0m18:02:51.688647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:02:51.688772 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:02:51.689076 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:02:51.689367 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id:: int as transaction_id,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m18:02:51.691278 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:02:51.691517 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:02:51.691687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:51.693997 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m18:02:51.694266 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:02:51.694697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:51.694906 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:02:51.695191 [info ] [MainThread]: 
[0m18:02:51.695438 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m18:02:51.695725 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/thrive.duckdb": Conflicting lock is held in /usr/python/bin/python3.11 (PID 5170). See also https://duckdb.org/docs/connect/concurrency
[0m18:02:51.696220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3602555, "process_user_time": 0.735072, "process_kernel_time": 0.059491, "process_mem_max_rss": "251756", "process_out_blocks": "926", "command_success": false, "process_in_blocks": "0"}
[0m18:02:51.696515 [debug] [MainThread]: Command `dbt run` failed at 18:02:51.696474 after 0.36 seconds
[0m18:02:51.696748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a1a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a1ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b669110>]}
[0m18:02:51.696989 [debug] [MainThread]: Flushing usage events
[0m18:02:51.698132 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id:: int as transaction_id,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m18:02:51.698486 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:02:51.699029 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:02:51.700482 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:02:51.700745 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:02:51.702736 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id:: int as transaction_id,
      redeem_id::int as redeem_id
  from source_data
      );
    
    ...
                             ^
[0m18:02:51.703461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec7a5ccb-3d16-4461-a9c6-94456e3351b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb521cf50>]}
[0m18:02:51.703779 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.04s]
[0m18:02:51.704141 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:02:51.705067 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:51.705290 [debug] [MainThread]: On master: BEGIN
[0m18:02:51.705484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:51.708857 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:02:51.709135 [debug] [MainThread]: On master: COMMIT
[0m18:02:51.709342 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:51.709516 [debug] [MainThread]: On master: COMMIT
[0m18:02:51.709870 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:51.710109 [debug] [MainThread]: On master: Close
[0m18:02:51.710818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:51.711023 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:02:51.711192 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:02:51.711377 [info ] [MainThread]: 
[0m18:02:51.711625 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m18:02:51.711969 [debug] [MainThread]: Command end result
[0m18:02:51.725942 [info ] [MainThread]: 
[0m18:02:51.726219 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:51.726446 [info ] [MainThread]: 
[0m18:02:51.726750 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id:: int as transaction_id,
      redeem_id::int as redeem_id
  from source_data
      );
    
    ...
                             ^
[0m18:02:51.726969 [info ] [MainThread]: 
[0m18:02:51.727167 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:02:51.727609 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4426012, "process_user_time": 0.797415, "process_kernel_time": 0.071126, "process_mem_max_rss": "251880", "process_out_blocks": "1817", "command_success": false, "process_in_blocks": "0"}
[0m18:02:51.727865 [debug] [MainThread]: Command `dbt run` failed at 18:02:51.727827 after 0.44 seconds
[0m18:02:51.728067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5188650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75a9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9dd91d0>]}
[0m18:02:51.728255 [debug] [MainThread]: Flushing usage events
[0m18:04:12.341369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef4ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef4dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef4d7d0>]}


============================== 18:04:12.342612 | 2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54 ==============================
[0m18:04:12.342612 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:04:12.342948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:04:12.411565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef9fa10>]}
[0m18:04:12.428747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81323190>]}
[0m18:04:12.429188 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:04:12.453840 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:04:12.497879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:04:12.498255 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/schema.yml
[0m18:04:12.498496 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:04:12.569171 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:04:12.569525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7647ed90>]}
[0m18:04:12.628921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff762b96d0>]}
[0m18:04:12.669574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74883e50>]}
[0m18:04:12.669876 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:04:12.670097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff760fee90>]}
[0m18:04:12.671083 [info ] [MainThread]: 
[0m18:04:12.671458 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:12.673556 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:04:12.719934 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:04:12.720426 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:04:12.720711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:12.725798 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:04:12.726565 [debug] [ThreadPool]: On list_thrive: Close
[0m18:04:12.727701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:04:12.728098 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:04:12.731255 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:04:12.731533 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:04:12.731726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:12.735647 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:04:12.736421 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:04:12.736698 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:04:12.737115 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:12.737361 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:04:12.737572 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:04:12.737929 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:12.738402 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:04:12.738597 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:04:12.738780 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:04:12.739167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:12.739412 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:04:12.740704 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:04:12.743117 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:04:12.743332 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:04:12.743509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:12.746889 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:04:12.747125 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:04:12.747306 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:04:12.755772 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:04:12.756637 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:04:12.757102 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:04:12.757364 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:04:12.759045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fefca10>]}
[0m18:04:12.759334 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:12.759524 [debug] [MainThread]: On master: BEGIN
[0m18:04:12.759704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:12.763553 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m18:04:12.763811 [debug] [MainThread]: On master: COMMIT
[0m18:04:12.764015 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:12.764340 [debug] [MainThread]: On master: COMMIT
[0m18:04:12.764675 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:12.764901 [debug] [MainThread]: On master: Close
[0m18:04:12.765805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:12.766112 [info ] [MainThread]: 
[0m18:04:12.767554 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m18:04:12.767862 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m18:04:12.768193 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m18:04:12.768424 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m18:04:12.771612 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m18:04:12.772262 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m18:04:12.784665 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m18:04:12.785368 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:04:12.785608 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m18:04:12.785817 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:12.789496 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:04:12.789730 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:04:12.789921 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m18:04:12.790284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.792969 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:04:12.793168 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:04:12.793459 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.794518 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:04:12.794720 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:04:12.795063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.802213 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:04:12.802507 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:04:12.802729 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:04:12.803565 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:12.805725 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:04:12.805906 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m18:04:12.806344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.807458 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m18:04:12.809790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd86a50>]}
[0m18:04:12.810161 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m18:04:12.810506 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m18:04:12.810742 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m18:04:12.811010 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m18:04:12.811275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m18:04:12.811453 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m18:04:12.812670 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m18:04:12.813085 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m18:04:12.814610 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m18:04:12.815171 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:04:12.815556 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m18:04:12.815746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:12.818991 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:12.819240 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:04:12.819441 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m18:04:12.819804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.821167 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:04:12.821332 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m18:04:12.821594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.822704 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:04:12.822864 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m18:04:12.823130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.823752 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:04:12.823925 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:04:12.824088 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:04:12.824664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.825585 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:04:12.825748 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m18:04:12.826136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.826870 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m18:04:12.828623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fec1310>]}
[0m18:04:12.828964 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m18:04:12.829273 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m18:04:12.829479 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m18:04:12.829720 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m18:04:12.829966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m18:04:12.830170 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m18:04:12.831341 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m18:04:12.831769 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m18:04:12.833114 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m18:04:12.833476 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:04:12.833640 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m18:04:12.833797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:12.836963 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:12.837221 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:04:12.837435 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m18:04:12.837891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.839235 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:04:12.839505 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m18:04:12.840065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.841334 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:04:12.841528 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m18:04:12.841809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.842478 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:04:12.842646 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:04:12.842787 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:04:12.843402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.844311 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:04:12.844518 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m18:04:12.844913 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:12.845466 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m18:04:12.847101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc7f8ca-3f34-4b4a-ab8c-2192eb02fa54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6feccd50>]}
[0m18:04:12.847456 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m18:04:12.847739 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m18:04:12.848439 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:12.848639 [debug] [MainThread]: On master: BEGIN
[0m18:04:12.848809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:12.852012 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:04:12.852236 [debug] [MainThread]: On master: COMMIT
[0m18:04:12.852418 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:12.852566 [debug] [MainThread]: On master: COMMIT
[0m18:04:12.852795 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:12.852998 [debug] [MainThread]: On master: Close
[0m18:04:12.853782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:12.854006 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m18:04:12.854191 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:04:12.854351 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m18:04:12.854558 [info ] [MainThread]: 
[0m18:04:12.854832 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m18:04:12.855524 [debug] [MainThread]: Command end result
[0m18:04:12.870514 [info ] [MainThread]: 
[0m18:04:12.870768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:12.870957 [info ] [MainThread]: 
[0m18:04:12.871198 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:04:12.871826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.547049, "process_user_time": 0.89874, "process_kernel_time": 0.076746, "process_mem_max_rss": "252040", "process_out_blocks": "4270", "process_in_blocks": "0"}
[0m18:04:12.872136 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:12.872067 after 0.55 seconds
[0m18:04:12.872353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f122750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef13f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef13e90>]}
[0m18:04:12.872544 [debug] [MainThread]: Flushing usage events
[0m18:04:14.812497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c118ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c118690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c118c10>]}


============================== 18:04:14.813839 | eb37b7e4-48b9-4db2-b996-7fb59f2c1f18 ==============================
[0m18:04:14.813839 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:04:14.814273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:04:14.884646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb37b7e4-48b9-4db2-b996-7fb59f2c1f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1a59d0>]}
[0m18:04:14.902442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb37b7e4-48b9-4db2-b996-7fb59f2c1f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c15c390>]}
[0m18:04:14.902941 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:04:14.928396 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:04:14.972620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:14.972897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:14.989253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb37b7e4-48b9-4db2-b996-7fb59f2c1f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93544a10>]}
[0m18:04:15.030678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb37b7e4-48b9-4db2-b996-7fb59f2c1f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932f7fd0>]}
[0m18:04:15.030994 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:04:15.031355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb37b7e4-48b9-4db2-b996-7fb59f2c1f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9347b150>]}
[0m18:04:15.032108 [info ] [MainThread]: 
[0m18:04:15.032455 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:15.032942 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:04:15.045808 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:04:15.046078 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:04:15.046291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:15.050279 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:04:15.050820 [debug] [ThreadPool]: On list_thrive: Close
[0m18:04:15.051689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:04:15.051947 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:04:15.054452 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:04:15.054635 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:04:15.054803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:15.057548 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:04:15.058077 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:04:15.058265 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:04:15.058547 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:15.058722 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:04:15.058889 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:04:15.059162 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:15.059574 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:04:15.059763 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:04:15.059929 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:04:15.060286 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:15.060610 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:04:15.063268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:04:15.065281 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:04:15.065454 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:04:15.065614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:15.068160 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:04:15.068337 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:04:15.068503 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:04:15.076344 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:04:15.076900 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:04:15.077248 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:04:15.077453 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:04:15.080242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb37b7e4-48b9-4db2-b996-7fb59f2c1f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c161d50>]}
[0m18:04:15.080492 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:15.080671 [debug] [MainThread]: On master: BEGIN
[0m18:04:15.080838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:15.084280 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:04:15.084483 [debug] [MainThread]: On master: COMMIT
[0m18:04:15.084658 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:15.084833 [debug] [MainThread]: On master: COMMIT
[0m18:04:15.085195 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:15.085384 [debug] [MainThread]: On master: Close
[0m18:04:15.086137 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:15.086347 [info ] [MainThread]: 
[0m18:04:15.087549 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:04:15.087831 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:04:15.088135 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:04:15.088348 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:04:15.091213 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:04:15.091714 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:04:15.103508 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:04:15.104305 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:04:15.104496 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:04:15.104688 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:15.107568 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:15.107793 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:04:15.107966 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:04:15.114664 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:04:15.114881 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:04:15.115125 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:04:15.116723 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:04:15.116939 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:04:15.118998 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id::int as trans_id,
      tctype,
      createdat,
      customer_id as customerid,
      amount,
      redeem_id::int as redeemid
  from source_data
      );
    
    ...
                             ^
[0m18:04:15.119906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb37b7e4-48b9-4db2-b996-7fb59f2c1f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9381af90>]}
[0m18:04:15.120240 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.03s]
[0m18:04:15.120554 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:04:15.121500 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:15.121744 [debug] [MainThread]: On master: BEGIN
[0m18:04:15.121936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:15.124840 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:04:15.125040 [debug] [MainThread]: On master: COMMIT
[0m18:04:15.125214 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:15.125393 [debug] [MainThread]: On master: COMMIT
[0m18:04:15.125640 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:15.125818 [debug] [MainThread]: On master: Close
[0m18:04:15.126562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:15.126737 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:04:15.126892 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:04:15.127076 [info ] [MainThread]: 
[0m18:04:15.127287 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:04:15.127635 [debug] [MainThread]: Command end result
[0m18:04:15.141226 [info ] [MainThread]: 
[0m18:04:15.141455 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:04:15.141618 [info ] [MainThread]: 
[0m18:04:15.141805 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id::int as trans_id,
      tctype,
      createdat,
      customer_id as customerid,
      amount,
      redeem_id::int as redeemid
  from source_data
      );
    
    ...
                             ^
[0m18:04:15.141966 [info ] [MainThread]: 
[0m18:04:15.142135 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:04:15.142689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34795117, "process_user_time": 0.745372, "process_kernel_time": 0.059995, "process_mem_max_rss": "252096", "process_out_blocks": "1815", "command_success": false, "process_in_blocks": "0"}
[0m18:04:15.142928 [debug] [MainThread]: Command `dbt run` failed at 18:04:15.142894 after 0.35 seconds
[0m18:04:15.143123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c11a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c11b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d69110>]}
[0m18:04:15.143344 [debug] [MainThread]: Flushing usage events
[0m18:05:16.394829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d17cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d148690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d356b10>]}


============================== 18:05:16.395956 | 10151eac-87a0-426b-8791-fe86469dceb9 ==============================
[0m18:05:16.395956 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:05:16.396408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:05:16.470474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10151eac-87a0-426b-8791-fe86469dceb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff748f3c10>]}
[0m18:05:16.487864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10151eac-87a0-426b-8791-fe86469dceb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f553410>]}
[0m18:05:16.488264 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:05:16.512086 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:05:16.556054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:05:16.556314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:05:16.572122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10151eac-87a0-426b-8791-fe86469dceb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d18c610>]}
[0m18:05:16.612624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10151eac-87a0-426b-8791-fe86469dceb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74327f10>]}
[0m18:05:16.612893 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:05:16.613179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10151eac-87a0-426b-8791-fe86469dceb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff744a1dd0>]}
[0m18:05:16.613882 [info ] [MainThread]: 
[0m18:05:16.614196 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:05:16.614678 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:05:16.627703 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:05:16.627936 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:05:16.628166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:16.632892 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:05:16.633556 [debug] [ThreadPool]: On list_thrive: Close
[0m18:05:16.634670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:05:16.634945 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:05:16.638076 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:05:16.638306 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:05:16.638529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:16.641524 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:05:16.642148 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:05:16.642316 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:05:16.642559 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:16.642717 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:05:16.642866 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:05:16.643121 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:16.643557 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:05:16.643728 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:05:16.643869 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:05:16.644092 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:16.644256 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:05:16.646930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:05:16.648962 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:05:16.649153 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:05:16.649338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:16.652227 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:05:16.652427 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:05:16.652633 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:05:16.660986 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:05:16.661581 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:05:16.661918 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:05:16.662089 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:05:16.663616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10151eac-87a0-426b-8791-fe86469dceb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74659190>]}
[0m18:05:16.663891 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:16.664071 [debug] [MainThread]: On master: BEGIN
[0m18:05:16.664244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:16.667348 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:05:16.667560 [debug] [MainThread]: On master: COMMIT
[0m18:05:16.667739 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:16.667902 [debug] [MainThread]: On master: COMMIT
[0m18:05:16.668340 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:16.668650 [debug] [MainThread]: On master: Close
[0m18:05:16.669491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:16.669770 [info ] [MainThread]: 
[0m18:05:16.670999 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:05:16.671315 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:05:16.671626 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:05:16.671821 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:05:16.674767 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:05:16.675301 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:05:16.687713 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:05:16.688307 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:05:16.688529 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:05:16.688723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:05:16.692200 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:05:16.692440 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:05:16.692633 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:05:16.699877 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."python_layer"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:05:16.700097 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:05:16.700358 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:05:16.701700 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:05:16.701907 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:05:16.703558 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id::int as trans_id,
      tctype,
      createdat,
      customer_id as customerid,
      amount,
      redeem_id::int as redeemid
  from source_data
      );
    
    ...
                             ^
[0m18:05:16.704172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10151eac-87a0-426b-8791-fe86469dceb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff739eb290>]}
[0m18:05:16.704503 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.03s]
[0m18:05:16.704822 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:05:16.705681 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:16.705872 [debug] [MainThread]: On master: BEGIN
[0m18:05:16.706041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:16.708883 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:05:16.709076 [debug] [MainThread]: On master: COMMIT
[0m18:05:16.709248 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:16.709436 [debug] [MainThread]: On master: COMMIT
[0m18:05:16.709694 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:16.709871 [debug] [MainThread]: On master: Close
[0m18:05:16.710588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:16.710766 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:05:16.710929 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:05:16.711111 [info ] [MainThread]: 
[0m18:05:16.711340 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:05:16.711670 [debug] [MainThread]: Command end result
[0m18:05:16.725256 [info ] [MainThread]: 
[0m18:05:16.725499 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:05:16.725718 [info ] [MainThread]: 
[0m18:05:16.725949 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Catalog Error: Table with name python_fifo_output does not exist!
  Did you mean "thrive.python_fifo_output"?
  LINE 12:     select * from "thrive"."python_layer"."python_fifo_output"
  )
  
  select
      transaction_id::int as trans_id,
      tctype,
      createdat,
      customer_id as customerid,
      amount,
      redeem_id::int as redeemid
  from source_data
      );
    
    ...
                             ^
[0m18:05:16.726136 [info ] [MainThread]: 
[0m18:05:16.726396 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:05:16.727003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34873432, "process_user_time": 0.693008, "process_kernel_time": 0.070796, "process_mem_max_rss": "252060", "process_out_blocks": "1815", "command_success": false, "process_in_blocks": "0"}
[0m18:05:16.727254 [debug] [MainThread]: Command `dbt run` failed at 18:05:16.727206 after 0.35 seconds
[0m18:05:16.727494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d14ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d148810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d99110>]}
[0m18:05:16.727697 [debug] [MainThread]: Flushing usage events
[0m18:06:18.527287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aeecb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aeecc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aeb1790>]}


============================== 18:06:18.528406 | 54ea6661-b1c3-48fe-be7d-fb969b88b275 ==============================
[0m18:06:18.528406 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:06:18.528753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intermediate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:18.596387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54ea6661-b1c3-48fe-be7d-fb969b88b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af3fb90>]}
[0m18:06:18.613206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54ea6661-b1c3-48fe-be7d-fb969b88b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2c3390>]}
[0m18:06:18.613551 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:06:18.637793 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:06:18.681043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:18.681428 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/sources.yml
[0m18:06:18.771059 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:06:18.771515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '54ea6661-b1c3-48fe-be7d-fb969b88b275', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82423c50>]}
[0m18:06:18.870758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54ea6661-b1c3-48fe-be7d-fb969b88b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80974190>]}
[0m18:06:18.942631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54ea6661-b1c3-48fe-be7d-fb969b88b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821241d0>]}
[0m18:06:18.942979 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:06:18.943219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54ea6661-b1c3-48fe-be7d-fb969b88b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80870ed0>]}
[0m18:06:18.943972 [info ] [MainThread]: 
[0m18:06:18.944342 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:18.944899 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:06:18.957795 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:06:18.958076 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:06:18.958267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:18.962640 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:06:18.963246 [debug] [ThreadPool]: On list_thrive: Close
[0m18:06:18.964269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:06:18.964531 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:06:18.967101 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:18.967299 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:06:18.967477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:18.970677 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:06:18.971278 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:18.971465 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:06:18.971734 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:18.971918 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:18.972131 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:06:18.972458 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:18.972896 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:06:18.973077 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:18.973241 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:06:18.973639 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:18.973911 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:06:18.976578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:06:18.978745 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:06:18.978930 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:06:18.979113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:18.982192 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:06:18.982451 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:06:18.982655 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:06:18.990914 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:06:18.991597 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:06:18.991990 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:06:18.992176 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:06:18.993535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54ea6661-b1c3-48fe-be7d-fb969b88b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806162d0>]}
[0m18:06:18.993800 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:18.994001 [debug] [MainThread]: On master: BEGIN
[0m18:06:18.994169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:18.997347 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:06:18.997612 [debug] [MainThread]: On master: COMMIT
[0m18:06:18.997868 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:18.998091 [debug] [MainThread]: On master: COMMIT
[0m18:06:18.998445 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:18.998681 [debug] [MainThread]: On master: Close
[0m18:06:18.999604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:18.999903 [info ] [MainThread]: 
[0m18:06:19.001254 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:06:19.001537 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:06:19.001853 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:06:19.002057 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:06:19.005007 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:06:19.005542 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:06:19.017966 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:06:19.018501 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:06:19.018700 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:06:19.018907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:19.022354 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:06:19.022575 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:06:19.022804 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:06:19.023296 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:06:19.023468 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:06:19.023681 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:06:19.025082 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:06:19.025255 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:06:19.026630 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "tctype" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     tctype,
               ^
[0m18:06:19.027319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ea6661-b1c3-48fe-be7d-fb969b88b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804d96d0>]}
[0m18:06:19.027611 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.03s]
[0m18:06:19.027903 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:06:19.028786 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:19.029004 [debug] [MainThread]: On master: BEGIN
[0m18:06:19.029265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:19.032567 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:06:19.032800 [debug] [MainThread]: On master: COMMIT
[0m18:06:19.032992 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:19.033163 [debug] [MainThread]: On master: COMMIT
[0m18:06:19.033403 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:19.033582 [debug] [MainThread]: On master: Close
[0m18:06:19.034408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:19.034635 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:06:19.034829 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:06:19.035043 [info ] [MainThread]: 
[0m18:06:19.035264 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:06:19.035595 [debug] [MainThread]: Command end result
[0m18:06:19.049469 [info ] [MainThread]: 
[0m18:06:19.049718 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:06:19.049896 [info ] [MainThread]: 
[0m18:06:19.050114 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "tctype" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     tctype,
               ^
[0m18:06:19.050394 [info ] [MainThread]: 
[0m18:06:19.050729 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:06:19.051271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5401298, "process_user_time": 0.901746, "process_kernel_time": 0.049479, "process_mem_max_rss": "252056", "process_out_blocks": "2677", "command_success": false, "process_in_blocks": "0"}
[0m18:06:19.051542 [debug] [MainThread]: Command `dbt run` failed at 18:06:19.051506 after 0.54 seconds
[0m18:06:19.051758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aebb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c477550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc5a010>]}
[0m18:06:19.051967 [debug] [MainThread]: Flushing usage events
[0m18:06:30.757680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabdf8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabdf8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe2d690>]}


============================== 18:06:30.759170 | 47b5801b-fba7-4485-bfa6-4905813e9511 ==============================
[0m18:06:30.759170 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:06:30.759627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:06:30.832205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47b5801b-fba7-4485-bfa6-4905813e9511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe7ff10>]}
[0m18:06:30.849616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47b5801b-fba7-4485-bfa6-4905813e9511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1ff610>]}
[0m18:06:30.850012 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:06:30.874592 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:06:30.918127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:30.918367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:30.934426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47b5801b-fba7-4485-bfa6-4905813e9511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31eabd0>]}
[0m18:06:30.975445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47b5801b-fba7-4485-bfa6-4905813e9511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2fd7f10>]}
[0m18:06:30.975776 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:06:30.975999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47b5801b-fba7-4485-bfa6-4905813e9511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3421c50>]}
[0m18:06:30.976810 [info ] [MainThread]: 
[0m18:06:30.977156 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:30.979437 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:06:30.992586 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:06:30.992819 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:06:30.993021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:30.997077 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:06:30.997640 [debug] [ThreadPool]: On list_thrive: Close
[0m18:06:30.998474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:06:30.998738 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:06:31.001213 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:31.001406 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:06:31.001575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:31.004359 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:06:31.004923 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:31.005114 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:06:31.005418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:31.005620 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:31.005810 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:06:31.006115 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:31.006461 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:06:31.006648 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:31.006835 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:06:31.007323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:31.007641 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:06:31.008984 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:06:31.011082 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:06:31.011260 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:06:31.011446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:31.014114 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:06:31.014306 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:06:31.014481 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:06:31.022753 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:06:31.023408 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:06:31.023768 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:06:31.023959 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:06:31.025552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47b5801b-fba7-4485-bfa6-4905813e9511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe93590>]}
[0m18:06:31.025872 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:31.026116 [debug] [MainThread]: On master: BEGIN
[0m18:06:31.026294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:31.029259 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:06:31.029450 [debug] [MainThread]: On master: COMMIT
[0m18:06:31.029624 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:31.029786 [debug] [MainThread]: On master: COMMIT
[0m18:06:31.030061 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:31.030252 [debug] [MainThread]: On master: Close
[0m18:06:31.030988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:31.031210 [info ] [MainThread]: 
[0m18:06:31.032429 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m18:06:31.032704 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m18:06:31.032994 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m18:06:31.033177 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m18:06:31.036029 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m18:06:31.036522 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m18:06:31.048176 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m18:06:31.048742 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:06:31.048961 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m18:06:31.049156 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:31.052076 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:06:31.052280 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:06:31.052446 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m18:06:31.052753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.055128 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:06:31.055309 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:06:31.055571 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.056621 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:06:31.056782 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:06:31.057036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.062944 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:06:31.063152 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:06:31.063330 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:06:31.064043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:31.065832 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:06:31.066037 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m18:06:31.066535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.067489 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m18:06:31.069596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b5801b-fba7-4485-bfa6-4905813e9511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2524ed0>]}
[0m18:06:31.069887 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m18:06:31.070180 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m18:06:31.070416 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m18:06:31.070665 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m18:06:31.070890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m18:06:31.071109 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m18:06:31.072198 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m18:06:31.072579 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m18:06:31.073923 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m18:06:31.074289 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:06:31.074449 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m18:06:31.074597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:31.077765 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:06:31.077966 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:06:31.078127 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m18:06:31.078472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.079593 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:06:31.079780 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m18:06:31.080043 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.081043 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:06:31.081218 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m18:06:31.081451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.082138 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:06:31.082297 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:06:31.082432 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:06:31.082978 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.083839 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:06:31.084034 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m18:06:31.084487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.084975 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m18:06:31.086489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b5801b-fba7-4485-bfa6-4905813e9511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ff1b90>]}
[0m18:06:31.086778 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m18:06:31.087084 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m18:06:31.087301 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m18:06:31.087537 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m18:06:31.087769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m18:06:31.087963 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m18:06:31.088954 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m18:06:31.089327 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m18:06:31.090707 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m18:06:31.091093 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:06:31.091260 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m18:06:31.091402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:31.094026 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:06:31.094239 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:06:31.094653 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as transaction_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m18:06:31.095219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.097141 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:06:31.097329 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m18:06:31.097592 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.098536 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:06:31.098694 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m18:06:31.098961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.121441 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:06:31.121780 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:06:31.121984 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:06:31.122871 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:31.123855 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:06:31.124033 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m18:06:31.124427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:31.125012 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m18:06:31.128541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b5801b-fba7-4485-bfa6-4905813e9511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa245aad0>]}
[0m18:06:31.128845 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.04s]
[0m18:06:31.129126 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m18:06:31.129766 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:31.129960 [debug] [MainThread]: On master: BEGIN
[0m18:06:31.130117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:31.133346 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:06:31.133611 [debug] [MainThread]: On master: COMMIT
[0m18:06:31.133792 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:31.133936 [debug] [MainThread]: On master: COMMIT
[0m18:06:31.134301 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:31.134523 [debug] [MainThread]: On master: Close
[0m18:06:31.135735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:31.135925 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m18:06:31.136079 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:06:31.136222 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m18:06:31.136423 [info ] [MainThread]: 
[0m18:06:31.136622 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:06:31.137001 [debug] [MainThread]: Command end result
[0m18:06:31.150703 [info ] [MainThread]: 
[0m18:06:31.150946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:31.151122 [info ] [MainThread]: 
[0m18:06:31.151300 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:06:31.151858 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4117688, "process_user_time": 0.794899, "process_kernel_time": 0.069959, "process_mem_max_rss": "252012", "process_out_blocks": "3406", "process_in_blocks": "0"}
[0m18:06:31.152137 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:31.152099 after 0.41 seconds
[0m18:06:31.152353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b9a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b98e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b98ed0>]}
[0m18:06:31.152551 [debug] [MainThread]: Flushing usage events
[0m18:06:33.776165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7c3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7c8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7c8650>]}


============================== 18:06:33.777600 | 59ab4727-79f6-4d96-80f8-19aa22b3b03e ==============================
[0m18:06:33.777600 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:06:33.778087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:33.851170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59ab4727-79f6-4d96-80f8-19aa22b3b03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7e5890>]}
[0m18:06:33.871264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59ab4727-79f6-4d96-80f8-19aa22b3b03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bd3310>]}
[0m18:06:33.871857 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:06:33.898802 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:06:33.944543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:33.944819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:33.960867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ab4727-79f6-4d96-80f8-19aa22b3b03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f857d90>]}
[0m18:06:34.002232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ab4727-79f6-4d96-80f8-19aa22b3b03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869a7f50>]}
[0m18:06:34.002523 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:06:34.002827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ab4727-79f6-4d96-80f8-19aa22b3b03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d2f410>]}
[0m18:06:34.003571 [info ] [MainThread]: 
[0m18:06:34.003942 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:34.004435 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:06:34.017687 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:06:34.017940 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:06:34.018132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:34.022231 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:06:34.022804 [debug] [ThreadPool]: On list_thrive: Close
[0m18:06:34.023686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:06:34.023975 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:06:34.026509 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:34.026694 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:06:34.026883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:34.029701 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:06:34.030252 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:34.030462 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:06:34.030920 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:34.031207 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:34.031392 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:06:34.031727 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:34.032182 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:06:34.032373 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:06:34.032541 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:06:34.032829 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:34.033035 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:06:34.035883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:06:34.037899 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:06:34.038086 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:06:34.038249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:34.040952 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:06:34.041137 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:06:34.041313 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:06:34.049274 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:06:34.049939 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:06:34.050302 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:06:34.050478 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:06:34.051892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ab4727-79f6-4d96-80f8-19aa22b3b03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b346d0>]}
[0m18:06:34.052158 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:34.052334 [debug] [MainThread]: On master: BEGIN
[0m18:06:34.052506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:34.055485 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:06:34.055683 [debug] [MainThread]: On master: COMMIT
[0m18:06:34.055991 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:34.056179 [debug] [MainThread]: On master: COMMIT
[0m18:06:34.056602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:34.056967 [debug] [MainThread]: On master: Close
[0m18:06:34.057660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:34.057890 [info ] [MainThread]: 
[0m18:06:34.059152 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:06:34.059450 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:06:34.059755 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:06:34.059945 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:06:34.062849 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:06:34.063352 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:06:34.075880 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:06:34.076479 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:06:34.076675 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:06:34.076882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:34.080352 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:06:34.080541 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:06:34.080698 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:06:34.081161 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:06:34.081328 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:06:34.081519 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:06:34.082908 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:06:34.083090 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:06:34.084425 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "tctype" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     tctype,
               ^
[0m18:06:34.085074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ab4727-79f6-4d96-80f8-19aa22b3b03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ec8890>]}
[0m18:06:34.085360 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.02s]
[0m18:06:34.085666 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:06:34.086531 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:34.086733 [debug] [MainThread]: On master: BEGIN
[0m18:06:34.086907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:34.089977 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:06:34.090182 [debug] [MainThread]: On master: COMMIT
[0m18:06:34.090348 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:34.090510 [debug] [MainThread]: On master: COMMIT
[0m18:06:34.090930 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:34.091249 [debug] [MainThread]: On master: Close
[0m18:06:34.092037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:34.092232 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:06:34.092400 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:06:34.092587 [info ] [MainThread]: 
[0m18:06:34.092806 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:06:34.093123 [debug] [MainThread]: Command end result
[0m18:06:34.107064 [info ] [MainThread]: 
[0m18:06:34.107314 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:06:34.107505 [info ] [MainThread]: 
[0m18:06:34.107698 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "tctype" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     tctype,
               ^
[0m18:06:34.107864 [info ] [MainThread]: 
[0m18:06:34.108029 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:06:34.108418 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.35026732, "process_user_time": 0.751028, "process_kernel_time": 0.05235, "process_mem_max_rss": "251952", "process_out_blocks": "1814", "command_success": false, "process_in_blocks": "0"}
[0m18:06:34.108640 [debug] [MainThread]: Command `dbt run` failed at 18:06:34.108609 after 0.35 seconds
[0m18:06:34.108824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7caad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7cb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94419110>]}
[0m18:06:34.109048 [debug] [MainThread]: Flushing usage events
[0m18:07:20.835132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883cc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883912d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883e2c50>]}


============================== 18:07:20.836302 | 9fdb49da-defd-4c81-9d6f-28305087cb38 ==============================
[0m18:07:20.836302 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:07:20.836633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:07:20.905695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fdb49da-defd-4c81-9d6f-28305087cb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8842c650>]}
[0m18:07:20.922831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fdb49da-defd-4c81-9d6f-28305087cb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a79f710>]}
[0m18:07:20.923255 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:07:20.947002 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:07:20.990704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:07:20.990955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:07:21.006803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fdb49da-defd-4c81-9d6f-28305087cb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7d45d0>]}
[0m18:07:21.047818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fdb49da-defd-4c81-9d6f-28305087cb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f577a10>]}
[0m18:07:21.048112 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:07:21.048429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fdb49da-defd-4c81-9d6f-28305087cb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f905110>]}
[0m18:07:21.049132 [info ] [MainThread]: 
[0m18:07:21.049471 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:07:21.049931 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:07:21.062679 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:07:21.062922 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:07:21.063129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:21.067235 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:07:21.067807 [debug] [ThreadPool]: On list_thrive: Close
[0m18:07:21.068853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:07:21.069104 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:07:21.071575 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:07:21.071764 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:07:21.071944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:21.074793 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:07:21.075366 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:07:21.075535 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:07:21.075790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:21.075955 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:07:21.076120 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:07:21.076413 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:21.076780 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:07:21.076954 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:07:21.077117 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:07:21.077390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:21.077572 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:07:21.080177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:07:21.082491 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:07:21.082820 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:07:21.083088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:21.086656 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:07:21.086953 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:07:21.087236 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:07:21.095961 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:07:21.096775 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:07:21.097172 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:07:21.097371 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:07:21.098837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fdb49da-defd-4c81-9d6f-28305087cb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5a01d0>]}
[0m18:07:21.099097 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:21.099299 [debug] [MainThread]: On master: BEGIN
[0m18:07:21.099532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:21.103081 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m18:07:21.103320 [debug] [MainThread]: On master: COMMIT
[0m18:07:21.103516 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:21.103715 [debug] [MainThread]: On master: COMMIT
[0m18:07:21.103973 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:21.104164 [debug] [MainThread]: On master: Close
[0m18:07:21.104933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:21.105171 [info ] [MainThread]: 
[0m18:07:21.106458 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:07:21.106748 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:07:21.107052 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:07:21.107253 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:07:21.110203 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:07:21.110754 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:07:21.123168 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:07:21.123775 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:07:21.123975 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:07:21.124172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:07:21.127125 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:07:21.127324 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:07:21.127523 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:07:21.128031 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    tctype,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:07:21.128248 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:07:21.128487 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:07:21.129788 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:07:21.129991 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:07:21.131382 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "tctype" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     tctype,
               ^
[0m18:07:21.131999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fdb49da-defd-4c81-9d6f-28305087cb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec305d0>]}
[0m18:07:21.132316 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.02s]
[0m18:07:21.132625 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:07:21.133645 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:21.133934 [debug] [MainThread]: On master: BEGIN
[0m18:07:21.134129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:21.137260 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:07:21.137471 [debug] [MainThread]: On master: COMMIT
[0m18:07:21.137642 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:21.137812 [debug] [MainThread]: On master: COMMIT
[0m18:07:21.138266 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:21.138556 [debug] [MainThread]: On master: Close
[0m18:07:21.139234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:21.139433 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:07:21.139623 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:07:21.139816 [info ] [MainThread]: 
[0m18:07:21.140033 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:07:21.140351 [debug] [MainThread]: Command end result
[0m18:07:21.154049 [info ] [MainThread]: 
[0m18:07:21.154337 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:07:21.154642 [info ] [MainThread]: 
[0m18:07:21.154871 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "tctype" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     tctype,
               ^
[0m18:07:21.155049 [info ] [MainThread]: 
[0m18:07:21.155228 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:07:21.155639 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3368987, "process_user_time": 0.686202, "process_kernel_time": 0.067511, "process_mem_max_rss": "252028", "process_out_blocks": "1814", "command_success": false, "process_in_blocks": "0"}
[0m18:07:21.155870 [debug] [MainThread]: Command `dbt run` failed at 18:07:21.155835 after 0.34 seconds
[0m18:07:21.156069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8839aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8839b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb24650>]}
[0m18:07:21.156261 [debug] [MainThread]: Flushing usage events
[0m18:07:35.930006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15be7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1588690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15bcc10>]}


============================== 18:07:35.931149 | 76bb729e-ad46-42bc-9697-9eb1ed5b3124 ==============================
[0m18:07:35.931149 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:07:35.931564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:07:35.999469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76bb729e-ad46-42bc-9697-9eb1ed5b3124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1583310>]}
[0m18:07:36.016639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76bb729e-ad46-42bc-9697-9eb1ed5b3124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3993390>]}
[0m18:07:36.017018 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:07:36.041625 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:07:36.085123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:36.085470 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:07:36.156114 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:07:36.156569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76bb729e-ad46-42bc-9697-9eb1ed5b3124', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9894dd50>]}
[0m18:07:36.214942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76bb729e-ad46-42bc-9697-9eb1ed5b3124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98084cd0>]}
[0m18:07:36.260295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76bb729e-ad46-42bc-9697-9eb1ed5b3124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92edfe90>]}
[0m18:07:36.260645 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:07:36.260985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76bb729e-ad46-42bc-9697-9eb1ed5b3124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9805a850>]}
[0m18:07:36.261715 [info ] [MainThread]: 
[0m18:07:36.262067 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:07:36.262557 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:07:36.297565 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:07:36.297883 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:07:36.298097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:36.302483 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:07:36.303083 [debug] [ThreadPool]: On list_thrive: Close
[0m18:07:36.304148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:07:36.304526 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:07:36.307392 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:07:36.307671 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:07:36.307868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:36.311421 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:07:36.312021 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:07:36.312190 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:07:36.312436 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:36.312587 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:07:36.312735 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:07:36.312988 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:36.313410 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:07:36.313591 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:07:36.313754 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:07:36.313989 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:36.314161 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:07:36.317024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:07:36.319327 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:07:36.319516 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:07:36.319672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:36.322433 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:07:36.322648 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:07:36.322841 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:07:36.331003 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:07:36.331628 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:07:36.331978 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:07:36.332149 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:07:36.333541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76bb729e-ad46-42bc-9697-9eb1ed5b3124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92558a90>]}
[0m18:07:36.333799 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:36.333997 [debug] [MainThread]: On master: BEGIN
[0m18:07:36.334173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:36.337203 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:07:36.337431 [debug] [MainThread]: On master: COMMIT
[0m18:07:36.337619 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:36.337789 [debug] [MainThread]: On master: COMMIT
[0m18:07:36.338240 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:36.338448 [debug] [MainThread]: On master: Close
[0m18:07:36.339391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:36.339634 [info ] [MainThread]: 
[0m18:07:36.340921 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:07:36.341264 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:07:36.341761 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:07:36.342080 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:07:36.345106 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:07:36.345628 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:07:36.357476 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:07:36.358015 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:07:36.358240 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:07:36.358442 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:07:36.361624 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:07:36.361836 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:07:36.362008 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    transaction_type,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:07:36.362426 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    transaction_type,
    createdat,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:07:36.362617 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:07:36.362821 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:07:36.364079 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:07:36.364264 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:07:36.365807 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "transaction_type" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     transaction_type,
               ^
[0m18:07:36.366489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76bb729e-ad46-42bc-9697-9eb1ed5b3124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923f7310>]}
[0m18:07:36.366771 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.02s]
[0m18:07:36.367045 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:07:36.367893 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:36.368094 [debug] [MainThread]: On master: BEGIN
[0m18:07:36.368268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:36.371375 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:07:36.371594 [debug] [MainThread]: On master: COMMIT
[0m18:07:36.371770 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:36.371947 [debug] [MainThread]: On master: COMMIT
[0m18:07:36.372376 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:36.372706 [debug] [MainThread]: On master: Close
[0m18:07:36.373641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:36.373813 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:07:36.373980 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:07:36.374172 [info ] [MainThread]: 
[0m18:07:36.374388 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m18:07:36.374752 [debug] [MainThread]: Command end result
[0m18:07:36.388790 [info ] [MainThread]: 
[0m18:07:36.389043 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:07:36.389251 [info ] [MainThread]: 
[0m18:07:36.389484 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "transaction_type" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     transaction_type,
               ^
[0m18:07:36.389666 [info ] [MainThread]: 
[0m18:07:36.389905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:07:36.390510 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.47677028, "process_user_time": 0.828294, "process_kernel_time": 0.06068, "process_mem_max_rss": "252060", "process_out_blocks": "2677", "command_success": false, "process_in_blocks": "0"}
[0m18:07:36.390743 [debug] [MainThread]: Command `dbt run` failed at 18:07:36.390707 after 0.48 seconds
[0m18:07:36.390945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa158b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29f1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6329ed0>]}
[0m18:07:36.391143 [debug] [MainThread]: Flushing usage events
[0m18:08:23.187066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2e1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2e8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d31c3d0>]}


============================== 18:08:23.188296 | 4725e39b-3f53-43a2-91e9-2859d9e8618b ==============================
[0m18:08:23.188296 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:08:23.188721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:23.262482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d375b10>]}
[0m18:08:23.281264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6efad0>]}
[0m18:08:23.281936 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:08:23.308100 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:08:23.357561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:08:23.357997 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:08:23.358250 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_tc_data.sql
[0m18:08:23.434700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:08:23.435204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94508310>]}
[0m18:08:23.500891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d5ce50>]}
[0m18:08:23.541698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c4c1d0>]}
[0m18:08:23.541992 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:08:23.542295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d8b350>]}
[0m18:08:23.543119 [info ] [MainThread]: 
[0m18:08:23.543466 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:08:23.545428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:08:23.581832 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:08:23.582141 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:08:23.582360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:23.586831 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:08:23.587410 [debug] [ThreadPool]: On list_thrive: Close
[0m18:08:23.588495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:08:23.588856 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:08:23.591482 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:08:23.591683 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:08:23.591848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:23.594879 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:08:23.595508 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:08:23.595697 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:08:23.596019 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:23.596221 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:08:23.596399 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:08:23.596693 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:23.597051 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:08:23.597277 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:08:23.597460 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:08:23.597796 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:23.597982 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:08:23.599081 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:08:23.601159 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:08:23.601351 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:08:23.601516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:23.605060 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:08:23.605255 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:08:23.605442 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:08:23.613838 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:08:23.614444 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:08:23.614799 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:08:23.614972 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:08:23.616304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ccac50>]}
[0m18:08:23.616553 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:23.616745 [debug] [MainThread]: On master: BEGIN
[0m18:08:23.616908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:23.620055 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:08:23.620257 [debug] [MainThread]: On master: COMMIT
[0m18:08:23.620443 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:23.620622 [debug] [MainThread]: On master: COMMIT
[0m18:08:23.621069 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:23.621407 [debug] [MainThread]: On master: Close
[0m18:08:23.622117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:23.622357 [info ] [MainThread]: 
[0m18:08:23.623642 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m18:08:23.623934 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m18:08:23.624220 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m18:08:23.624417 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m18:08:23.627245 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m18:08:23.627752 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m18:08:23.638664 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m18:08:23.639212 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:08:23.639537 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m18:08:23.639804 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:08:23.643558 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:08:23.643897 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:08:23.644084 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m18:08:23.644431 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.647044 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:08:23.647215 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:08:23.647467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.649186 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:08:23.649352 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:08:23.649630 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.655660 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:08:23.655873 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:08:23.656074 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:08:23.656775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:23.658528 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:08:23.658711 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m18:08:23.659081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.660049 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m18:08:23.662354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922adb50>]}
[0m18:08:23.662837 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m18:08:23.663126 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m18:08:23.663388 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m18:08:23.663654 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m18:08:23.663892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m18:08:23.664090 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m18:08:23.665173 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m18:08:23.665556 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m18:08:23.666935 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m18:08:23.667281 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:08:23.667446 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m18:08:23.667614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:23.671148 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:08:23.671478 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:08:23.671698 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m18:08:23.672087 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.673296 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:08:23.673473 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m18:08:23.673739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.674809 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:08:23.674978 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m18:08:23.675209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.675814 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:08:23.675979 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:08:23.676130 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:08:23.676669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.677532 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:08:23.677687 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m18:08:23.678040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.678559 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m18:08:23.680011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d5c150>]}
[0m18:08:23.680276 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m18:08:23.680547 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m18:08:23.680751 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m18:08:23.680985 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m18:08:23.681204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m18:08:23.681387 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m18:08:23.682437 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m18:08:23.682851 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m18:08:23.684210 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m18:08:23.684605 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:08:23.684768 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m18:08:23.684907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:23.688501 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:08:23.688782 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:08:23.689022 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as trans_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m18:08:23.689425 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.690706 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:08:23.690891 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m18:08:23.691152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.692217 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:08:23.692398 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m18:08:23.692647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.693219 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:08:23.693378 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:08:23.693534 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:08:23.694117 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.695765 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:08:23.695946 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m18:08:23.696315 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:23.696847 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m18:08:23.698719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4725e39b-3f53-43a2-91e9-2859d9e8618b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921cc4d0>]}
[0m18:08:23.699142 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m18:08:23.699453 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m18:08:23.700200 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:23.700499 [debug] [MainThread]: On master: BEGIN
[0m18:08:23.700675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:23.704110 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:08:23.704359 [debug] [MainThread]: On master: COMMIT
[0m18:08:23.704606 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:23.704841 [debug] [MainThread]: On master: COMMIT
[0m18:08:23.705313 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:23.705536 [debug] [MainThread]: On master: Close
[0m18:08:23.706371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:23.706547 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m18:08:23.706691 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:08:23.706825 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m18:08:23.707009 [info ] [MainThread]: 
[0m18:08:23.707187 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:08:23.707591 [debug] [MainThread]: Command end result
[0m18:08:23.723257 [info ] [MainThread]: 
[0m18:08:23.723578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:23.723782 [info ] [MainThread]: 
[0m18:08:23.724003 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:08:23.724499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5540865, "process_user_time": 0.905188, "process_kernel_time": 0.075265, "process_mem_max_rss": "251964", "process_out_blocks": "4268", "process_in_blocks": "0"}
[0m18:08:23.724768 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:23.724726 after 0.55 seconds
[0m18:08:23.724967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2e3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2e0b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2089c90>]}
[0m18:08:23.725142 [debug] [MainThread]: Flushing usage events
[0m18:08:38.020842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd38a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd38690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd6cb10>]}


============================== 18:08:38.021981 | 4c8eb320-b58b-490c-b3fc-f8ccea224364 ==============================
[0m18:08:38.021981 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:08:38.022307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:38.094273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c8eb320-b58b-490c-b3fc-f8ccea224364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fdd9590>]}
[0m18:08:38.115047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c8eb320-b58b-490c-b3fc-f8ccea224364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2143250>]}
[0m18:08:38.115874 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:08:38.148029 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:08:38.197120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:38.197453 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:38.215197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c8eb320-b58b-490c-b3fc-f8ccea224364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97364610>]}
[0m18:08:38.259749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c8eb320-b58b-490c-b3fc-f8ccea224364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f17f90>]}
[0m18:08:38.260096 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:08:38.260372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c8eb320-b58b-490c-b3fc-f8ccea224364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9729ecd0>]}
[0m18:08:38.261174 [info ] [MainThread]: 
[0m18:08:38.261535 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:08:38.262085 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:08:38.275272 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:08:38.275629 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:08:38.275933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:38.280368 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:08:38.281272 [debug] [ThreadPool]: On list_thrive: Close
[0m18:08:38.282615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:08:38.282937 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:08:38.285806 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:08:38.286078 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:08:38.286299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:38.289691 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:08:38.290355 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:08:38.290556 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:08:38.290885 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:38.291116 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:08:38.291332 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:08:38.291675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:38.292158 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:08:38.292348 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:08:38.292505 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:08:38.292827 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:38.293067 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:08:38.295902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:08:38.298149 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:08:38.298361 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:08:38.298554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:38.301707 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:08:38.301963 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:08:38.302170 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:08:38.310786 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:08:38.311526 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:08:38.311947 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:08:38.312121 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:08:38.313568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c8eb320-b58b-490c-b3fc-f8ccea224364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9724a910>]}
[0m18:08:38.313849 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:38.314043 [debug] [MainThread]: On master: BEGIN
[0m18:08:38.314209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:38.317474 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:08:38.317699 [debug] [MainThread]: On master: COMMIT
[0m18:08:38.317877 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:38.318051 [debug] [MainThread]: On master: COMMIT
[0m18:08:38.318350 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:38.318586 [debug] [MainThread]: On master: Close
[0m18:08:38.319346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:38.319611 [info ] [MainThread]: 
[0m18:08:38.320938 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:08:38.321255 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:08:38.321583 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:08:38.321818 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:08:38.324824 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:08:38.325344 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:08:38.337736 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:08:38.338276 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:08:38.338512 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:08:38.338718 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:08:38.342116 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:08:38.342359 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:08:38.342581 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:08:38.343037 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:08:38.343212 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:08:38.343412 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:08:38.344755 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:08:38.344939 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:08:38.346274 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "trans_type" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     trans_type,
               ^
[0m18:08:38.346961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c8eb320-b58b-490c-b3fc-f8ccea224364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965d0dd0>]}
[0m18:08:38.347257 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.02s]
[0m18:08:38.347542 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:08:38.348356 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:38.348566 [debug] [MainThread]: On master: BEGIN
[0m18:08:38.348752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:38.351882 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:08:38.352114 [debug] [MainThread]: On master: COMMIT
[0m18:08:38.352307 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:38.352499 [debug] [MainThread]: On master: COMMIT
[0m18:08:38.352777 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:38.353002 [debug] [MainThread]: On master: Close
[0m18:08:38.353771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:38.353979 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:08:38.354166 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:08:38.354357 [info ] [MainThread]: 
[0m18:08:38.354570 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:08:38.354909 [debug] [MainThread]: Command end result
[0m18:08:38.368731 [info ] [MainThread]: 
[0m18:08:38.369170 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:08:38.369370 [info ] [MainThread]: 
[0m18:08:38.369592 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "trans_type" not found in FROM clause!
  Candidate bindings: "source_data.transaction_id"
  LINE 17:     trans_type,
               ^
[0m18:08:38.369787 [info ] [MainThread]: 
[0m18:08:38.369968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:08:38.370385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3659158, "process_user_time": 0.722247, "process_kernel_time": 0.062021, "process_mem_max_rss": "252112", "process_out_blocks": "1814", "command_success": false, "process_in_blocks": "0"}
[0m18:08:38.370622 [debug] [MainThread]: Command `dbt run` failed at 18:08:38.370586 after 0.37 seconds
[0m18:08:38.370826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07669d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ada010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963ad410>]}
[0m18:08:38.371011 [debug] [MainThread]: Flushing usage events
[0m18:10:07.008692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bbf0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bbeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bbe350>]}


============================== 18:10:07.015746 | 9d757160-95c3-4441-9b14-56740e357a33 ==============================
[0m18:10:07.015746 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:10:07.016158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:07.083893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d757160-95c3-4441-9b14-56740e357a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94afa7d0>]}
[0m18:10:07.100977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d757160-95c3-4441-9b14-56740e357a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97113e90>]}
[0m18:10:07.101345 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:10:07.125336 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:10:07.169982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:07.170241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:07.186068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d757160-95c3-4441-9b14-56740e357a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfd4dd0>]}
[0m18:10:07.238995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d757160-95c3-4441-9b14-56740e357a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bda3fd0>]}
[0m18:10:07.239318 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:10:07.239625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d757160-95c3-4441-9b14-56740e357a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0cf510>]}
[0m18:10:07.240395 [info ] [MainThread]: 
[0m18:10:07.240732 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:07.242658 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:10:07.255559 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:10:07.255799 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:10:07.255994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:07.260154 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:10:07.260820 [debug] [ThreadPool]: On list_thrive: Close
[0m18:10:07.262011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:10:07.262377 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:10:07.265083 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:10:07.265314 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:10:07.265508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:07.269476 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:10:07.270287 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:10:07.270575 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:10:07.270928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:07.271121 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:10:07.271312 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:10:07.271633 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:07.272077 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:10:07.272275 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:10:07.272467 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:10:07.272865 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:07.273135 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:10:07.274264 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:10:07.276445 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:10:07.276610 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:10:07.276758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:07.279807 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:10:07.279998 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:10:07.280167 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:10:07.288221 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:10:07.288788 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:10:07.289121 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:10:07.289286 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:10:07.292201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d757160-95c3-4441-9b14-56740e357a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b1d190>]}
[0m18:10:07.292442 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:07.292639 [debug] [MainThread]: On master: BEGIN
[0m18:10:07.292804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:07.295868 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:10:07.296074 [debug] [MainThread]: On master: COMMIT
[0m18:10:07.296252 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:07.296434 [debug] [MainThread]: On master: COMMIT
[0m18:10:07.296732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:07.296910 [debug] [MainThread]: On master: Close
[0m18:10:07.297662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:07.297883 [info ] [MainThread]: 
[0m18:10:07.299097 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m18:10:07.299368 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m18:10:07.299676 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m18:10:07.299873 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m18:10:07.302678 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m18:10:07.303333 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m18:10:07.313964 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m18:10:07.314895 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:10:07.315109 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m18:10:07.315289 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:07.318276 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:10:07.318596 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:10:07.318790 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m18:10:07.319127 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.322018 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:10:07.322186 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:10:07.322457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.323543 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:10:07.323758 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:10:07.324055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.330024 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:10:07.330231 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:10:07.330414 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:10:07.331142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:07.332861 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:10:07.333047 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m18:10:07.333489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.334400 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m18:10:07.337925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d757160-95c3-4441-9b14-56740e357a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2ec110>]}
[0m18:10:07.338245 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m18:10:07.338546 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m18:10:07.338763 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m18:10:07.339003 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m18:10:07.339222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m18:10:07.339399 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m18:10:07.340485 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m18:10:07.340902 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m18:10:07.342281 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m18:10:07.342835 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:10:07.343020 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m18:10:07.343185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:07.346332 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:10:07.346677 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:10:07.346875 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m18:10:07.347201 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.348456 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:10:07.348635 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m18:10:07.348896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.349907 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:10:07.350063 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m18:10:07.350296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.350969 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:10:07.351128 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:10:07.351271 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:10:07.351796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.352576 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:10:07.352749 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m18:10:07.353120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.353609 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m18:10:07.355368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d757160-95c3-4441-9b14-56740e357a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94982f50>]}
[0m18:10:07.355677 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m18:10:07.355940 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m18:10:07.356142 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m18:10:07.356375 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m18:10:07.356618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m18:10:07.356806 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m18:10:07.357854 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m18:10:07.358263 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m18:10:07.359621 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m18:10:07.359938 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:10:07.360097 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m18:10:07.360268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:07.363167 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:10:07.363386 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:10:07.363576 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as transaction_id,
    "TCTYPE"::varchar as trans_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m18:10:07.363886 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.365085 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:10:07.365321 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m18:10:07.365771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.366868 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:10:07.367046 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m18:10:07.367274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.368665 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:10:07.368834 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:10:07.368982 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:10:07.369527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.392911 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:10:07.393225 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m18:10:07.393888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:07.394425 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m18:10:07.396412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d757160-95c3-4441-9b14-56740e357a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94df9ad0>]}
[0m18:10:07.396829 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.04s]
[0m18:10:07.397141 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m18:10:07.397822 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:07.398012 [debug] [MainThread]: On master: BEGIN
[0m18:10:07.398180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:07.401342 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:10:07.401588 [debug] [MainThread]: On master: COMMIT
[0m18:10:07.401753 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:07.401918 [debug] [MainThread]: On master: COMMIT
[0m18:10:07.402192 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:07.402365 [debug] [MainThread]: On master: Close
[0m18:10:07.403074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:07.403229 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m18:10:07.403353 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:10:07.403497 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m18:10:07.403705 [info ] [MainThread]: 
[0m18:10:07.403876 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:10:07.404230 [debug] [MainThread]: Command end result
[0m18:10:07.417907 [info ] [MainThread]: 
[0m18:10:07.418134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:07.418461 [info ] [MainThread]: 
[0m18:10:07.418752 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:10:07.419189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.42668867, "process_user_time": 0.874509, "process_kernel_time": 0.091306, "process_mem_max_rss": "251656", "process_out_blocks": "8662", "process_in_blocks": "0"}
[0m18:10:07.419418 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:07.419382 after 0.43 seconds
[0m18:10:07.419610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998fa150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998f8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998f8ed0>]}
[0m18:10:07.419827 [debug] [MainThread]: Flushing usage events
[0m18:11:10.820724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99de410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99a8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99a1290>]}


============================== 18:11:10.821918 | 8f3cf2d8-821e-4d8f-a0cf-5990d845d28f ==============================
[0m18:11:10.821918 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:11:10.822380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:11:10.891098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f3cf2d8-821e-4d8f-a0cf-5990d845d28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a4ed10>]}
[0m18:11:10.908644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f3cf2d8-821e-4d8f-a0cf-5990d845d28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0fd4390>]}
[0m18:11:10.909062 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:11:10.932495 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:11:10.976900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:10.977132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:10.993134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f3cf2d8-821e-4d8f-a0cf-5990d845d28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d93190>]}
[0m18:11:11.034689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f3cf2d8-821e-4d8f-a0cf-5990d845d28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b87ed0>]}
[0m18:11:11.034999 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:11:11.035303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f3cf2d8-821e-4d8f-a0cf-5990d845d28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f0fb10>]}
[0m18:11:11.036068 [info ] [MainThread]: 
[0m18:11:11.036478 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:11:11.037044 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:11:11.051554 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:11:11.051869 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:11:11.052069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:11.056580 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:11:11.057220 [debug] [ThreadPool]: On list_thrive: Close
[0m18:11:11.058334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:11:11.058764 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:11:11.061981 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:11:11.062362 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:11:11.062688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:11.066886 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:11:11.067719 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:11:11.068088 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:11:11.068592 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:11.068870 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:11:11.069183 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:11:11.069615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:11.070077 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:11:11.070351 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:11:11.070683 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:11:11.071137 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:11.071383 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:11:11.074385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:11:11.076984 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:11:11.077233 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:11:11.077444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:11.080857 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:11:11.081086 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:11:11.081289 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:11:11.089632 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:11:11.090353 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:11:11.090731 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:11:11.090906 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:11:11.092369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f3cf2d8-821e-4d8f-a0cf-5990d845d28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d14910>]}
[0m18:11:11.092611 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:11.092798 [debug] [MainThread]: On master: BEGIN
[0m18:11:11.092976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:11.096291 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:11:11.096515 [debug] [MainThread]: On master: COMMIT
[0m18:11:11.096712 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:11.096899 [debug] [MainThread]: On master: COMMIT
[0m18:11:11.097261 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:11.097519 [debug] [MainThread]: On master: Close
[0m18:11:11.098337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:11.098626 [info ] [MainThread]: 
[0m18:11:11.099996 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:11:11.100350 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:11:11.100655 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:11:11.100879 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:11:11.103899 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:11:11.104515 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:11:11.116834 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:11:11.117546 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:11:11.117816 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:11:11.118017 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:11:11.121493 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:11:11.121716 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:11:11.121895 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:11:11.122430 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:11:11.122629 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:11:11.122836 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:11:11.124132 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:11:11.124308 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:11:11.125821 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "transaction_id" not found in FROM clause!
  Candidate bindings: "source_data.trans_id", "source_data.createdat", "source_data.customerid", "source_data.tctype", "source_data.redeemid"
  LINE 16:     transaction_id::int as trans_id,
               ^
[0m18:11:11.126490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f3cf2d8-821e-4d8f-a0cf-5990d845d28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb007d250>]}
[0m18:11:11.126781 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.03s]
[0m18:11:11.127135 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:11:11.128244 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:11.128567 [debug] [MainThread]: On master: BEGIN
[0m18:11:11.128911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:11.132001 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:11:11.132200 [debug] [MainThread]: On master: COMMIT
[0m18:11:11.132365 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:11.132529 [debug] [MainThread]: On master: COMMIT
[0m18:11:11.132942 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:11.133252 [debug] [MainThread]: On master: Close
[0m18:11:11.134112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:11.134285 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:11:11.134451 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:11:11.134637 [info ] [MainThread]: 
[0m18:11:11.134849 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:11:11.135204 [debug] [MainThread]: Command end result
[0m18:11:11.148900 [info ] [MainThread]: 
[0m18:11:11.149183 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:11:11.149396 [info ] [MainThread]: 
[0m18:11:11.149894 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "transaction_id" not found in FROM clause!
  Candidate bindings: "source_data.trans_id", "source_data.createdat", "source_data.customerid", "source_data.tctype", "source_data.redeemid"
  LINE 16:     transaction_id::int as trans_id,
               ^
[0m18:11:11.150322 [info ] [MainThread]: 
[0m18:11:11.150530 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:11:11.150962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34697795, "process_user_time": 0.731163, "process_kernel_time": 0.072612, "process_mem_max_rss": "251676", "process_out_blocks": "1814", "command_success": false, "process_in_blocks": "0"}
[0m18:11:11.151199 [debug] [MainThread]: Command `dbt run` failed at 18:11:11.151163 after 0.35 seconds
[0m18:11:11.151401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99aab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99ab050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99f1790>]}
[0m18:11:11.151596 [debug] [MainThread]: Flushing usage events
[0m18:12:12.183281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdfcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdc8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdfe450>]}


============================== 18:12:12.184451 | dd761404-d432-4855-8f7f-f927b0d70bb1 ==============================
[0m18:12:12.184451 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:12:12.184812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:12:12.252532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd761404-d432-4855-8f7f-f927b0d70bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce6ee10>]}
[0m18:12:12.269749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd761404-d432-4855-8f7f-f927b0d70bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1d2ed0>]}
[0m18:12:12.270111 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:12:12.294269 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:12:12.338040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:12:12.338365 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/staging/stg_tc_data.sql
[0m18:12:12.409536 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:12:12.409849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd761404-d432-4855-8f7f-f927b0d70bb1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942ef190>]}
[0m18:12:12.470927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd761404-d432-4855-8f7f-f927b0d70bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94573950>]}
[0m18:12:12.511670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd761404-d432-4855-8f7f-f927b0d70bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92739c10>]}
[0m18:12:12.511977 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:12:12.512170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd761404-d432-4855-8f7f-f927b0d70bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942d9250>]}
[0m18:12:12.512925 [info ] [MainThread]: 
[0m18:12:12.513243 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:12:12.513734 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:12:12.552459 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:12:12.552822 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:12:12.553025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:12.557289 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:12:12.557915 [debug] [ThreadPool]: On list_thrive: Close
[0m18:12:12.558917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:12:12.559192 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:12:12.561747 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:12:12.561942 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:12:12.562112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:12.565008 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:12:12.565583 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:12:12.565772 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:12:12.566083 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:12.566253 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:12:12.566415 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:12:12.566711 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:12.567069 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:12:12.567246 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:12:12.567413 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:12:12.567866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:12.568169 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:12:12.570897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:12:12.572960 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:12:12.573139 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:12:12.573300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:12.576073 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:12:12.576261 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:12:12.576433 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:12:12.584372 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:12:12.584967 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:12:12.585312 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:12:12.585481 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:12:12.586842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd761404-d432-4855-8f7f-f927b0d70bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f9e610>]}
[0m18:12:12.587085 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:12.587288 [debug] [MainThread]: On master: BEGIN
[0m18:12:12.587458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:12.590454 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:12:12.590665 [debug] [MainThread]: On master: COMMIT
[0m18:12:12.590832 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:12.590993 [debug] [MainThread]: On master: COMMIT
[0m18:12:12.591479 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:12.591828 [debug] [MainThread]: On master: Close
[0m18:12:12.592593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:12.592853 [info ] [MainThread]: 
[0m18:12:12.594100 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:12:12.594383 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:12:12.594689 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:12:12.594878 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:12:12.597805 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:12:12.598321 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:12:12.610129 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:12:12.610673 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:12:12.610916 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:12:12.611100 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:12:12.614254 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:12:12.614449 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:12:12.614634 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:12:12.615122 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    transaction_id::int as trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:12:12.615307 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:12:12.615510 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:12:12.616779 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:12:12.616956 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:12:12.618363 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "transaction_id" not found in FROM clause!
  Candidate bindings: "source_data.trans_id", "source_data.createdat", "source_data.customerid", "source_data.tctype", "source_data.redeemid"
  LINE 16:     transaction_id::int as trans_id,
               ^
[0m18:12:12.618982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd761404-d432-4855-8f7f-f927b0d70bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f9e490>]}
[0m18:12:12.619274 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.02s]
[0m18:12:12.619556 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:12:12.620446 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:12.620673 [debug] [MainThread]: On master: BEGIN
[0m18:12:12.620898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:12.623987 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:12:12.624195 [debug] [MainThread]: On master: COMMIT
[0m18:12:12.624377 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:12.624547 [debug] [MainThread]: On master: COMMIT
[0m18:12:12.624784 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:12.624972 [debug] [MainThread]: On master: Close
[0m18:12:12.625679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:12.625876 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:12:12.626038 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:12:12.626222 [info ] [MainThread]: 
[0m18:12:12.626431 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m18:12:12.626784 [debug] [MainThread]: Command end result
[0m18:12:12.640657 [info ] [MainThread]: 
[0m18:12:12.640897 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:12:12.641058 [info ] [MainThread]: 
[0m18:12:12.641250 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "transaction_id" not found in FROM clause!
  Candidate bindings: "source_data.trans_id", "source_data.createdat", "source_data.customerid", "source_data.tctype", "source_data.redeemid"
  LINE 16:     transaction_id::int as trans_id,
               ^
[0m18:12:12.641418 [info ] [MainThread]: 
[0m18:12:12.641598 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:12:12.642031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.47526234, "process_user_time": 0.847405, "process_kernel_time": 0.052209, "process_mem_max_rss": "251796", "process_out_blocks": "2678", "command_success": false, "process_in_blocks": "0"}
[0m18:12:12.642433 [debug] [MainThread]: Command `dbt run` failed at 18:12:12.642373 after 0.48 seconds
[0m18:12:12.642683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a19110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdfda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdc0a90>]}
[0m18:12:12.642892 [debug] [MainThread]: Flushing usage events
[0m18:13:14.497661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb641e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d65410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb641c610>]}


============================== 18:13:14.499001 | 1c1c4ea0-6b70-47cd-9632-4ec8e43bce0b ==============================
[0m18:13:14.499001 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:13:14.499366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intermediate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:14.571023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c1c4ea0-6b70-47cd-9632-4ec8e43bce0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb63e3050>]}
[0m18:13:14.589268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c1c4ea0-6b70-47cd-9632-4ec8e43bce0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb87f3050>]}
[0m18:13:14.589773 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:13:14.616626 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:13:14.662819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:14.663206 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:13:14.735380 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:13:14.735746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1c1c4ea0-6b70-47cd-9632-4ec8e43bce0b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6fbf10>]}
[0m18:13:14.794808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c1c4ea0-6b70-47cd-9632-4ec8e43bce0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac007350>]}
[0m18:13:14.836284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c1c4ea0-6b70-47cd-9632-4ec8e43bce0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d4fe90>]}
[0m18:13:14.836603 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:13:14.836812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1c4ea0-6b70-47cd-9632-4ec8e43bce0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d18910>]}
[0m18:13:14.837593 [info ] [MainThread]: 
[0m18:13:14.837911 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:14.838407 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:13:14.874318 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:13:14.874620 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:13:14.874805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:14.879104 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:13:14.879674 [debug] [ThreadPool]: On list_thrive: Close
[0m18:13:14.880768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:13:14.881137 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:13:14.883804 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:13:14.883994 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:13:14.884218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:14.887114 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:13:14.887667 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:13:14.887838 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:13:14.888085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:14.888261 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:13:14.888437 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:13:14.888803 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:14.889311 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:13:14.889506 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:13:14.889678 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:13:14.890028 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:14.890275 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:13:14.892964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:13:14.894990 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:13:14.895177 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:13:14.895359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:14.898100 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:13:14.898303 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:13:14.898479 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:13:14.906677 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:13:14.907291 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:13:14.907627 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:13:14.907799 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:13:14.910706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1c4ea0-6b70-47cd-9632-4ec8e43bce0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d18910>]}
[0m18:13:14.910994 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:14.911251 [debug] [MainThread]: On master: BEGIN
[0m18:13:14.911418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:14.914465 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:13:14.914664 [debug] [MainThread]: On master: COMMIT
[0m18:13:14.914848 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:14.915016 [debug] [MainThread]: On master: COMMIT
[0m18:13:14.915278 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:14.915472 [debug] [MainThread]: On master: Close
[0m18:13:14.916233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:14.916467 [info ] [MainThread]: 
[0m18:13:14.917637 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:13:14.917915 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:13:14.918200 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:13:14.918406 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:13:14.921200 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:13:14.921740 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:13:14.933086 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:13:14.933566 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:13:14.933772 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:13:14.933970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:14.937413 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:13:14.937652 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:13:14.937844 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:13:14.938314 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:13:14.938500 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:13:14.938709 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:13:14.939978 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:13:14.940148 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:13:14.943598 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "trans_type" not found in FROM clause!
  Candidate bindings: "source_data.trans_id", "source_data.tctype", "source_data.amount", "source_data.createdat"
  LINE 17:     trans_type,
               ^
[0m18:13:14.944391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1c4ea0-6b70-47cd-9632-4ec8e43bce0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa733e090>]}
[0m18:13:14.944852 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.03s]
[0m18:13:14.945287 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:13:14.946151 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:14.946351 [debug] [MainThread]: On master: BEGIN
[0m18:13:14.946527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:14.949428 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:13:14.949621 [debug] [MainThread]: On master: COMMIT
[0m18:13:14.949787 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:14.949949 [debug] [MainThread]: On master: COMMIT
[0m18:13:14.950197 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:14.950400 [debug] [MainThread]: On master: Close
[0m18:13:14.951121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:14.951314 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:13:14.951489 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:13:14.951673 [info ] [MainThread]: 
[0m18:13:14.951889 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m18:13:14.952240 [debug] [MainThread]: Command end result
[0m18:13:14.966965 [info ] [MainThread]: 
[0m18:13:14.967298 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:13:14.967615 [info ] [MainThread]: 
[0m18:13:14.967851 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "trans_type" not found in FROM clause!
  Candidate bindings: "source_data.trans_id", "source_data.tctype", "source_data.amount", "source_data.createdat"
  LINE 17:     trans_type,
               ^
[0m18:13:14.968024 [info ] [MainThread]: 
[0m18:13:14.968223 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:13:14.968788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5137363, "process_user_time": 0.884144, "process_kernel_time": 0.089636, "process_mem_max_rss": "251672", "process_out_blocks": "2677", "command_success": false, "process_in_blocks": "0"}
[0m18:13:14.969064 [debug] [MainThread]: Command `dbt run` failed at 18:13:14.969021 after 0.51 seconds
[0m18:13:14.969262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb641e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75a8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb039110>]}
[0m18:13:14.969485 [debug] [MainThread]: Flushing usage events
[0m18:14:16.723299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b83910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b88690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b88e90>]}


============================== 18:14:16.724478 | 12c20784-ea29-460a-b373-74d13149eac3 ==============================
[0m18:14:16.724478 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:14:16.724910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m18:14:16.796871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12c20784-ea29-460a-b373-74d13149eac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c233d0>]}
[0m18:14:16.814848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12c20784-ea29-460a-b373-74d13149eac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f8f290>]}
[0m18:14:16.815289 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:14:16.840201 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:14:16.884980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:14:16.885248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:14:16.901620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12c20784-ea29-460a-b373-74d13149eac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacfc7850>]}
[0m18:14:16.942515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12c20784-ea29-460a-b373-74d13149eac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd6bf50>]}
[0m18:14:16.942844 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:14:16.943160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c20784-ea29-460a-b373-74d13149eac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0a0a90>]}
[0m18:14:16.943938 [info ] [MainThread]: 
[0m18:14:16.944278 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:14:16.944764 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:14:16.957784 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:14:16.958026 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:14:16.958219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:16.962154 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:14:16.962698 [debug] [ThreadPool]: On list_thrive: Close
[0m18:14:16.963575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:14:16.963833 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:14:16.966354 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:14:16.966560 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:14:16.966749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:16.969601 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:14:16.970168 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:14:16.970531 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:14:16.970915 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:16.971174 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:14:16.971366 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:14:16.971672 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:16.972079 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:14:16.972256 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:14:16.972419 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:14:16.972689 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:16.972919 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:14:16.975495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:14:16.977468 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:14:16.977650 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:14:16.977826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:16.980579 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:14:16.980761 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:14:16.980959 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:14:16.989004 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:14:16.989598 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:14:16.989962 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:14:16.990133 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:14:16.991553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c20784-ea29-460a-b373-74d13149eac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0f9710>]}
[0m18:14:16.991810 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:16.992001 [debug] [MainThread]: On master: BEGIN
[0m18:14:16.992174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:16.995271 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:14:16.995592 [debug] [MainThread]: On master: COMMIT
[0m18:14:16.995810 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:16.995994 [debug] [MainThread]: On master: COMMIT
[0m18:14:16.996340 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:16.996568 [debug] [MainThread]: On master: Close
[0m18:14:16.997310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:16.997524 [info ] [MainThread]: 
[0m18:14:16.998778 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:14:16.999093 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:14:16.999378 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:14:16.999570 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:14:17.002433 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:14:17.002897 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:14:17.015298 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:14:17.017944 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:14:17.018204 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:14:17.018430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:17.021873 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:14:17.022082 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:14:17.022254 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:14:17.022699 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    trans_type,
    created_at,
    customer_id as customerid,
    amount,
    redeem_id::int as redeemid
from source_data
    );
  
  
[0m18:14:17.022901 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:14:17.023164 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: ROLLBACK
[0m18:14:17.024507 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.int_fifo_matched'
[0m18:14:17.024680 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:14:17.026112 [debug] [Thread-1 (]: Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "trans_type" not found in FROM clause!
  Candidate bindings: "source_data.trans_id", "source_data.tctype", "source_data.amount", "source_data.createdat"
  LINE 17:     trans_type,
               ^
[0m18:14:17.026793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c20784-ea29-460a-b373-74d13149eac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac234590>]}
[0m18:14:17.027117 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_fifo_matched .................... [[31mERROR[0m in 0.03s]
[0m18:14:17.027440 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:14:17.028517 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:17.028826 [debug] [MainThread]: On master: BEGIN
[0m18:14:17.029157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:17.032396 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:14:17.032649 [debug] [MainThread]: On master: COMMIT
[0m18:14:17.032881 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:17.033074 [debug] [MainThread]: On master: COMMIT
[0m18:14:17.033389 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:17.033640 [debug] [MainThread]: On master: Close
[0m18:14:17.034358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:17.034550 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:14:17.034742 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:14:17.034958 [info ] [MainThread]: 
[0m18:14:17.035179 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:14:17.035513 [debug] [MainThread]: Command end result
[0m18:14:17.049521 [info ] [MainThread]: 
[0m18:14:17.049821 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:14:17.050034 [info ] [MainThread]: 
[0m18:14:17.050351 [error] [MainThread]:   Runtime Error in model int_fifo_matched (models/intermediate/int_fifo_matched.sql)
  Binder Error: Referenced column "trans_type" not found in FROM clause!
  Candidate bindings: "source_data.trans_id", "source_data.tctype", "source_data.amount", "source_data.createdat"
  LINE 17:     trans_type,
               ^
[0m18:14:17.050771 [info ] [MainThread]: 
[0m18:14:17.051007 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:14:17.051449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34471393, "process_user_time": 0.704988, "process_kernel_time": 0.057324, "process_mem_max_rss": "251604", "process_out_blocks": "1814", "command_success": false, "process_in_blocks": "0"}
[0m18:14:17.051700 [debug] [MainThread]: Command `dbt run` failed at 18:14:17.051663 after 0.35 seconds
[0m18:14:17.051917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b8ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b8af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba7d9110>]}
[0m18:14:17.052105 [debug] [MainThread]: Flushing usage events
[0m18:16:21.867019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e6c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e6dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e6dc50>]}


============================== 18:16:21.868249 | 55e0fb28-8116-48ff-aaab-eaac5c00547b ==============================
[0m18:16:21.868249 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:16:21.868586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m18:16:21.938961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ed5250>]}
[0m18:16:21.956067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9323f4d0>]}
[0m18:16:21.956461 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:16:21.980359 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:16:22.024310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:22.024658 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:16:22.096017 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:16:22.096355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88174950>]}
[0m18:16:22.159937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881a8cd0>]}
[0m18:16:22.203652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8679fe50>]}
[0m18:16:22.203983 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:16:22.204232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881782d0>]}
[0m18:16:22.205030 [info ] [MainThread]: 
[0m18:16:22.205335 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:16:22.207411 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:16:22.245145 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:16:22.245460 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:16:22.245646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:22.250013 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:16:22.250659 [debug] [ThreadPool]: On list_thrive: Close
[0m18:16:22.251771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:16:22.252019 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:16:22.254558 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:16:22.254757 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:16:22.254956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:22.257816 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:16:22.258388 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:16:22.258565 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:16:22.258931 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:22.259182 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:16:22.259376 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:16:22.259676 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:22.260079 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:16:22.260274 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:16:22.260450 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:16:22.260819 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:22.261072 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:16:22.262135 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:16:22.264234 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:16:22.264437 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:16:22.264603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:22.267762 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:16:22.267987 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:16:22.268181 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:16:22.276354 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:16:22.276934 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:16:22.277287 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:16:22.277456 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:16:22.278911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85dfac50>]}
[0m18:16:22.279213 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:22.279443 [debug] [MainThread]: On master: BEGIN
[0m18:16:22.279662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:22.282627 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:16:22.282823 [debug] [MainThread]: On master: COMMIT
[0m18:16:22.283003 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:22.283168 [debug] [MainThread]: On master: COMMIT
[0m18:16:22.283540 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:22.283768 [debug] [MainThread]: On master: Close
[0m18:16:22.284652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:22.284928 [info ] [MainThread]: 
[0m18:16:22.286185 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m18:16:22.286480 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m18:16:22.286774 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m18:16:22.286964 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m18:16:22.289802 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m18:16:22.290395 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m18:16:22.301557 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m18:16:22.302252 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:16:22.302455 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m18:16:22.302641 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:16:22.305888 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:22.306100 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:16:22.306329 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m18:16:22.306682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.309074 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:16:22.309251 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:16:22.309525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.310541 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:16:22.310699 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:16:22.310926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.317711 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:16:22.317923 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:16:22.318124 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:16:22.318861 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:16:22.320690 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:16:22.320881 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m18:16:22.321366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.322346 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m18:16:22.324384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8806da50>]}
[0m18:16:22.324696 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m18:16:22.324961 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m18:16:22.325185 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m18:16:22.325474 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m18:16:22.325717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m18:16:22.325900 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m18:16:22.326955 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m18:16:22.327396 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m18:16:22.328754 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m18:16:22.329195 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:16:22.329473 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m18:16:22.329647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:22.332716 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:22.332938 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:16:22.333129 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m18:16:22.333474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.334607 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:16:22.334773 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m18:16:22.335020 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.336090 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:16:22.336266 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m18:16:22.336542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.337145 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:16:22.337306 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:16:22.337483 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:16:22.338011 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.338943 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:16:22.339119 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m18:16:22.339474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.339959 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m18:16:22.341783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85cd4ed0>]}
[0m18:16:22.342070 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m18:16:22.342342 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m18:16:22.342569 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m18:16:22.342824 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m18:16:22.343051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m18:16:22.343242 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m18:16:22.344329 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m18:16:22.344729 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m18:16:22.346004 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m18:16:22.346369 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:16:22.346545 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m18:16:22.346705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:22.349814 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:22.350020 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:16:22.350217 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as trans_id,
    "TCTYPE"::varchar as trans_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m18:16:22.350564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.351692 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:16:22.351857 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m18:16:22.352093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.353386 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:16:22.353571 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m18:16:22.353857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.354548 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:16:22.354730 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:16:22.354901 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:16:22.355440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.356324 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:16:22.356499 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m18:16:22.356840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:22.357354 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m18:16:22.358988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e0fb28-8116-48ff-aaab-eaac5c00547b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880c9d10>]}
[0m18:16:22.359253 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m18:16:22.359499 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m18:16:22.360179 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:22.360371 [debug] [MainThread]: On master: BEGIN
[0m18:16:22.360529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:22.363550 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:16:22.363723 [debug] [MainThread]: On master: COMMIT
[0m18:16:22.363854 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:22.363978 [debug] [MainThread]: On master: COMMIT
[0m18:16:22.364218 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:22.364398 [debug] [MainThread]: On master: Close
[0m18:16:22.365137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:22.365329 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m18:16:22.365482 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:16:22.365615 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m18:16:22.365790 [info ] [MainThread]: 
[0m18:16:22.365964 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:16:22.366344 [debug] [MainThread]: Command end result
[0m18:16:22.380768 [info ] [MainThread]: 
[0m18:16:22.380991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:22.381176 [info ] [MainThread]: 
[0m18:16:22.381371 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:16:22.381978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.531181, "process_user_time": 0.890316, "process_kernel_time": 0.050414, "process_mem_max_rss": "251492", "process_out_blocks": "4269", "process_in_blocks": "0"}
[0m18:16:22.382220 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:22.382184 after 0.53 seconds
[0m18:16:22.382417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bda150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bd8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bd8ed0>]}
[0m18:16:22.382592 [debug] [MainThread]: Flushing usage events
[0m18:16:25.006896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998f5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998d8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998f6910>]}


============================== 18:16:25.008081 | f512d340-9638-40be-962d-57090f519799 ==============================
[0m18:16:25.008081 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:16:25.008502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:16:25.076745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f512d340-9638-40be-962d-57090f519799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998f68d0>]}
[0m18:16:25.093824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f512d340-9638-40be-962d-57090f519799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcdf890>]}
[0m18:16:25.094218 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:16:25.118255 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:16:25.162214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:16:25.162481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:16:25.178936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f512d340-9638-40be-962d-57090f519799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9993b390>]}
[0m18:16:25.220363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f512d340-9638-40be-962d-57090f519799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ab7fd0>]}
[0m18:16:25.220671 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:16:25.220956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f512d340-9638-40be-962d-57090f519799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90deacd0>]}
[0m18:16:25.221677 [info ] [MainThread]: 
[0m18:16:25.222023 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:16:25.222539 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:16:25.235625 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:16:25.235882 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:16:25.236081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:25.240176 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:16:25.240730 [debug] [ThreadPool]: On list_thrive: Close
[0m18:16:25.241765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:16:25.242014 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:16:25.244560 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:16:25.244749 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:16:25.244915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:25.247699 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:16:25.248262 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:16:25.248468 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:16:25.248750 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:25.248918 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:16:25.249081 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:16:25.249420 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:25.249775 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:16:25.249965 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:16:25.250125 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:16:25.250608 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:25.250951 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:16:25.253684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:16:25.255819 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:16:25.255993 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:16:25.256175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:25.258965 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:16:25.259142 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:16:25.259323 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:16:25.267357 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:16:25.267970 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:16:25.268316 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:16:25.268481 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:16:25.269907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f512d340-9638-40be-962d-57090f519799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900fd090>]}
[0m18:16:25.270172 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:25.270372 [debug] [MainThread]: On master: BEGIN
[0m18:16:25.270558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:25.273490 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:16:25.273684 [debug] [MainThread]: On master: COMMIT
[0m18:16:25.273857 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:25.274025 [debug] [MainThread]: On master: COMMIT
[0m18:16:25.274529 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:25.274859 [debug] [MainThread]: On master: Close
[0m18:16:25.275566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:25.275795 [info ] [MainThread]: 
[0m18:16:25.277008 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:16:25.277316 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:16:25.277616 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:16:25.277807 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:16:25.280727 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:16:25.281285 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:16:25.293121 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:16:25.293874 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:16:25.294062 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:16:25.294309 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:16:25.297574 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:25.297802 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:16:25.297999 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    tctype as trans_type,
    createdat as created_at,
    customerid as customer_id,
    amount,
    redeemid::int as redeem_id
from source_data
    );
  
  
[0m18:16:25.298892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:16:25.301217 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:16:25.301407 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
alter table "thrive"."main"."int_fifo_matched__dbt_tmp" rename to "int_fifo_matched"
[0m18:16:25.301711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:25.308049 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m18:16:25.308273 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:16:25.308488 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m18:16:25.309229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:16:25.311010 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:16:25.311178 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
drop table if exists "thrive"."main"."int_fifo_matched__dbt_backup" cascade
[0m18:16:25.311465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:25.312423 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:16:25.315469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f512d340-9638-40be-962d-57090f519799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf7d7d0>]}
[0m18:16:25.315886 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.int_fifo_matched ........................ [[32mOK[0m in 0.04s]
[0m18:16:25.316202 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:16:25.316895 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:25.317100 [debug] [MainThread]: On master: BEGIN
[0m18:16:25.317274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:25.320420 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:16:25.320618 [debug] [MainThread]: On master: COMMIT
[0m18:16:25.320800 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:25.320962 [debug] [MainThread]: On master: COMMIT
[0m18:16:25.321206 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:25.321387 [debug] [MainThread]: On master: Close
[0m18:16:25.322203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:25.322458 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:16:25.322616 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:16:25.322769 [info ] [MainThread]: 
[0m18:16:25.322952 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:16:25.323266 [debug] [MainThread]: Command end result
[0m18:16:25.337733 [info ] [MainThread]: 
[0m18:16:25.338319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:25.338769 [info ] [MainThread]: 
[0m18:16:25.339025 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:16:25.339516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.34922057, "process_user_time": 0.720923, "process_kernel_time": 0.064993, "process_mem_max_rss": "251552", "process_out_blocks": "2848", "process_in_blocks": "0"}
[0m18:16:25.339754 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:25.339715 after 0.35 seconds
[0m18:16:25.339949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998d3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998d3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e67a150>]}
[0m18:16:25.340151 [debug] [MainThread]: Flushing usage events
[0m18:16:26.523295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa21cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac9a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa1e14d0>]}


============================== 18:16:26.524471 | acc031c6-f88a-43a0-bb80-867a1565d86e ==============================
[0m18:16:26.524471 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:16:26.524791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:16:26.592356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acc031c6-f88a-43a0-bb80-867a1565d86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa28c610>]}
[0m18:16:26.609578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acc031c6-f88a-43a0-bb80-867a1565d86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5f3110>]}
[0m18:16:26.609931 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:16:26.633970 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:16:26.677893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:16:26.678133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:16:26.694174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acc031c6-f88a-43a0-bb80-867a1565d86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa161b590>]}
[0m18:16:26.738346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acc031c6-f88a-43a0-bb80-867a1565d86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1481d90>]}
[0m18:16:26.738663 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:16:26.738864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acc031c6-f88a-43a0-bb80-867a1565d86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16fc6d0>]}
[0m18:16:26.739675 [info ] [MainThread]: 
[0m18:16:26.739984 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:16:26.742012 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:16:26.754496 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:16:26.754740 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:16:26.754921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:26.758754 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:16:26.758954 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:16:26.759143 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:16:26.767357 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:16:26.767982 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:16:26.768350 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:16:26.768539 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:16:26.770079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acc031c6-f88a-43a0-bb80-867a1565d86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa146fcd0>]}
[0m18:16:26.770346 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:26.770553 [debug] [MainThread]: On master: BEGIN
[0m18:16:26.770718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:26.773782 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:16:26.773975 [debug] [MainThread]: On master: COMMIT
[0m18:16:26.774146 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:26.774311 [debug] [MainThread]: On master: COMMIT
[0m18:16:26.774763 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:26.775061 [debug] [MainThread]: On master: Close
[0m18:16:26.775785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:26.776007 [info ] [MainThread]: 
[0m18:16:26.777160 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:16:26.777422 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_redeemid ........................... [RUN]
[0m18:16:26.777831 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718'
[0m18:16:26.778039 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:16:26.784290 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:16:26.784916 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:16:26.790267 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:16:26.790712 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:16:26.790881 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: BEGIN
[0m18:16:26.791040 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:16:26.794231 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:26.794425 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:16:26.794599 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select redeemid
from "thrive"."main"."int_fifo_matched"
where redeemid is null



      
    ) dbt_internal_test
[0m18:16:26.795000 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select redeemid
from "thrive"."main"."int_fifo_matched"
where redeemid is null



      
    ) dbt_internal_test
[0m18:16:26.795174 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:16:26.795366 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: ROLLBACK
[0m18:16:26.796881 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718'
[0m18:16:26.797089 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: Close
[0m18:16:26.798745 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 15: where redeemid is null
                 ^
[0m18:16:26.798984 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_redeemid ................................ [[31mERROR[0m in 0.02s]
[0m18:16:26.799254 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:16:26.799465 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:16:26.799907 [info ] [Thread-1 (]: 2 of 4 START test not_null_int_fifo_matched_trans_id ........................... [RUN]
[0m18:16:26.800130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718, now test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295)
[0m18:16:26.800301 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:16:26.801884 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:16:26.802286 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:16:26.803142 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:16:26.803555 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:16:26.803729 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: BEGIN
[0m18:16:26.803881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:26.806705 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:26.806903 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:16:26.807081 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trans_id
from "thrive"."main"."int_fifo_matched"
where trans_id is null



      
    ) dbt_internal_test
[0m18:16:26.807860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:16:26.809770 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: ROLLBACK
[0m18:16:26.809996 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m18:16:26.810161 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: Close
[0m18:16:26.810899 [info ] [Thread-1 (]: 2 of 4 PASS not_null_int_fifo_matched_trans_id ................................. [[32mPASS[0m in 0.01s]
[0m18:16:26.811180 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:16:26.811397 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:16:26.811608 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeemid ............................. [RUN]
[0m18:16:26.811819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295, now test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec)
[0m18:16:26.811996 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:16:26.814538 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:16:26.815059 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:16:26.815965 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:16:26.816441 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:16:26.816616 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: BEGIN
[0m18:16:26.816788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:26.819807 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:26.820140 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:16:26.820352 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeemid as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeemid is not null
group by redeemid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:26.820710 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeemid as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeemid is not null
group by redeemid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:26.820870 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:16:26.821052 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: ROLLBACK
[0m18:16:26.821975 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec'
[0m18:16:26.822134 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: Close
[0m18:16:26.823628 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 16: where redeemid is not null
                 ^
[0m18:16:26.823873 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeemid .................................. [[31mERROR[0m in 0.01s]
[0m18:16:26.824172 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:16:26.824402 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:16:26.824653 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_trans_id ............................. [RUN]
[0m18:16:26.824904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec, now test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b)
[0m18:16:26.825090 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:16:26.826873 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:16:26.827408 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:16:26.828266 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:16:26.828732 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:16:26.828913 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: BEGIN
[0m18:16:26.829085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:26.831779 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:26.831957 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:16:26.832145 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trans_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where trans_id is not null
group by trans_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:26.833467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:16:26.834140 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: ROLLBACK
[0m18:16:26.834377 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b'
[0m18:16:26.834551 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: Close
[0m18:16:26.835270 [info ] [Thread-1 (]: 4 of 4 PASS unique_int_fifo_matched_trans_id ................................... [[32mPASS[0m in 0.01s]
[0m18:16:26.835530 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:16:26.836138 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:26.836330 [debug] [MainThread]: On master: BEGIN
[0m18:16:26.836491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:26.839461 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:16:26.839678 [debug] [MainThread]: On master: COMMIT
[0m18:16:26.839888 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:26.840074 [debug] [MainThread]: On master: COMMIT
[0m18:16:26.840379 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:26.840547 [debug] [MainThread]: On master: Close
[0m18:16:26.841494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:26.841842 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:16:26.842047 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b' was properly closed.
[0m18:16:26.842263 [info ] [MainThread]: 
[0m18:16:26.842479 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:16:26.842922 [debug] [MainThread]: Command end result
[0m18:16:26.880765 [info ] [MainThread]: 
[0m18:16:26.881194 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:16:26.881492 [info ] [MainThread]: 
[0m18:16:26.881756 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 15: where redeemid is null
                 ^
[0m18:16:26.881960 [info ] [MainThread]: 
[0m18:16:26.882180 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 16: where redeemid is not null
                 ^
[0m18:16:26.882353 [info ] [MainThread]: 
[0m18:16:26.882524 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m18:16:26.882925 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.37607414, "process_user_time": 0.743077, "process_kernel_time": 0.055154, "process_mem_max_rss": "251628", "process_out_blocks": "1839", "command_success": false, "process_in_blocks": "0"}
[0m18:16:26.883162 [debug] [MainThread]: Command `dbt test` failed at 18:16:26.883130 after 0.38 seconds
[0m18:16:26.883355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee39250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee39310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad88b090>]}
[0m18:16:26.883541 [debug] [MainThread]: Flushing usage events
[0m18:17:28.723048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4d9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4d12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c273690>]}


============================== 18:17:28.724195 | 7ca538eb-837b-4985-b0e3-7283ef4756c0 ==============================
[0m18:17:28.724195 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:17:28.724512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select int_fifo_matched', 'send_anonymous_usage_stats': 'True'}
[0m18:17:28.791498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ca538eb-837b-4985-b0e3-7283ef4756c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4d3090>]}
[0m18:17:28.808554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ca538eb-837b-4985-b0e3-7283ef4756c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8df3d0>]}
[0m18:17:28.808961 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:17:28.832503 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:17:28.875768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:28.876006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:28.891842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ca538eb-837b-4985-b0e3-7283ef4756c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff728c2d10>]}
[0m18:17:28.935695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ca538eb-837b-4985-b0e3-7283ef4756c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72771c10>]}
[0m18:17:28.935993 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:17:28.936181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ca538eb-837b-4985-b0e3-7283ef4756c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72a3c090>]}
[0m18:17:28.936955 [info ] [MainThread]: 
[0m18:17:28.937302 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:17:28.939398 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:17:28.951738 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:17:28.952002 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:17:28.952181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:28.955995 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:17:28.956201 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:17:28.956401 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:17:28.964522 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:17:28.965159 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:17:28.965489 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:17:28.965661 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:17:28.967189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ca538eb-837b-4985-b0e3-7283ef4756c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b01bd0>]}
[0m18:17:28.967461 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:28.967638 [debug] [MainThread]: On master: BEGIN
[0m18:17:28.967801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:28.970850 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:17:28.971063 [debug] [MainThread]: On master: COMMIT
[0m18:17:28.971252 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:28.971413 [debug] [MainThread]: On master: COMMIT
[0m18:17:28.971855 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:28.972191 [debug] [MainThread]: On master: Close
[0m18:17:28.972924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:28.973167 [info ] [MainThread]: 
[0m18:17:28.974264 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:17:28.974531 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_redeemid ........................... [RUN]
[0m18:17:28.974950 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718'
[0m18:17:28.975148 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:17:28.981303 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:17:28.981840 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:17:28.986844 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:17:28.987265 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:17:28.987458 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: BEGIN
[0m18:17:28.987645 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:17:28.990788 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:17:28.990992 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:17:28.991204 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select redeemid
from "thrive"."main"."int_fifo_matched"
where redeemid is null



      
    ) dbt_internal_test
[0m18:17:28.991630 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select redeemid
from "thrive"."main"."int_fifo_matched"
where redeemid is null



      
    ) dbt_internal_test
[0m18:17:28.991816 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:17:28.992005 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: ROLLBACK
[0m18:17:28.993409 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718'
[0m18:17:28.993651 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: Close
[0m18:17:28.995368 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 15: where redeemid is null
                 ^
[0m18:17:28.995810 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_redeemid ................................ [[31mERROR[0m in 0.02s]
[0m18:17:28.996154 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:17:28.996374 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:17:28.996828 [info ] [Thread-1 (]: 2 of 4 START test not_null_int_fifo_matched_trans_id ........................... [RUN]
[0m18:17:28.997067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718, now test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295)
[0m18:17:28.997246 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:17:28.998851 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:17:28.999244 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:17:29.000195 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:17:29.000613 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:17:29.000829 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: BEGIN
[0m18:17:29.001035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:29.003970 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:17:29.004172 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:17:29.004342 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trans_id
from "thrive"."main"."int_fifo_matched"
where trans_id is null



      
    ) dbt_internal_test
[0m18:17:29.004982 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:17:29.006968 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: ROLLBACK
[0m18:17:29.007260 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m18:17:29.007431 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: Close
[0m18:17:29.008206 [info ] [Thread-1 (]: 2 of 4 PASS not_null_int_fifo_matched_trans_id ................................. [[32mPASS[0m in 0.01s]
[0m18:17:29.008508 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:17:29.008720 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:17:29.008943 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeemid ............................. [RUN]
[0m18:17:29.009186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295, now test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec)
[0m18:17:29.009387 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:17:29.012073 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:17:29.012535 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:17:29.013513 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:17:29.013916 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:17:29.014113 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: BEGIN
[0m18:17:29.014279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:29.017008 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:17:29.017237 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:17:29.017407 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeemid as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeemid is not null
group by redeemid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:17:29.017770 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeemid as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeemid is not null
group by redeemid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:17:29.017936 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:17:29.018136 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: ROLLBACK
[0m18:17:29.019160 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec'
[0m18:17:29.019352 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: Close
[0m18:17:29.020779 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 16: where redeemid is not null
                 ^
[0m18:17:29.021024 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeemid .................................. [[31mERROR[0m in 0.01s]
[0m18:17:29.021305 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:17:29.021522 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:17:29.021756 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_trans_id ............................. [RUN]
[0m18:17:29.021981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec, now test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b)
[0m18:17:29.022164 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:17:29.023768 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:17:29.024339 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:17:29.025333 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:17:29.025755 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:17:29.025954 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: BEGIN
[0m18:17:29.026140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:29.028862 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:17:29.029133 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:17:29.029311 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trans_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where trans_id is not null
group by trans_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:17:29.030554 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:17:29.031269 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: ROLLBACK
[0m18:17:29.031542 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b'
[0m18:17:29.031727 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: Close
[0m18:17:29.032462 [info ] [Thread-1 (]: 4 of 4 PASS unique_int_fifo_matched_trans_id ................................... [[32mPASS[0m in 0.01s]
[0m18:17:29.032739 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:17:29.033386 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:29.033554 [debug] [MainThread]: On master: BEGIN
[0m18:17:29.033708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:29.036803 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:17:29.037027 [debug] [MainThread]: On master: COMMIT
[0m18:17:29.037233 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:29.037413 [debug] [MainThread]: On master: COMMIT
[0m18:17:29.037790 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:29.038122 [debug] [MainThread]: On master: Close
[0m18:17:29.038979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:29.039218 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:17:29.039403 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b' was properly closed.
[0m18:17:29.039607 [info ] [MainThread]: 
[0m18:17:29.039809 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:17:29.040288 [debug] [MainThread]: Command end result
[0m18:17:29.077099 [info ] [MainThread]: 
[0m18:17:29.077362 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:17:29.077548 [info ] [MainThread]: 
[0m18:17:29.077848 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 15: where redeemid is null
                 ^
[0m18:17:29.078283 [info ] [MainThread]: 
[0m18:17:29.078598 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 16: where redeemid is not null
                 ^
[0m18:17:29.078813 [info ] [MainThread]: 
[0m18:17:29.079044 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m18:17:29.079476 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.372575, "process_user_time": 0.712024, "process_kernel_time": 0.071102, "process_mem_max_rss": "251632", "process_out_blocks": "1839", "command_success": false, "process_in_blocks": "0"}
[0m18:17:29.079699 [debug] [MainThread]: Command `dbt test` failed at 18:17:29.079661 after 0.37 seconds
[0m18:17:29.079909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8027e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4d3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4d3f90>]}
[0m18:17:29.080103 [debug] [MainThread]: Flushing usage events
[0m18:18:30.922679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90e9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90e9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92f65d0>]}


============================== 18:18:30.923845 | 32ac2946-314f-4463-9427-85a3107bff1a ==============================
[0m18:18:30.923845 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:18:30.924139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select int_fifo_matched', 'send_anonymous_usage_stats': 'True'}
[0m18:18:30.990897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32ac2946-314f-4463-9427-85a3107bff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb917c610>]}
[0m18:18:31.008047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32ac2946-314f-4463-9427-85a3107bff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb4ef450>]}
[0m18:18:31.008404 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:18:31.032194 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:18:31.075853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:18:31.076197 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/int_fifo_matched.sql
[0m18:18:31.146232 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:18:31.146552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '32ac2946-314f-4463-9427-85a3107bff1a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb91f1a10>]}
[0m18:18:31.204348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ac2946-314f-4463-9427-85a3107bff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03964d0>]}
[0m18:18:31.274862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ac2946-314f-4463-9427-85a3107bff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0311290>]}
[0m18:18:31.275188 [info ] [MainThread]: Found 5 models, 11 data tests, 4 sources, 421 macros
[0m18:18:31.275432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ac2946-314f-4463-9427-85a3107bff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb4c45d0>]}
[0m18:18:31.276331 [info ] [MainThread]: 
[0m18:18:31.276796 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:18:31.279019 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:18:31.292278 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:18:31.292526 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:18:31.292696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:31.296612 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:18:31.296862 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:18:31.297079 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:18:31.305349 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:18:31.306020 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:18:31.306373 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:18:31.306557 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:18:31.309457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ac2946-314f-4463-9427-85a3107bff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb049b790>]}
[0m18:18:31.309714 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:31.309909 [debug] [MainThread]: On master: BEGIN
[0m18:18:31.310072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:31.313242 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:18:31.313455 [debug] [MainThread]: On master: COMMIT
[0m18:18:31.313650 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:31.313815 [debug] [MainThread]: On master: COMMIT
[0m18:18:31.314233 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:18:31.314537 [debug] [MainThread]: On master: Close
[0m18:18:31.315643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:31.315914 [info ] [MainThread]: 
[0m18:18:31.317111 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:18:31.317363 [info ] [Thread-1 (]: 1 of 4 START test not_null_int_fifo_matched_redeemid ........................... [RUN]
[0m18:18:31.317669 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718'
[0m18:18:31.317889 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:18:31.323774 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:18:31.324294 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:18:31.329542 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:18:31.329994 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:18:31.330178 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: BEGIN
[0m18:18:31.330343 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:18:31.333507 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:18:31.333706 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"
[0m18:18:31.333882 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select redeemid
from "thrive"."main"."int_fifo_matched"
where redeemid is null



      
    ) dbt_internal_test
[0m18:18:31.334281 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select redeemid
from "thrive"."main"."int_fifo_matched"
where redeemid is null



      
    ) dbt_internal_test
[0m18:18:31.334471 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:18:31.334668 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: ROLLBACK
[0m18:18:31.336072 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718'
[0m18:18:31.336262 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718: Close
[0m18:18:31.337897 [debug] [Thread-1 (]: Runtime Error in test not_null_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 15: where redeemid is null
                 ^
[0m18:18:31.338171 [error] [Thread-1 (]: 1 of 4 ERROR not_null_int_fifo_matched_redeemid ................................ [[31mERROR[0m in 0.02s]
[0m18:18:31.338546 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718
[0m18:18:31.338787 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:18:31.339262 [info ] [Thread-1 (]: 2 of 4 START test not_null_int_fifo_matched_trans_id ........................... [RUN]
[0m18:18:31.339510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_redeemid.45541c8718, now test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295)
[0m18:18:31.339691 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:18:31.341660 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:18:31.342107 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:18:31.342981 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:18:31.343394 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:18:31.343612 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: BEGIN
[0m18:18:31.343795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:31.346595 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:18:31.346791 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:18:31.346961 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trans_id
from "thrive"."main"."int_fifo_matched"
where trans_id is null



      
    ) dbt_internal_test
[0m18:18:31.347445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:18:31.349243 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: ROLLBACK
[0m18:18:31.349471 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m18:18:31.349676 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: Close
[0m18:18:31.350452 [info ] [Thread-1 (]: 2 of 4 PASS not_null_int_fifo_matched_trans_id ................................. [[32mPASS[0m in 0.01s]
[0m18:18:31.350750 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:18:31.350964 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:18:31.351164 [info ] [Thread-1 (]: 3 of 4 START test unique_int_fifo_matched_redeemid ............................. [RUN]
[0m18:18:31.351370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295, now test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec)
[0m18:18:31.351558 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:18:31.354166 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:18:31.354593 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:18:31.355469 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:18:31.355864 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:18:31.356036 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: BEGIN
[0m18:18:31.356195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:31.358924 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:18:31.359108 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:18:31.359264 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeemid as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeemid is not null
group by redeemid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:31.359612 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeemid as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeemid is not null
group by redeemid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:31.359791 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:18:31.359989 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: ROLLBACK
[0m18:18:31.360982 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec'
[0m18:18:31.361164 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: Close
[0m18:18:31.362528 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 16: where redeemid is not null
                 ^
[0m18:18:31.362752 [error] [Thread-1 (]: 3 of 4 ERROR unique_int_fifo_matched_redeemid .................................. [[31mERROR[0m in 0.01s]
[0m18:18:31.363008 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:18:31.363229 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:18:31.363439 [info ] [Thread-1 (]: 4 of 4 START test unique_int_fifo_matched_trans_id ............................. [RUN]
[0m18:18:31.363650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec, now test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b)
[0m18:18:31.363823 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:18:31.365353 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:18:31.366030 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:18:31.366966 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:18:31.367325 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:18:31.367487 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: BEGIN
[0m18:18:31.367659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:31.370368 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:18:31.370566 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:18:31.370740 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trans_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where trans_id is not null
group by trans_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:31.371876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:18:31.372544 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: ROLLBACK
[0m18:18:31.372789 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b'
[0m18:18:31.372963 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: Close
[0m18:18:31.373811 [info ] [Thread-1 (]: 4 of 4 PASS unique_int_fifo_matched_trans_id ................................... [[32mPASS[0m in 0.01s]
[0m18:18:31.374187 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:18:31.374832 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:31.375020 [debug] [MainThread]: On master: BEGIN
[0m18:18:31.375204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:31.378241 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:18:31.378441 [debug] [MainThread]: On master: COMMIT
[0m18:18:31.378633 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:31.378831 [debug] [MainThread]: On master: COMMIT
[0m18:18:31.379097 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:18:31.379267 [debug] [MainThread]: On master: Close
[0m18:18:31.379988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:31.380152 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:18:31.380275 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b' was properly closed.
[0m18:18:31.380430 [info ] [MainThread]: 
[0m18:18:31.380613 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:18:31.381123 [debug] [MainThread]: Command end result
[0m18:18:31.395602 [info ] [MainThread]: 
[0m18:18:31.395826 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:18:31.396008 [info ] [MainThread]: 
[0m18:18:31.396266 [error] [MainThread]:   Runtime Error in test not_null_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 15: where redeemid is null
                 ^
[0m18:18:31.396637 [info ] [MainThread]: 
[0m18:18:31.397047 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 16: where redeemid is not null
                 ^
[0m18:18:31.397231 [info ] [MainThread]: 
[0m18:18:31.397397 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m18:18:31.397838 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.4916088, "process_user_time": 0.82922, "process_kernel_time": 0.085538, "process_mem_max_rss": "251624", "process_out_blocks": "2702", "command_success": false, "process_in_blocks": "0"}
[0m18:18:31.398072 [debug] [MainThread]: Command `dbt test` failed at 18:18:31.398041 after 0.49 seconds
[0m18:18:31.398251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90e9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9130250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbdd39250>]}
[0m18:18:31.398423 [debug] [MainThread]: Flushing usage events
[0m18:19:32.499925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad481350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad488690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadeb1890>]}


============================== 18:19:32.501079 | 2bbf12c6-be92-4144-b39d-fe2343a7f5bc ==============================
[0m18:19:32.501079 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:19:32.501506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select int_fifo_matched', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:19:32.568693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bbf12c6-be92-4144-b39d-fe2343a7f5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c52090>]}
[0m18:19:32.585749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bbf12c6-be92-4144-b39d-fe2343a7f5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8933d0>]}
[0m18:19:32.586098 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:19:32.610089 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:19:32.653207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:19:32.653589 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/schema.yml
[0m18:19:32.724549 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:19:32.725018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2bbf12c6-be92-4144-b39d-fe2343a7f5bc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c2ef90>]}
[0m18:19:32.782593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bbf12c6-be92-4144-b39d-fe2343a7f5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46def50>]}
[0m18:19:32.858963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bbf12c6-be92-4144-b39d-fe2343a7f5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46b11d0>]}
[0m18:19:32.859289 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:19:32.859604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bbf12c6-be92-4144-b39d-fe2343a7f5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eda7d10>]}
[0m18:19:32.860351 [info ] [MainThread]: 
[0m18:19:32.860693 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:19:32.862804 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:19:32.875002 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:19:32.875262 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:19:32.875452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:32.879508 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:19:32.879746 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:19:32.879948 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:19:32.888105 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:19:32.888736 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:19:32.889093 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:19:32.889268 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:19:32.890850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bbf12c6-be92-4144-b39d-fe2343a7f5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa467cdd0>]}
[0m18:19:32.891093 [debug] [MainThread]: Using duckdb connection "master"
[0m18:19:32.891262 [debug] [MainThread]: On master: BEGIN
[0m18:19:32.891427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:32.894613 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:19:32.894854 [debug] [MainThread]: On master: COMMIT
[0m18:19:32.895024 [debug] [MainThread]: Using duckdb connection "master"
[0m18:19:32.895195 [debug] [MainThread]: On master: COMMIT
[0m18:19:32.895566 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:19:32.895845 [debug] [MainThread]: On master: Close
[0m18:19:32.896602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:19:32.896931 [info ] [MainThread]: 
[0m18:19:32.898156 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:19:32.898397 [info ] [Thread-1 (]: 1 of 3 START test not_null_int_fifo_matched_trans_id ........................... [RUN]
[0m18:19:32.898709 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m18:19:32.898902 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:19:32.904998 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:19:32.905509 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:19:32.910737 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:19:32.911143 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:19:32.911331 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: BEGIN
[0m18:19:32.911493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:19:32.914780 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:19:32.915032 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:19:32.915230 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trans_id
from "thrive"."main"."int_fifo_matched"
where trans_id is null



      
    ) dbt_internal_test
[0m18:19:32.915725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:19:32.917733 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: ROLLBACK
[0m18:19:32.918066 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m18:19:32.918262 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: Close
[0m18:19:32.919071 [info ] [Thread-1 (]: 1 of 3 PASS not_null_int_fifo_matched_trans_id ................................. [[32mPASS[0m in 0.02s]
[0m18:19:32.919380 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:19:32.919608 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:19:32.919874 [info ] [Thread-1 (]: 2 of 3 START test unique_int_fifo_matched_redeemid ............................. [RUN]
[0m18:19:32.920116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295, now test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec)
[0m18:19:32.920306 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:19:32.923015 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:19:32.923396 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:19:32.924363 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:19:32.924766 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:19:32.924963 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: BEGIN
[0m18:19:32.925143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:32.927865 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:19:32.928059 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"
[0m18:19:32.928255 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeemid as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeemid is not null
group by redeemid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:32.928671 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeemid as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeemid is not null
group by redeemid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:32.928871 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:19:32.929086 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: ROLLBACK
[0m18:19:32.930415 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec'
[0m18:19:32.930585 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec: Close
[0m18:19:32.932016 [debug] [Thread-1 (]: Runtime Error in test unique_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 16: where redeemid is not null
                 ^
[0m18:19:32.932257 [error] [Thread-1 (]: 2 of 3 ERROR unique_int_fifo_matched_redeemid .................................. [[31mERROR[0m in 0.01s]
[0m18:19:32.932529 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec
[0m18:19:32.932734 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:19:32.933185 [info ] [Thread-1 (]: 3 of 3 START test unique_int_fifo_matched_trans_id ............................. [RUN]
[0m18:19:32.933402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeemid.0393239dec, now test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b)
[0m18:19:32.933585 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:19:32.935497 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:19:32.936003 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:19:32.936944 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:19:32.937411 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:19:32.937588 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: BEGIN
[0m18:19:32.937763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:32.940502 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:19:32.940750 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:19:32.940976 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trans_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where trans_id is not null
group by trans_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:32.942322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:19:32.943031 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: ROLLBACK
[0m18:19:32.943268 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b'
[0m18:19:32.943447 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: Close
[0m18:19:32.944182 [info ] [Thread-1 (]: 3 of 3 PASS unique_int_fifo_matched_trans_id ................................... [[32mPASS[0m in 0.01s]
[0m18:19:32.944468 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:19:32.945115 [debug] [MainThread]: Using duckdb connection "master"
[0m18:19:32.945288 [debug] [MainThread]: On master: BEGIN
[0m18:19:32.945425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:32.948504 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:19:32.948721 [debug] [MainThread]: On master: COMMIT
[0m18:19:32.948891 [debug] [MainThread]: Using duckdb connection "master"
[0m18:19:32.949038 [debug] [MainThread]: On master: COMMIT
[0m18:19:32.949324 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:19:32.949542 [debug] [MainThread]: On master: Close
[0m18:19:32.950345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:32.950572 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:19:32.950736 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b' was properly closed.
[0m18:19:32.950909 [info ] [MainThread]: 
[0m18:19:32.951090 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:19:32.951466 [debug] [MainThread]: Command end result
[0m18:19:32.965470 [info ] [MainThread]: 
[0m18:19:32.965714 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:19:32.965912 [info ] [MainThread]: 
[0m18:19:32.966203 [error] [MainThread]:   Runtime Error in test unique_int_fifo_matched_redeemid (models/intermediate/schema.yml)
  Binder Error: Referenced column "redeemid" not found in FROM clause!
  Candidate bindings: "int_fifo_matched.redeem_id", "int_fifo_matched.trans_id", "int_fifo_matched.created_at", "int_fifo_matched.customer_id"
  LINE 16: where redeemid is not null
                 ^
[0m18:19:32.966392 [info ] [MainThread]: 
[0m18:19:32.966568 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:19:32.967137 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.4834902, "process_user_time": 0.830557, "process_kernel_time": 0.071961, "process_mem_max_rss": "251628", "process_out_blocks": "2678", "command_success": false, "process_in_blocks": "0"}
[0m18:19:32.967364 [debug] [MainThread]: Command `dbt test` failed at 18:19:32.967332 after 0.48 seconds
[0m18:19:32.967548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad4a86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeadaa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb222dbd0>]}
[0m18:19:32.967741 [debug] [MainThread]: Flushing usage events
[0m18:25:10.853256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa02a4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0288690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0281190>]}


============================== 18:25:10.854517 | 0372fceb-c473-4821-840a-08aeacb427e7 ==============================
[0m18:25:10.854517 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:25:10.854831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m18:25:10.922600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0335e90>]}
[0m18:25:10.939715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa268f710>]}
[0m18:25:10.940085 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:25:10.964999 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:25:11.009337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:25:11.009731 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/schema.yml
[0m18:25:11.080690 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:25:11.081040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974cb710>]}
[0m18:25:11.138706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ca76d0>]}
[0m18:25:11.179174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bebdd0>]}
[0m18:25:11.179462 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:25:11.179658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d8f650>]}
[0m18:25:11.180456 [info ] [MainThread]: 
[0m18:25:11.180757 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:25:11.182826 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:25:11.218215 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:25:11.218532 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:25:11.218805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:11.223228 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:25:11.223807 [debug] [ThreadPool]: On list_thrive: Close
[0m18:25:11.224681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:25:11.224923 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:25:11.227367 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:11.227549 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:25:11.227715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:11.230765 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:25:11.231350 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:11.231544 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:25:11.231918 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:25:11.232198 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:11.232396 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:25:11.232680 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:25:11.233081 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:25:11.233258 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:11.233424 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:25:11.233684 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:25:11.233877 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:25:11.235156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:25:11.237235 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:25:11.237414 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:25:11.237576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:11.240844 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:25:11.241061 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:25:11.241260 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:25:11.249338 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:25:11.249936 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:25:11.250311 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:25:11.250498 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:25:11.252058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c5e110>]}
[0m18:25:11.252368 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:11.252566 [debug] [MainThread]: On master: BEGIN
[0m18:25:11.252736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:11.255943 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:25:11.256222 [debug] [MainThread]: On master: COMMIT
[0m18:25:11.256432 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:11.256605 [debug] [MainThread]: On master: COMMIT
[0m18:25:11.256863 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:25:11.257054 [debug] [MainThread]: On master: Close
[0m18:25:11.257791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:11.258023 [info ] [MainThread]: 
[0m18:25:11.259239 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m18:25:11.259532 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m18:25:11.259838 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m18:25:11.260035 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m18:25:11.262865 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m18:25:11.263416 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m18:25:11.274127 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m18:25:11.274704 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:25:11.274946 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m18:25:11.275297 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:11.278866 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:25:11.279064 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:25:11.279245 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m18:25:11.279595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.282023 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:25:11.282217 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:25:11.282481 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.283520 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:25:11.283680 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:25:11.283912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.290472 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:25:11.290684 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:25:11.290876 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:25:11.291589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:25:11.293309 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:25:11.293474 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m18:25:11.293844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.294824 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m18:25:11.297034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951087d0>]}
[0m18:25:11.297347 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m18:25:11.297622 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m18:25:11.297870 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m18:25:11.298133 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m18:25:11.298358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m18:25:11.298531 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m18:25:11.299609 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m18:25:11.300038 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m18:25:11.301324 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m18:25:11.301711 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:25:11.301888 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m18:25:11.302044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:11.305510 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:25:11.305734 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:25:11.305916 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m18:25:11.306260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.307448 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:25:11.307620 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m18:25:11.307862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.308865 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:25:11.309026 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m18:25:11.309280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.309854 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:25:11.310014 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:25:11.310168 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:25:11.310712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.311612 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:25:11.311771 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m18:25:11.312138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.312677 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m18:25:11.314427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9526f410>]}
[0m18:25:11.314677 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m18:25:11.314922 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m18:25:11.315161 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m18:25:11.315595 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m18:25:11.315824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m18:25:11.316005 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m18:25:11.317115 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m18:25:11.317535 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m18:25:11.318819 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m18:25:11.319187 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:25:11.319362 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m18:25:11.319530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:11.323110 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:25:11.323540 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:25:11.323735 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as trans_id,
    "TCTYPE"::varchar as trans_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m18:25:11.324081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.325340 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:25:11.325502 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m18:25:11.325757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.326792 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:25:11.326949 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m18:25:11.327212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.327849 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:25:11.328009 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:25:11.328153 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:25:11.328700 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.329578 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:25:11.329743 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m18:25:11.330123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:11.330591 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m18:25:11.332281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0372fceb-c473-4821-840a-08aeacb427e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95166d90>]}
[0m18:25:11.332550 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m18:25:11.332819 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m18:25:11.333595 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:11.333866 [debug] [MainThread]: On master: BEGIN
[0m18:25:11.334051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:11.337198 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:25:11.337377 [debug] [MainThread]: On master: COMMIT
[0m18:25:11.337531 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:11.337660 [debug] [MainThread]: On master: COMMIT
[0m18:25:11.337905 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:25:11.338092 [debug] [MainThread]: On master: Close
[0m18:25:11.338821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:11.338986 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m18:25:11.339151 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:25:11.339308 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m18:25:11.339498 [info ] [MainThread]: 
[0m18:25:11.339677 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:25:11.340102 [debug] [MainThread]: Command end result
[0m18:25:11.355237 [info ] [MainThread]: 
[0m18:25:11.355499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:11.355800 [info ] [MainThread]: 
[0m18:25:11.356052 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:25:11.356680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.520395, "process_user_time": 0.875343, "process_kernel_time": 0.062309, "process_mem_max_rss": "251568", "process_out_blocks": "4257", "process_in_blocks": "0"}
[0m18:25:11.356912 [debug] [MainThread]: Command `dbt run` succeeded at 18:25:11.356879 after 0.52 seconds
[0m18:25:11.357173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa02d2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977c6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05ffd10>]}
[0m18:25:11.357369 [debug] [MainThread]: Flushing usage events
[0m18:25:13.971203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82688b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82688690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826bc650>]}


============================== 18:25:13.972372 | 35731ab1-9860-45eb-a583-80cad70cb087 ==============================
[0m18:25:13.972372 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:25:13.972693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m18:25:14.040757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35731ab1-9860-45eb-a583-80cad70cb087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8271c810>]}
[0m18:25:14.057801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35731ab1-9860-45eb-a583-80cad70cb087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a930d0>]}
[0m18:25:14.058169 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:25:14.082106 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:25:14.125548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:25:14.125818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:25:14.142001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35731ab1-9860-45eb-a583-80cad70cb087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79abec10>]}
[0m18:25:14.182685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35731ab1-9860-45eb-a583-80cad70cb087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7985c790>]}
[0m18:25:14.182989 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:25:14.183219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35731ab1-9860-45eb-a583-80cad70cb087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79bd3150>]}
[0m18:25:14.183925 [info ] [MainThread]: 
[0m18:25:14.184286 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:25:14.184765 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:25:14.197514 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:25:14.197758 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:25:14.197938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:14.202200 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:25:14.202785 [debug] [ThreadPool]: On list_thrive: Close
[0m18:25:14.203862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:25:14.204145 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:25:14.206710 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:14.206899 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:25:14.207083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:14.210073 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:25:14.210615 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:14.210788 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:25:14.211074 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:25:14.211282 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:14.211486 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:25:14.212012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:25:14.212485 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:25:14.212675 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:14.212847 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:25:14.213194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:25:14.213431 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:25:14.216110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:25:14.218180 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:25:14.218355 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:25:14.218516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:14.221425 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:25:14.221620 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:25:14.221806 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:25:14.229752 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:25:14.230414 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:25:14.230771 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:25:14.230956 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:25:14.232441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35731ab1-9860-45eb-a583-80cad70cb087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8272c290>]}
[0m18:25:14.232672 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:14.232843 [debug] [MainThread]: On master: BEGIN
[0m18:25:14.233006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:14.236418 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:25:14.236719 [debug] [MainThread]: On master: COMMIT
[0m18:25:14.236899 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:14.237083 [debug] [MainThread]: On master: COMMIT
[0m18:25:14.237393 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:25:14.237582 [debug] [MainThread]: On master: Close
[0m18:25:14.238448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:14.238685 [info ] [MainThread]: 
[0m18:25:14.240335 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:25:14.240717 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:25:14.241372 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:25:14.242544 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:25:14.247273 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:25:14.248499 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:25:14.266331 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:25:14.267318 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:25:14.267621 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:25:14.267929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:14.271844 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:25:14.272131 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:25:14.272377 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    trans_type,
    created_at,
    customer_id,
    amount,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m18:25:14.273438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:25:14.276142 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:25:14.276439 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
alter table "thrive"."main"."int_fifo_matched" rename to "int_fifo_matched__dbt_backup"
[0m18:25:14.276934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:14.278377 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:25:14.278659 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
alter table "thrive"."main"."int_fifo_matched__dbt_tmp" rename to "int_fifo_matched"
[0m18:25:14.279195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:14.287137 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m18:25:14.287412 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:25:14.287643 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m18:25:14.288666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:25:14.290839 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:25:14.291088 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
drop table if exists "thrive"."main"."int_fifo_matched__dbt_backup" cascade
[0m18:25:14.291688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:14.292755 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:25:14.295988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35731ab1-9860-45eb-a583-80cad70cb087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78c720d0>]}
[0m18:25:14.296344 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.int_fifo_matched ........................ [[32mOK[0m in 0.05s]
[0m18:25:14.296637 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:25:14.297305 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:14.297509 [debug] [MainThread]: On master: BEGIN
[0m18:25:14.297705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:14.301538 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m18:25:14.301790 [debug] [MainThread]: On master: COMMIT
[0m18:25:14.302047 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:14.302220 [debug] [MainThread]: On master: COMMIT
[0m18:25:14.302511 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:25:14.302735 [debug] [MainThread]: On master: Close
[0m18:25:14.303544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:14.303788 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:25:14.303984 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:25:14.304178 [info ] [MainThread]: 
[0m18:25:14.304360 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m18:25:14.304655 [debug] [MainThread]: Command end result
[0m18:25:14.319632 [info ] [MainThread]: 
[0m18:25:14.320007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:14.320383 [info ] [MainThread]: 
[0m18:25:14.320632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:25:14.321086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.36640242, "process_user_time": 0.712809, "process_kernel_time": 0.064162, "process_mem_max_rss": "251636", "process_out_blocks": "2838", "process_in_blocks": "0"}
[0m18:25:14.321322 [debug] [MainThread]: Command `dbt run` succeeded at 18:25:14.321285 after 0.37 seconds
[0m18:25:14.321528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d12410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826bda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82683d50>]}
[0m18:25:14.321716 [debug] [MainThread]: Flushing usage events
[0m18:25:15.732115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5699290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5691550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56cc890>]}


============================== 18:25:15.733274 | 72d237bb-9476-4c0e-a826-a014b6ef3baa ==============================
[0m18:25:15.733274 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:25:15.733659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select int_fifo_matched', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:25:15.804430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72d237bb-9476-4c0e-a826-a014b6ef3baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5724650>]}
[0m18:25:15.821352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72d237bb-9476-4c0e-a826-a014b6ef3baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7aa2ed0>]}
[0m18:25:15.821749 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:25:15.845989 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:25:15.890020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:25:15.890284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:25:15.906335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72d237bb-9476-4c0e-a826-a014b6ef3baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc20110>]}
[0m18:25:15.950468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72d237bb-9476-4c0e-a826-a014b6ef3baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac92be50>]}
[0m18:25:15.950813 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:25:15.951148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d237bb-9476-4c0e-a826-a014b6ef3baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacba4f50>]}
[0m18:25:15.951910 [info ] [MainThread]: 
[0m18:25:15.952273 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:25:15.954211 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:25:15.967250 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:25:15.967478 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:25:15.967664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:15.971621 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:25:15.971828 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:25:15.972013 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:25:15.980200 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:25:15.980826 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:25:15.981168 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:25:15.981362 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:25:15.982943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d237bb-9476-4c0e-a826-a014b6ef3baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56e2d50>]}
[0m18:25:15.983193 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:15.983383 [debug] [MainThread]: On master: BEGIN
[0m18:25:15.983547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:15.986672 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:25:15.986872 [debug] [MainThread]: On master: COMMIT
[0m18:25:15.987052 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:15.987227 [debug] [MainThread]: On master: COMMIT
[0m18:25:15.987521 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:25:15.987701 [debug] [MainThread]: On master: Close
[0m18:25:15.988477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:15.988699 [info ] [MainThread]: 
[0m18:25:15.989883 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:25:15.990135 [info ] [Thread-1 (]: 1 of 3 START test not_null_int_fifo_matched_trans_id ........................... [RUN]
[0m18:25:15.990565 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m18:25:15.990785 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:25:15.997079 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:25:15.997644 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:25:16.002959 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:25:16.003453 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:25:16.003661 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: BEGIN
[0m18:25:16.003828 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:16.006990 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:25:16.007205 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:25:16.007432 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trans_id
from "thrive"."main"."int_fifo_matched"
where trans_id is null



      
    ) dbt_internal_test
[0m18:25:16.008011 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:25:16.010185 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: ROLLBACK
[0m18:25:16.010530 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m18:25:16.010736 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: Close
[0m18:25:16.011581 [info ] [Thread-1 (]: 1 of 3 PASS not_null_int_fifo_matched_trans_id ................................. [[32mPASS[0m in 0.02s]
[0m18:25:16.011937 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:25:16.012178 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m18:25:16.012420 [info ] [Thread-1 (]: 2 of 3 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m18:25:16.012663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m18:25:16.012854 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m18:25:16.015320 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m18:25:16.015723 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m18:25:16.016634 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m18:25:16.017014 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m18:25:16.017198 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m18:25:16.017359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:16.020174 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:25:16.020356 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m18:25:16.020520 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:25:16.021683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:25:16.022367 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m18:25:16.022636 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m18:25:16.022787 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m18:25:16.023540 [info ] [Thread-1 (]: 2 of 3 PASS unique_int_fifo_matched_redeem_id .................................. [[32mPASS[0m in 0.01s]
[0m18:25:16.023847 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m18:25:16.024060 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:25:16.024285 [info ] [Thread-1 (]: 3 of 3 START test unique_int_fifo_matched_trans_id ............................. [RUN]
[0m18:25:16.024520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b)
[0m18:25:16.024704 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:25:16.026236 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:25:16.026843 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:25:16.027794 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:25:16.028262 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:25:16.028485 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: BEGIN
[0m18:25:16.028666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:16.031633 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:25:16.031934 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:25:16.032116 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trans_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where trans_id is not null
group by trans_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:25:16.034801 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:25:16.035449 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: ROLLBACK
[0m18:25:16.035687 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b'
[0m18:25:16.035863 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: Close
[0m18:25:16.036597 [info ] [Thread-1 (]: 3 of 3 PASS unique_int_fifo_matched_trans_id ................................... [[32mPASS[0m in 0.01s]
[0m18:25:16.036866 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:25:16.037774 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:16.038025 [debug] [MainThread]: On master: BEGIN
[0m18:25:16.038209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:16.041091 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:25:16.041274 [debug] [MainThread]: On master: COMMIT
[0m18:25:16.041439 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:16.041598 [debug] [MainThread]: On master: COMMIT
[0m18:25:16.041937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:25:16.042121 [debug] [MainThread]: On master: Close
[0m18:25:16.044540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:16.044839 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:25:16.045045 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b' was properly closed.
[0m18:25:16.045258 [info ] [MainThread]: 
[0m18:25:16.045469 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:25:16.045866 [debug] [MainThread]: Command end result
[0m18:25:16.082144 [info ] [MainThread]: 
[0m18:25:16.082395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:16.082566 [info ] [MainThread]: 
[0m18:25:16.082755 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:25:16.083359 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.36826387, "process_user_time": 0.720821, "process_kernel_time": 0.068842, "process_mem_max_rss": "251648", "process_out_blocks": "1813", "process_in_blocks": "0"}
[0m18:25:16.083624 [debug] [MainThread]: Command `dbt test` succeeded at 18:25:16.083588 after 0.37 seconds
[0m18:25:16.083811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba43dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba43cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba43cb50>]}
[0m18:25:16.083999 [debug] [MainThread]: Flushing usage events
[0m18:25:17.710328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ac15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ac8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ac8b10>]}


============================== 18:25:17.711459 | 00799565-2465-408d-8e0a-48f19ea4c534 ==============================
[0m18:25:17.711459 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:25:17.711894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:25:17.779571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00799565-2465-408d-8e0a-48f19ea4c534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b11190>]}
[0m18:25:17.796557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00799565-2465-408d-8e0a-48f19ea4c534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ed3190>]}
[0m18:25:17.796914 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:25:17.821296 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:25:17.864457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:25:17.864702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:25:17.881359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00799565-2465-408d-8e0a-48f19ea4c534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c04c1d0>]}
[0m18:25:17.922338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00799565-2465-408d-8e0a-48f19ea4c534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc9c690>]}
[0m18:25:17.922606 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:25:17.922895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00799565-2465-408d-8e0a-48f19ea4c534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bfee6d0>]}
[0m18:25:17.923613 [info ] [MainThread]: 
[0m18:25:17.923951 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:25:17.924437 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:25:17.937677 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:25:17.937883 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:25:17.938093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:17.942326 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:25:17.942924 [debug] [ThreadPool]: On list_thrive: Close
[0m18:25:17.943885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:25:17.944140 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:25:17.946565 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:17.946768 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:25:17.946971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:17.949840 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:25:17.950408 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:17.950592 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:25:17.950896 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:25:17.951105 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:17.951326 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:25:17.951616 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:25:17.951980 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:25:17.952163 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:25:17.952328 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:25:17.952776 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:25:17.953103 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:25:17.955809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:25:17.957877 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:25:17.958056 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:25:17.958222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:17.960878 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:25:17.961078 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:25:17.961254 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:25:17.969283 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:25:17.969889 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:25:17.970233 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:25:17.970409 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:25:17.971858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00799565-2465-408d-8e0a-48f19ea4c534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b6f990>]}
[0m18:25:17.972113 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:17.972282 [debug] [MainThread]: On master: BEGIN
[0m18:25:17.972461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:17.975776 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:25:17.976107 [debug] [MainThread]: On master: COMMIT
[0m18:25:17.976306 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:17.976479 [debug] [MainThread]: On master: COMMIT
[0m18:25:17.976821 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:25:17.977083 [debug] [MainThread]: On master: Close
[0m18:25:17.977793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:17.978022 [info ] [MainThread]: 
[0m18:25:17.979231 [debug] [Thread-1 (]: Began running node model.thrive_market.finance_report
[0m18:25:17.979513 [info ] [Thread-1 (]: 1 of 1 START sql table model main.finance_report ............................... [RUN]
[0m18:25:17.979804 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.finance_report'
[0m18:25:17.980014 [debug] [Thread-1 (]: Began compiling node model.thrive_market.finance_report
[0m18:25:17.982936 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.finance_report"
[0m18:25:17.983668 [debug] [Thread-1 (]: Began executing node model.thrive_market.finance_report
[0m18:25:17.995947 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.finance_report"
[0m18:25:17.996803 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:25:17.997024 [debug] [Thread-1 (]: On model.thrive_market.finance_report: BEGIN
[0m18:25:17.997244 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:18.000740 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:25:18.001072 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:25:18.001269 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with base as (
    select 
        t.customer_id,
        t.amount,
        t.type,
        t.created_at
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.transaction_id = f.transaction_id
)

select
    customer_id,
    max(created_at) as last_transaction_date,
    sum(case when type = 'earned' then amount else 0 end) as cumulative_earned,
    sum(case when type = 'spent' then amount else 0 end) as cumulative_spent,
    sum(amount) as current_balance
from base
group by customer_id
    );
  
  
[0m18:25:18.001728 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with base as (
    select 
        t.customer_id,
        t.amount,
        t.type,
        t.created_at
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.transaction_id = f.transaction_id
)

select
    customer_id,
    max(created_at) as last_transaction_date,
    sum(case when type = 'earned' then amount else 0 end) as cumulative_earned,
    sum(case when type = 'spent' then amount else 0 end) as cumulative_spent,
    sum(amount) as current_balance
from base
group by customer_id
    );
  
  
[0m18:25:18.001920 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:25:18.002139 [debug] [Thread-1 (]: On model.thrive_market.finance_report: ROLLBACK
[0m18:25:18.003413 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.finance_report'
[0m18:25:18.003589 [debug] [Thread-1 (]: On model.thrive_market.finance_report: Close
[0m18:25:18.005003 [debug] [Thread-1 (]: Runtime Error in model finance_report (models/marts/finance_report.sql)
  Binder Error: Values list "t" does not have a column named "transaction_id"
  LINE 19:         on t.transaction_id = f.transaction_id
                      ^
[0m18:25:18.005637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00799565-2465-408d-8e0a-48f19ea4c534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854cd790>]}
[0m18:25:18.005972 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.finance_report ...................... [[31mERROR[0m in 0.03s]
[0m18:25:18.006288 [debug] [Thread-1 (]: Finished running node model.thrive_market.finance_report
[0m18:25:18.007205 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:18.007458 [debug] [MainThread]: On master: BEGIN
[0m18:25:18.007740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:18.010728 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:25:18.010949 [debug] [MainThread]: On master: COMMIT
[0m18:25:18.011127 [debug] [MainThread]: Using duckdb connection "master"
[0m18:25:18.011309 [debug] [MainThread]: On master: COMMIT
[0m18:25:18.011597 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:25:18.011790 [debug] [MainThread]: On master: Close
[0m18:25:18.012525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:18.012704 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:25:18.012901 [debug] [MainThread]: Connection 'model.thrive_market.finance_report' was properly closed.
[0m18:25:18.013108 [info ] [MainThread]: 
[0m18:25:18.013323 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:25:18.013653 [debug] [MainThread]: Command end result
[0m18:25:18.043037 [info ] [MainThread]: 
[0m18:25:18.045063 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:25:18.048039 [info ] [MainThread]: 
[0m18:25:18.048911 [error] [MainThread]:   Runtime Error in model finance_report (models/marts/finance_report.sql)
  Binder Error: Values list "t" does not have a column named "transaction_id"
  LINE 19:         on t.transaction_id = f.transaction_id
                      ^
[0m18:25:18.050473 [info ] [MainThread]: 
[0m18:25:18.051787 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:25:18.057507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36369157, "process_user_time": 0.683237, "process_kernel_time": 0.069226, "process_mem_max_rss": "251592", "process_out_blocks": "1807", "command_success": false, "process_in_blocks": "0"}
[0m18:25:18.058295 [debug] [MainThread]: Command `dbt run` failed at 18:25:18.058163 after 0.36 seconds
[0m18:25:18.058892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89719210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897192d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ac3d50>]}
[0m18:25:18.060461 [debug] [MainThread]: Flushing usage events
[0m18:26:20.015817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c70410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c28690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c21390>]}


============================== 18:26:20.017013 | 07e0c091-166b-4c0d-b720-9182e531545e ==============================
[0m18:26:20.017013 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:26:20.017367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select marts', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:26:20.085832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07e0c091-166b-4c0d-b720-9182e531545e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6cb47d0>]}
[0m18:26:20.103248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07e0c091-166b-4c0d-b720-9182e531545e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9033150>]}
[0m18:26:20.103612 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:26:20.127222 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:26:20.170669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:20.171019 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/intermediate/schema.yml
[0m18:26:20.206328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07e0c091-166b-4c0d-b720-9182e531545e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae167e50>]}
[0m18:26:20.247257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07e0c091-166b-4c0d-b720-9182e531545e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade7ffd0>]}
[0m18:26:20.247569 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:26:20.247754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07e0c091-166b-4c0d-b720-9182e531545e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaddfdd90>]}
[0m18:26:20.248491 [info ] [MainThread]: 
[0m18:26:20.248832 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:26:20.249345 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:26:20.262402 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:26:20.262641 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:26:20.262817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:20.266925 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:26:20.267466 [debug] [ThreadPool]: On list_thrive: Close
[0m18:26:20.268516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:26:20.268799 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:26:20.271290 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:26:20.271480 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:26:20.271651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:20.274662 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:26:20.275223 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:26:20.275413 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:26:20.275730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:26:20.275917 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:26:20.276106 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:26:20.276405 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:26:20.276755 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:26:20.276957 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:26:20.277121 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:26:20.277521 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:26:20.277843 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:26:20.280556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:26:20.282551 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:26:20.282730 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:26:20.282912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:20.285629 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:26:20.285842 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:26:20.286039 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:26:20.294010 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:26:20.294600 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:26:20.294970 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:26:20.295174 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:26:20.296593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07e0c091-166b-4c0d-b720-9182e531545e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c72350>]}
[0m18:26:20.296851 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:20.297101 [debug] [MainThread]: On master: BEGIN
[0m18:26:20.297276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:20.300241 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:26:20.300434 [debug] [MainThread]: On master: COMMIT
[0m18:26:20.300606 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:20.300771 [debug] [MainThread]: On master: COMMIT
[0m18:26:20.301217 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:26:20.301569 [debug] [MainThread]: On master: Close
[0m18:26:20.302270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:26:20.302487 [info ] [MainThread]: 
[0m18:26:20.303755 [debug] [Thread-1 (]: Began running node model.thrive_market.finance_report
[0m18:26:20.304087 [info ] [Thread-1 (]: 1 of 1 START sql table model main.finance_report ............................... [RUN]
[0m18:26:20.304382 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.finance_report'
[0m18:26:20.304583 [debug] [Thread-1 (]: Began compiling node model.thrive_market.finance_report
[0m18:26:20.307554 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.finance_report"
[0m18:26:20.308153 [debug] [Thread-1 (]: Began executing node model.thrive_market.finance_report
[0m18:26:20.319446 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.finance_report"
[0m18:26:20.320180 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:26:20.320391 [debug] [Thread-1 (]: On model.thrive_market.finance_report: BEGIN
[0m18:26:20.320575 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:26:20.323895 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:26:20.324104 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:26:20.324282 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with base as (
    select 
        t.customer_id,
        t.amount,
        t.type,
        t.created_at
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.transaction_id = f.transaction_id
)

select
    customer_id,
    max(created_at) as last_transaction_date,
    sum(case when type = 'earned' then amount else 0 end) as cumulative_earned,
    sum(case when type = 'spent' then amount else 0 end) as cumulative_spent,
    sum(amount) as current_balance
from base
group by customer_id
    );
  
  
[0m18:26:20.324750 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with base as (
    select 
        t.customer_id,
        t.amount,
        t.type,
        t.created_at
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.transaction_id = f.transaction_id
)

select
    customer_id,
    max(created_at) as last_transaction_date,
    sum(case when type = 'earned' then amount else 0 end) as cumulative_earned,
    sum(case when type = 'spent' then amount else 0 end) as cumulative_spent,
    sum(amount) as current_balance
from base
group by customer_id
    );
  
  
[0m18:26:20.324963 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:26:20.325181 [debug] [Thread-1 (]: On model.thrive_market.finance_report: ROLLBACK
[0m18:26:20.326463 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.finance_report'
[0m18:26:20.326635 [debug] [Thread-1 (]: On model.thrive_market.finance_report: Close
[0m18:26:20.328140 [debug] [Thread-1 (]: Runtime Error in model finance_report (models/marts/finance_report.sql)
  Binder Error: Values list "t" does not have a column named "transaction_id"
  LINE 19:         on t.transaction_id = f.transaction_id
                      ^
[0m18:26:20.328766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e0c091-166b-4c0d-b720-9182e531545e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1e03d0>]}
[0m18:26:20.329119 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.finance_report ...................... [[31mERROR[0m in 0.02s]
[0m18:26:20.329442 [debug] [Thread-1 (]: Finished running node model.thrive_market.finance_report
[0m18:26:20.330296 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:20.330504 [debug] [MainThread]: On master: BEGIN
[0m18:26:20.330673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:20.333953 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:26:20.334164 [debug] [MainThread]: On master: COMMIT
[0m18:26:20.334346 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:20.334511 [debug] [MainThread]: On master: COMMIT
[0m18:26:20.334752 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:26:20.334941 [debug] [MainThread]: On master: Close
[0m18:26:20.335654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:20.335826 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:26:20.336044 [debug] [MainThread]: Connection 'model.thrive_market.finance_report' was properly closed.
[0m18:26:20.336228 [info ] [MainThread]: 
[0m18:26:20.336449 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:26:20.336798 [debug] [MainThread]: Command end result
[0m18:26:20.374232 [info ] [MainThread]: 
[0m18:26:20.374497 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:26:20.374700 [info ] [MainThread]: 
[0m18:26:20.375028 [error] [MainThread]:   Runtime Error in model finance_report (models/marts/finance_report.sql)
  Binder Error: Values list "t" does not have a column named "transaction_id"
  LINE 19:         on t.transaction_id = f.transaction_id
                      ^
[0m18:26:20.375428 [info ] [MainThread]: 
[0m18:26:20.375666 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:26:20.376095 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3769858, "process_user_time": 0.728459, "process_kernel_time": 0.059037, "process_mem_max_rss": "251616", "process_out_blocks": "2668", "command_success": false, "process_in_blocks": "0"}
[0m18:26:20.376329 [debug] [MainThread]: Command `dbt run` failed at 18:26:20.376290 after 0.38 seconds
[0m18:26:20.376533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade20910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade20750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad358190>]}
[0m18:26:20.376702 [debug] [MainThread]: Flushing usage events
[0m18:27:22.263747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1877410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1718690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1718e90>]}


============================== 18:27:22.264899 | 5031cba0-6872-4939-aa24-359580cbd556 ==============================
[0m18:27:22.264899 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:27:22.265328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select marts', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:27:22.332370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5031cba0-6872-4939-aa24-359580cbd556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1922f50>]}
[0m18:27:22.349362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5031cba0-6872-4939-aa24-359580cbd556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b1f5d0>]}
[0m18:27:22.349708 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:27:22.373616 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:27:22.416806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:22.417125 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/marts/finance_report.sql
[0m18:27:22.496910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5031cba0-6872-4939-aa24-359580cbd556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c2d110>]}
[0m18:27:22.536974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5031cba0-6872-4939-aa24-359580cbd556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30f3f10>]}
[0m18:27:22.537259 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:27:22.537553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5031cba0-6872-4939-aa24-359580cbd556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d2da50>]}
[0m18:27:22.538299 [info ] [MainThread]: 
[0m18:27:22.538629 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:27:22.539098 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:27:22.551597 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:27:22.551820 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:27:22.552004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:22.556253 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:27:22.556792 [debug] [ThreadPool]: On list_thrive: Close
[0m18:27:22.557788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:27:22.558039 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:27:22.560621 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:27:22.560799 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:27:22.560969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:22.563761 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:27:22.564356 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:27:22.564537 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:27:22.564828 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:27:22.565011 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:27:22.565210 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:27:22.565518 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:27:22.565940 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:27:22.566138 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:27:22.566316 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:27:22.566775 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:27:22.567080 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:27:22.569745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:27:22.594584 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:27:22.594902 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:27:22.595183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:22.598503 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:27:22.598702 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:27:22.598879 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:27:22.606893 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:27:22.607537 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:27:22.607887 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:27:22.608073 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:27:22.609565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5031cba0-6872-4939-aa24-359580cbd556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a2d210>]}
[0m18:27:22.609809 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:22.610041 [debug] [MainThread]: On master: BEGIN
[0m18:27:22.610226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:22.613257 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:27:22.613494 [debug] [MainThread]: On master: COMMIT
[0m18:27:22.613681 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:22.613866 [debug] [MainThread]: On master: COMMIT
[0m18:27:22.614265 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:27:22.614455 [debug] [MainThread]: On master: Close
[0m18:27:22.615357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:22.615583 [info ] [MainThread]: 
[0m18:27:22.616737 [debug] [Thread-1 (]: Began running node model.thrive_market.finance_report
[0m18:27:22.617044 [info ] [Thread-1 (]: 1 of 1 START sql table model main.finance_report ............................... [RUN]
[0m18:27:22.617467 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.finance_report'
[0m18:27:22.617706 [debug] [Thread-1 (]: Began compiling node model.thrive_market.finance_report
[0m18:27:22.621284 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.finance_report"
[0m18:27:22.622007 [debug] [Thread-1 (]: Began executing node model.thrive_market.finance_report
[0m18:27:22.633989 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.finance_report"
[0m18:27:22.634708 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:27:22.634946 [debug] [Thread-1 (]: On model.thrive_market.finance_report: BEGIN
[0m18:27:22.635132 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:27:22.638221 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:27:22.638419 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:27:22.638630 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with base as (
    select 
        t.customer_id,
        t.amount,
        t.trans_type,
        t.created_at
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.transaction_id = f.transaction_id
)

select
    customer_id,
    max(created_at) as last_transaction_date,
    sum(case when type = 'earned' then amount else 0 end) as cumulative_earned,
    sum(case when type = 'spent' then amount else 0 end) as cumulative_spent,
    sum(amount) as current_balance
from base
group by customer_id
    );
  
  
[0m18:27:22.639121 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with base as (
    select 
        t.customer_id,
        t.amount,
        t.trans_type,
        t.created_at
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.transaction_id = f.transaction_id
)

select
    customer_id,
    max(created_at) as last_transaction_date,
    sum(case when type = 'earned' then amount else 0 end) as cumulative_earned,
    sum(case when type = 'spent' then amount else 0 end) as cumulative_spent,
    sum(amount) as current_balance
from base
group by customer_id
    );
  
  
[0m18:27:22.639315 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:27:22.639530 [debug] [Thread-1 (]: On model.thrive_market.finance_report: ROLLBACK
[0m18:27:22.640804 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.finance_report'
[0m18:27:22.640985 [debug] [Thread-1 (]: On model.thrive_market.finance_report: Close
[0m18:27:22.642407 [debug] [Thread-1 (]: Runtime Error in model finance_report (models/marts/finance_report.sql)
  Binder Error: Values list "t" does not have a column named "transaction_id"
  LINE 19:         on t.transaction_id = f.transaction_id
                      ^
[0m18:27:22.643075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5031cba0-6872-4939-aa24-359580cbd556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa310e790>]}
[0m18:27:22.643379 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.finance_report ...................... [[31mERROR[0m in 0.03s]
[0m18:27:22.643668 [debug] [Thread-1 (]: Finished running node model.thrive_market.finance_report
[0m18:27:22.644562 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:22.644757 [debug] [MainThread]: On master: BEGIN
[0m18:27:22.644945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:22.648264 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:27:22.648565 [debug] [MainThread]: On master: COMMIT
[0m18:27:22.648758 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:22.648920 [debug] [MainThread]: On master: COMMIT
[0m18:27:22.649266 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:27:22.649499 [debug] [MainThread]: On master: Close
[0m18:27:22.650359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:22.650611 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:27:22.650788 [debug] [MainThread]: Connection 'model.thrive_market.finance_report' was properly closed.
[0m18:27:22.650974 [info ] [MainThread]: 
[0m18:27:22.651204 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m18:27:22.651550 [debug] [MainThread]: Command end result
[0m18:27:22.665758 [info ] [MainThread]: 
[0m18:27:22.666002 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:27:22.666267 [info ] [MainThread]: 
[0m18:27:22.666604 [error] [MainThread]:   Runtime Error in model finance_report (models/marts/finance_report.sql)
  Binder Error: Values list "t" does not have a column named "transaction_id"
  LINE 19:         on t.transaction_id = f.transaction_id
                      ^
[0m18:27:22.666832 [info ] [MainThread]: 
[0m18:27:22.667029 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:27:22.667529 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4200074, "process_user_time": 0.779802, "process_kernel_time": 0.056492, "process_mem_max_rss": "251672", "process_out_blocks": "2668", "command_success": false, "process_in_blocks": "0"}
[0m18:27:22.667783 [debug] [MainThread]: Command `dbt run` failed at 18:27:22.667745 after 0.42 seconds
[0m18:27:22.667987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6369210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1710b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b43350>]}
[0m18:27:22.668178 [debug] [MainThread]: Flushing usage events
[0m18:28:24.541303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac812f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7fc4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc73ad0>]}


============================== 18:28:24.542431 | 7f52c868-e479-4e68-bf19-c67cf3ae6189 ==============================
[0m18:28:24.542431 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:28:24.542830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select marts', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:28:24.609712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f52c868-e479-4e68-bf19-c67cf3ae6189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f93f10>]}
[0m18:28:24.627043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f52c868-e479-4e68-bf19-c67cf3ae6189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaebd2c50>]}
[0m18:28:24.627526 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:28:24.652089 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:28:24.695479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:28:24.695723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:28:24.711692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f52c868-e479-4e68-bf19-c67cf3ae6189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac8604d0>]}
[0m18:28:24.752346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f52c868-e479-4e68-bf19-c67cf3ae6189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa399c150>]}
[0m18:28:24.752677 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:28:24.753017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f52c868-e479-4e68-bf19-c67cf3ae6189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac868450>]}
[0m18:28:24.753779 [info ] [MainThread]: 
[0m18:28:24.754138 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:28:24.754638 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:28:24.767359 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:28:24.767581 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:28:24.767762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:24.771894 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:28:24.772469 [debug] [ThreadPool]: On list_thrive: Close
[0m18:28:24.773443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:28:24.773703 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:28:24.776176 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:28:24.776384 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:28:24.776551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:24.779439 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:28:24.779966 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:28:24.780158 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:28:24.780464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:24.780648 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:28:24.780814 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:28:24.781106 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:24.781525 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:28:24.781706 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:28:24.781873 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:28:24.782181 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:24.782394 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:28:24.785312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:28:24.787373 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:28:24.787553 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:28:24.787721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:24.790433 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:28:24.790620 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:28:24.790788 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:28:24.798758 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:28:24.799328 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:28:24.799658 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:28:24.799824 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:28:24.801245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f52c868-e479-4e68-bf19-c67cf3ae6189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d31f90>]}
[0m18:28:24.801484 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:24.801656 [debug] [MainThread]: On master: BEGIN
[0m18:28:24.801818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:24.804778 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:28:24.804976 [debug] [MainThread]: On master: COMMIT
[0m18:28:24.805209 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:24.805399 [debug] [MainThread]: On master: COMMIT
[0m18:28:24.805667 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:28:24.805868 [debug] [MainThread]: On master: Close
[0m18:28:24.806863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:24.807228 [info ] [MainThread]: 
[0m18:28:24.808470 [debug] [Thread-1 (]: Began running node model.thrive_market.finance_report
[0m18:28:24.808751 [info ] [Thread-1 (]: 1 of 1 START sql table model main.finance_report ............................... [RUN]
[0m18:28:24.809080 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.finance_report'
[0m18:28:24.809272 [debug] [Thread-1 (]: Began compiling node model.thrive_market.finance_report
[0m18:28:24.812202 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.finance_report"
[0m18:28:24.812688 [debug] [Thread-1 (]: Began executing node model.thrive_market.finance_report
[0m18:28:24.825177 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.finance_report"
[0m18:28:24.825743 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:28:24.825936 [debug] [Thread-1 (]: On model.thrive_market.finance_report: BEGIN
[0m18:28:24.826134 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:24.829078 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:28:24.829300 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:28:24.829493 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with base as (
    select 
        t.customer_id,
        t.amount,
        t.trans_type,
        t.created_at
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.transaction_id = f.transaction_id
)

select
    customer_id,
    max(created_at) as last_transaction_date,
    sum(case when type = 'earned' then amount else 0 end) as cumulative_earned,
    sum(case when type = 'spent' then amount else 0 end) as cumulative_spent,
    sum(amount) as current_balance
from base
group by customer_id
    );
  
  
[0m18:28:24.829960 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with base as (
    select 
        t.customer_id,
        t.amount,
        t.trans_type,
        t.created_at
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.transaction_id = f.transaction_id
)

select
    customer_id,
    max(created_at) as last_transaction_date,
    sum(case when type = 'earned' then amount else 0 end) as cumulative_earned,
    sum(case when type = 'spent' then amount else 0 end) as cumulative_spent,
    sum(amount) as current_balance
from base
group by customer_id
    );
  
  
[0m18:28:24.830177 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:28:24.830423 [debug] [Thread-1 (]: On model.thrive_market.finance_report: ROLLBACK
[0m18:28:24.831706 [debug] [Thread-1 (]: Failed to rollback 'model.thrive_market.finance_report'
[0m18:28:24.831874 [debug] [Thread-1 (]: On model.thrive_market.finance_report: Close
[0m18:28:24.833268 [debug] [Thread-1 (]: Runtime Error in model finance_report (models/marts/finance_report.sql)
  Binder Error: Values list "t" does not have a column named "transaction_id"
  LINE 19:         on t.transaction_id = f.transaction_id
                      ^
[0m18:28:24.833889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f52c868-e479-4e68-bf19-c67cf3ae6189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ea0d10>]}
[0m18:28:24.834191 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.finance_report ...................... [[31mERROR[0m in 0.02s]
[0m18:28:24.834466 [debug] [Thread-1 (]: Finished running node model.thrive_market.finance_report
[0m18:28:24.835279 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:24.835459 [debug] [MainThread]: On master: BEGIN
[0m18:28:24.835631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:24.838762 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:28:24.839081 [debug] [MainThread]: On master: COMMIT
[0m18:28:24.839291 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:24.839463 [debug] [MainThread]: On master: COMMIT
[0m18:28:24.839717 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:28:24.839893 [debug] [MainThread]: On master: Close
[0m18:28:24.840617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:24.840792 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:28:24.840952 [debug] [MainThread]: Connection 'model.thrive_market.finance_report' was properly closed.
[0m18:28:24.841163 [info ] [MainThread]: 
[0m18:28:24.841386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:28:24.841708 [debug] [MainThread]: Command end result
[0m18:28:24.855075 [info ] [MainThread]: 
[0m18:28:24.855322 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:28:24.855500 [info ] [MainThread]: 
[0m18:28:24.855707 [error] [MainThread]:   Runtime Error in model finance_report (models/marts/finance_report.sql)
  Binder Error: Values list "t" does not have a column named "transaction_id"
  LINE 19:         on t.transaction_id = f.transaction_id
                      ^
[0m18:28:24.855895 [info ] [MainThread]: 
[0m18:28:24.856076 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:28:24.856776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.33182558, "process_user_time": 0.679254, "process_kernel_time": 0.059548, "process_mem_max_rss": "251620", "process_out_blocks": "1807", "command_success": false, "process_in_blocks": "0"}
[0m18:28:24.857005 [debug] [MainThread]: Command `dbt run` failed at 18:28:24.856971 after 0.33 seconds
[0m18:28:24.857258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca0a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7fe050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1419210>]}
[0m18:28:24.857457 [debug] [MainThread]: Flushing usage events
[0m18:34:35.084556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b69250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b68690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b68e90>]}


============================== 18:34:35.086010 | 61b4cd1d-64bd-4b5a-a331-28693d9e75bb ==============================
[0m18:34:35.086010 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:34:35.086437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:34:35.159852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61b4cd1d-64bd-4b5a-a331-28693d9e75bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c0eb50>]}
[0m18:34:35.177231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61b4cd1d-64bd-4b5a-a331-28693d9e75bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f73350>]}
[0m18:34:35.177674 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:34:35.201742 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:34:35.245720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:35.246063 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/marts/finance_report.sql
[0m18:34:35.325848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61b4cd1d-64bd-4b5a-a331-28693d9e75bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f005e90>]}
[0m18:34:35.365843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61b4cd1d-64bd-4b5a-a331-28693d9e75bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5dbed0>]}
[0m18:34:35.366120 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:34:35.366418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b4cd1d-64bd-4b5a-a331-28693d9e75bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9edfe4d0>]}
[0m18:34:35.367188 [info ] [MainThread]: 
[0m18:34:35.367517 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:34:35.369391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:34:35.382654 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:34:35.382921 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:34:35.383121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:35.387613 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:34:35.388178 [debug] [ThreadPool]: On list_thrive: Close
[0m18:34:35.389251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:34:35.389609 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:34:35.392488 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:35.392704 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:34:35.392851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:35.395800 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:34:35.396359 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:35.396538 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:34:35.396793 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:34:35.396989 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:35.397143 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:34:35.397404 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:34:35.397798 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:34:35.397952 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:35.398110 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:34:35.398470 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:34:35.398753 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:34:35.399855 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:34:35.424607 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:34:35.424898 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:34:35.425074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:35.428719 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:34:35.428909 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:34:35.429092 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:34:35.437717 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:34:35.438417 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:34:35.438825 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:34:35.439008 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:34:35.440428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b4cd1d-64bd-4b5a-a331-28693d9e75bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef18cd0>]}
[0m18:34:35.440675 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:35.440850 [debug] [MainThread]: On master: BEGIN
[0m18:34:35.441015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:35.444038 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:34:35.444248 [debug] [MainThread]: On master: COMMIT
[0m18:34:35.444416 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:35.444623 [debug] [MainThread]: On master: COMMIT
[0m18:34:35.445075 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:34:35.445372 [debug] [MainThread]: On master: Close
[0m18:34:35.446300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:35.446676 [info ] [MainThread]: 
[0m18:34:35.447818 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m18:34:35.448096 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m18:34:35.448418 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m18:34:35.448647 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m18:34:35.451557 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m18:34:35.452094 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m18:34:35.462970 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m18:34:35.463635 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:34:35.463854 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m18:34:35.464041 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:35.467171 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:34:35.467369 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:34:35.467559 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m18:34:35.467903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.470302 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:34:35.470489 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:34:35.470762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.471850 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:34:35.472019 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:34:35.472244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.478227 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:34:35.478433 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:34:35.478631 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m18:34:35.479350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:35.481107 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m18:34:35.481297 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m18:34:35.481749 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.482665 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m18:34:35.484940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b4cd1d-64bd-4b5a-a331-28693d9e75bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f34fe90>]}
[0m18:34:35.485230 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m18:34:35.485503 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m18:34:35.485721 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m18:34:35.485987 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m18:34:35.486204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m18:34:35.486375 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m18:34:35.487504 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m18:34:35.487938 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m18:34:35.489244 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m18:34:35.489920 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:34:35.490219 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m18:34:35.490427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:35.493808 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:34:35.494149 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:34:35.494359 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m18:34:35.494718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.496795 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:34:35.496978 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m18:34:35.497235 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.498270 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:34:35.498428 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m18:34:35.498670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.499236 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:34:35.499391 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:34:35.499583 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m18:34:35.500155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.501188 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m18:34:35.501454 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m18:34:35.501873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.502349 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m18:34:35.504157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b4cd1d-64bd-4b5a-a331-28693d9e75bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa906e510>]}
[0m18:34:35.504464 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m18:34:35.504724 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m18:34:35.504938 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m18:34:35.505199 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m18:34:35.505435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m18:34:35.505643 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m18:34:35.506727 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m18:34:35.507122 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m18:34:35.508479 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m18:34:35.508857 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:34:35.509049 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m18:34:35.509232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:35.512247 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:34:35.512545 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:34:35.512751 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as trans_id,
    "TCTYPE"::varchar as trans_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m18:34:35.513112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.514270 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:34:35.514441 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m18:34:35.514877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.516173 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:34:35.516356 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m18:34:35.516619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.517263 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:34:35.517419 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:34:35.517596 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m18:34:35.518144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.519036 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m18:34:35.519193 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m18:34:35.519542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:35.520000 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m18:34:35.521845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b4cd1d-64bd-4b5a-a331-28693d9e75bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f30d450>]}
[0m18:34:35.522234 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m18:34:35.522556 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m18:34:35.523328 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:35.523571 [debug] [MainThread]: On master: BEGIN
[0m18:34:35.523776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:35.526927 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:34:35.527124 [debug] [MainThread]: On master: COMMIT
[0m18:34:35.527278 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:35.527417 [debug] [MainThread]: On master: COMMIT
[0m18:34:35.527799 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:34:35.528087 [debug] [MainThread]: On master: Close
[0m18:34:35.528772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:35.528937 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m18:34:35.529076 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:34:35.529206 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m18:34:35.529419 [info ] [MainThread]: 
[0m18:34:35.529690 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:34:35.530207 [debug] [MainThread]: Command end result
[0m18:34:35.544945 [info ] [MainThread]: 
[0m18:34:35.545173 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:35.545363 [info ] [MainThread]: 
[0m18:34:35.545641 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:34:35.546202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4812287, "process_user_time": 0.84687, "process_kernel_time": 0.069824, "process_mem_max_rss": "251520", "process_out_blocks": "4269", "process_in_blocks": "0"}
[0m18:34:35.546469 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:35.546421 after 0.48 seconds
[0m18:34:35.546671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac90a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac908e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac908ed0>]}
[0m18:34:35.546887 [debug] [MainThread]: Flushing usage events
[0m18:34:38.151283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8406d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8407ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8406df10>]}


============================== 18:34:38.152608 | 8cdac94a-400a-4337-a2d3-e2f9f2fe02b7 ==============================
[0m18:34:38.152608 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:34:38.153038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:38.221792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cdac94a-400a-4337-a2d3-e2f9f2fe02b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840ce450>]}
[0m18:34:38.238690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cdac94a-400a-4337-a2d3-e2f9f2fe02b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8643f550>]}
[0m18:34:38.239110 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:34:38.263472 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:34:38.306469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:38.306707 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:38.322594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cdac94a-400a-4337-a2d3-e2f9f2fe02b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840b0550>]}
[0m18:34:38.362584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cdac94a-400a-4337-a2d3-e2f9f2fe02b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b208790>]}
[0m18:34:38.362865 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:34:38.363165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cdac94a-400a-4337-a2d3-e2f9f2fe02b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b55dc50>]}
[0m18:34:38.363919 [info ] [MainThread]: 
[0m18:34:38.364231 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:34:38.364712 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:34:38.377881 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:34:38.378102 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:34:38.378278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:38.382366 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:34:38.382928 [debug] [ThreadPool]: On list_thrive: Close
[0m18:34:38.384059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:34:38.384410 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:34:38.386990 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:38.387174 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:34:38.387343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:38.390085 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:34:38.390714 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:38.391050 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:34:38.391479 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:34:38.391711 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:38.391908 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:34:38.392227 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:34:38.392652 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:34:38.392844 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:38.393011 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:34:38.393343 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:34:38.393586 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:34:38.396259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:34:38.398215 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:34:38.398398 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:34:38.398620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:38.401561 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:34:38.401757 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:34:38.401926 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:34:38.409907 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:34:38.410510 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:34:38.410868 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:34:38.411041 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:34:38.412322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cdac94a-400a-4337-a2d3-e2f9f2fe02b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b233010>]}
[0m18:34:38.412559 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:38.412742 [debug] [MainThread]: On master: BEGIN
[0m18:34:38.412913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:38.415962 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:34:38.416175 [debug] [MainThread]: On master: COMMIT
[0m18:34:38.416354 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:38.416531 [debug] [MainThread]: On master: COMMIT
[0m18:34:38.416828 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:34:38.417009 [debug] [MainThread]: On master: Close
[0m18:34:38.417765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:38.418003 [info ] [MainThread]: 
[0m18:34:38.419197 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m18:34:38.419488 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m18:34:38.419765 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m18:34:38.419950 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m18:34:38.422750 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m18:34:38.423317 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m18:34:38.435277 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m18:34:38.435888 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:34:38.436054 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m18:34:38.436204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:38.439600 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:34:38.439886 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:34:38.440061 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    trans_type,
    created_at,
    customer_id,
    amount,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m18:34:38.440960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:38.443337 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:34:38.443510 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
alter table "thrive"."main"."int_fifo_matched" rename to "int_fifo_matched__dbt_backup"
[0m18:34:38.443779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:38.444839 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:34:38.445022 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
alter table "thrive"."main"."int_fifo_matched__dbt_tmp" rename to "int_fifo_matched"
[0m18:34:38.445288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:38.452296 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m18:34:38.452495 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:34:38.452676 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m18:34:38.453392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:38.455087 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m18:34:38.455269 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
drop table if exists "thrive"."main"."int_fifo_matched__dbt_backup" cascade
[0m18:34:38.455725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:38.456679 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m18:34:38.459547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cdac94a-400a-4337-a2d3-e2f9f2fe02b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b233150>]}
[0m18:34:38.459858 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.int_fifo_matched ........................ [[32mOK[0m in 0.04s]
[0m18:34:38.460144 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m18:34:38.460743 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:38.460932 [debug] [MainThread]: On master: BEGIN
[0m18:34:38.461127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:38.464255 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:34:38.464571 [debug] [MainThread]: On master: COMMIT
[0m18:34:38.464968 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:38.465198 [debug] [MainThread]: On master: COMMIT
[0m18:34:38.465489 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:34:38.465708 [debug] [MainThread]: On master: Close
[0m18:34:38.466403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:38.466575 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:34:38.466737 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m18:34:38.466928 [info ] [MainThread]: 
[0m18:34:38.467120 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:34:38.467435 [debug] [MainThread]: Command end result
[0m18:34:38.481421 [info ] [MainThread]: 
[0m18:34:38.481674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:38.481909 [info ] [MainThread]: 
[0m18:34:38.482219 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:38.482710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3503354, "process_user_time": 0.727966, "process_kernel_time": 0.055225, "process_mem_max_rss": "252008", "process_out_blocks": "2847", "process_in_blocks": "0"}
[0m18:34:38.482944 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:38.482907 after 0.35 seconds
[0m18:34:38.483137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8407ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88dda150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88dd8c10>]}
[0m18:34:38.483340 [debug] [MainThread]: Flushing usage events
[0m18:34:40.216875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fccd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883c3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8941af50>]}


============================== 18:34:40.218096 | 97c4f79d-d2d1-490e-98c2-e25a28d0c192 ==============================
[0m18:34:40.218096 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:34:40.218412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:34:40.286225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97c4f79d-d2d1-490e-98c2-e25a28d0c192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8801d910>]}
[0m18:34:40.302977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97c4f79d-d2d1-490e-98c2-e25a28d0c192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a39f3d0>]}
[0m18:34:40.303338 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:34:40.328091 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:34:40.371267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:40.371503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:40.387471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97c4f79d-d2d1-490e-98c2-e25a28d0c192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5066d0>]}
[0m18:34:40.431112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97c4f79d-d2d1-490e-98c2-e25a28d0c192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f22be10>]}
[0m18:34:40.431397 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:34:40.431626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97c4f79d-d2d1-490e-98c2-e25a28d0c192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4ff310>]}
[0m18:34:40.432389 [info ] [MainThread]: 
[0m18:34:40.432697 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:34:40.434666 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m18:34:40.447017 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:34:40.447242 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:34:40.447426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:40.451355 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:34:40.451579 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:34:40.451802 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:34:40.459915 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:34:40.460584 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:34:40.460941 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:34:40.461120 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:34:40.462602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97c4f79d-d2d1-490e-98c2-e25a28d0c192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f21ebd0>]}
[0m18:34:40.462880 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:40.463255 [debug] [MainThread]: On master: BEGIN
[0m18:34:40.463444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:40.466579 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:34:40.466778 [debug] [MainThread]: On master: COMMIT
[0m18:34:40.466961 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:40.467128 [debug] [MainThread]: On master: COMMIT
[0m18:34:40.467542 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:34:40.467811 [debug] [MainThread]: On master: Close
[0m18:34:40.468536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:40.468766 [info ] [MainThread]: 
[0m18:34:40.469896 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:34:40.470136 [info ] [Thread-1 (]: 1 of 3 START test not_null_int_fifo_matched_trans_id ........................... [RUN]
[0m18:34:40.470569 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m18:34:40.470789 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:34:40.477063 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:34:40.477628 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:34:40.482758 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:34:40.483159 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:34:40.483332 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: BEGIN
[0m18:34:40.483501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:40.486645 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:34:40.486846 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m18:34:40.487013 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trans_id
from "thrive"."main"."int_fifo_matched"
where trans_id is null



      
    ) dbt_internal_test
[0m18:34:40.487540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:40.489557 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: ROLLBACK
[0m18:34:40.489855 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m18:34:40.490040 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: Close
[0m18:34:40.490838 [info ] [Thread-1 (]: 1 of 3 PASS not_null_int_fifo_matched_trans_id ................................. [[32mPASS[0m in 0.02s]
[0m18:34:40.491133 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m18:34:40.491353 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m18:34:40.491577 [info ] [Thread-1 (]: 2 of 3 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m18:34:40.491795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m18:34:40.491994 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m18:34:40.494376 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m18:34:40.494769 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m18:34:40.495665 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m18:34:40.496042 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m18:34:40.496214 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m18:34:40.496390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:40.499226 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:34:40.499412 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m18:34:40.499612 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:34:40.500752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:40.501366 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m18:34:40.501626 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m18:34:40.501794 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m18:34:40.502533 [info ] [Thread-1 (]: 2 of 3 PASS unique_int_fifo_matched_redeem_id .................................. [[32mPASS[0m in 0.01s]
[0m18:34:40.502817 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m18:34:40.503037 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:34:40.503252 [info ] [Thread-1 (]: 3 of 3 START test unique_int_fifo_matched_trans_id ............................. [RUN]
[0m18:34:40.503474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b)
[0m18:34:40.503656 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:34:40.505126 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:34:40.505523 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:34:40.506548 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:34:40.506985 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:34:40.507166 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: BEGIN
[0m18:34:40.507347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:40.510254 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:34:40.510431 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m18:34:40.510603 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trans_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where trans_id is not null
group by trans_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:34:40.511649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:40.512270 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: ROLLBACK
[0m18:34:40.512510 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b'
[0m18:34:40.512665 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: Close
[0m18:34:40.513423 [info ] [Thread-1 (]: 3 of 3 PASS unique_int_fifo_matched_trans_id ................................... [[32mPASS[0m in 0.01s]
[0m18:34:40.513718 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m18:34:40.514335 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:40.514633 [debug] [MainThread]: On master: BEGIN
[0m18:34:40.514780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:40.517670 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:34:40.517962 [debug] [MainThread]: On master: COMMIT
[0m18:34:40.518118 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:40.518287 [debug] [MainThread]: On master: COMMIT
[0m18:34:40.518706 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:34:40.518881 [debug] [MainThread]: On master: Close
[0m18:34:40.519568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:40.519748 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:34:40.519893 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b' was properly closed.
[0m18:34:40.520070 [info ] [MainThread]: 
[0m18:34:40.520259 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:34:40.520654 [debug] [MainThread]: Command end result
[0m18:34:40.557292 [info ] [MainThread]: 
[0m18:34:40.557681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:40.557886 [info ] [MainThread]: 
[0m18:34:40.558066 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:34:40.558504 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3583269, "process_user_time": 0.702935, "process_kernel_time": 0.077771, "process_mem_max_rss": "251704", "process_out_blocks": "1822", "process_in_blocks": "0"}
[0m18:34:40.558736 [debug] [MainThread]: Command `dbt test` succeeded at 18:34:40.558701 after 0.36 seconds
[0m18:34:40.558932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd3e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5b5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd3cb50>]}
[0m18:34:40.559133 [debug] [MainThread]: Flushing usage events
[0m18:34:42.338929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c18f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c18690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c1b510>]}


============================== 18:34:42.340075 | 86ad2631-f1c1-40d0-adee-ef65ce1f7c2e ==============================
[0m18:34:42.340075 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:34:42.340384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select marts', 'send_anonymous_usage_stats': 'True'}
[0m18:34:42.407484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86ad2631-f1c1-40d0-adee-ef65ce1f7c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cb1850>]}
[0m18:34:42.424459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86ad2631-f1c1-40d0-adee-ef65ce1f7c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b022fd0>]}
[0m18:34:42.424813 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m18:34:42.455940 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:34:42.500069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:42.500321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:42.516516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ad2631-f1c1-40d0-adee-ef65ce1f7c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cbeb10>]}
[0m18:34:42.557126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ad2631-f1c1-40d0-adee-ef65ce1f7c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fde8910>]}
[0m18:34:42.557419 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m18:34:42.557631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ad2631-f1c1-40d0-adee-ef65ce1f7c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900f2f10>]}
[0m18:34:42.558337 [info ] [MainThread]: 
[0m18:34:42.558662 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:34:42.559137 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m18:34:42.572181 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m18:34:42.572422 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m18:34:42.572618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:42.576736 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:34:42.577290 [debug] [ThreadPool]: On list_thrive: Close
[0m18:34:42.578233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m18:34:42.578505 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m18:34:42.580981 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:42.581186 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m18:34:42.581366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:42.584238 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:34:42.584838 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:42.585013 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m18:34:42.585406 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:34:42.585681 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:42.585889 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m18:34:42.586163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:34:42.586551 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:34:42.586727 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m18:34:42.586895 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m18:34:42.587242 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:34:42.587492 [debug] [ThreadPool]: On create_thrive_main: Close
[0m18:34:42.590054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m18:34:42.592144 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:34:42.592325 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m18:34:42.592489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:42.595175 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:34:42.595359 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m18:34:42.595530 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m18:34:42.603544 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:34:42.604141 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m18:34:42.604501 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m18:34:42.604712 [debug] [ThreadPool]: On list_thrive_main: Close
[0m18:34:42.606044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ad2631-f1c1-40d0-adee-ef65ce1f7c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdec090>]}
[0m18:34:42.606309 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:42.606491 [debug] [MainThread]: On master: BEGIN
[0m18:34:42.606667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:42.609782 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:34:42.609964 [debug] [MainThread]: On master: COMMIT
[0m18:34:42.610129 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:42.610292 [debug] [MainThread]: On master: COMMIT
[0m18:34:42.610642 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:34:42.610883 [debug] [MainThread]: On master: Close
[0m18:34:42.611611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:42.611845 [info ] [MainThread]: 
[0m18:34:42.613108 [debug] [Thread-1 (]: Began running node model.thrive_market.finance_report
[0m18:34:42.613401 [info ] [Thread-1 (]: 1 of 1 START sql table model main.finance_report ............................... [RUN]
[0m18:34:42.613715 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.finance_report'
[0m18:34:42.613937 [debug] [Thread-1 (]: Began compiling node model.thrive_market.finance_report
[0m18:34:42.617021 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.finance_report"
[0m18:34:42.617571 [debug] [Thread-1 (]: Began executing node model.thrive_market.finance_report
[0m18:34:42.629649 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.finance_report"
[0m18:34:42.630402 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:34:42.630657 [debug] [Thread-1 (]: On model.thrive_market.finance_report: BEGIN
[0m18:34:42.630840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:42.634333 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:34:42.634543 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:34:42.634749 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with enriched_transactions as (
    select 
        t.trans_id,
        t.customer_id,
        t.amount,
        t.trans_type,
        t.created_at,
        f.redeem_id,
        -- Sign convention: earned = +, spent/expired = -
        case 
            when t.trans_type = 'earned' then t.amount
            else -t.amount 
        end as signed_amount
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.trans_id = f.trans_id
),

running_balances as (
    select
        trans_id,
        customer_id,
        trans_type,
        created_at,
        amount,
        redeem_id,
        signed_amount,
        -- Running balance for this customer up to this point in time
        sum(signed_amount) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as running_balance,
        -- Cumulative totals by transaction type
        sum(case when trans_type = 'earned' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_earned,
        sum(case when trans_type = 'spent' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_spent,
        sum(case when trans_type = 'expired' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_expired
    from enriched_transactions
)

select
    customer_id,
    created_at as transaction_date,
    amount,
    cumulative_earned,
    cumulative_spent,
    cumulative_expired,
    (cumulative_earned - cumulative_spent - cumulative_expired) as current_balance
from running_balances
order by customer_id, created_at, trans_id
    );
  
  
[0m18:34:42.639437 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:34:42.642174 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:34:42.642385 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */
alter table "thrive"."main"."finance_report__dbt_tmp" rename to "finance_report"
[0m18:34:42.642767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:42.648834 [debug] [Thread-1 (]: On model.thrive_market.finance_report: COMMIT
[0m18:34:42.649028 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:34:42.649227 [debug] [Thread-1 (]: On model.thrive_market.finance_report: COMMIT
[0m18:34:42.650026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:42.651829 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m18:34:42.652032 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */
drop table if exists "thrive"."main"."finance_report__dbt_backup" cascade
[0m18:34:42.652427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:42.653514 [debug] [Thread-1 (]: On model.thrive_market.finance_report: Close
[0m18:34:42.656358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ad2631-f1c1-40d0-adee-ef65ce1f7c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f33ed10>]}
[0m18:34:42.656683 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.finance_report .......................... [[32mOK[0m in 0.04s]
[0m18:34:42.656972 [debug] [Thread-1 (]: Finished running node model.thrive_market.finance_report
[0m18:34:42.657631 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:42.657824 [debug] [MainThread]: On master: BEGIN
[0m18:34:42.657995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:42.661145 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m18:34:42.661425 [debug] [MainThread]: On master: COMMIT
[0m18:34:42.661754 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:42.661966 [debug] [MainThread]: On master: COMMIT
[0m18:34:42.662242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:34:42.662461 [debug] [MainThread]: On master: Close
[0m18:34:42.663247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:42.663416 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m18:34:42.663581 [debug] [MainThread]: Connection 'model.thrive_market.finance_report' was properly closed.
[0m18:34:42.663757 [info ] [MainThread]: 
[0m18:34:42.663932 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m18:34:42.664222 [debug] [MainThread]: Command end result
[0m18:34:42.677731 [info ] [MainThread]: 
[0m18:34:42.677962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:42.678129 [info ] [MainThread]: 
[0m18:34:42.678294 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:42.678698 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.35617206, "process_user_time": 0.715736, "process_kernel_time": 0.060145, "process_mem_max_rss": "252060", "process_out_blocks": "2866", "process_in_blocks": "0"}
[0m18:34:42.679004 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:42.678954 after 0.36 seconds
[0m18:34:42.679304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f1fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c13e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c13f50>]}
[0m18:34:42.679601 [debug] [MainThread]: Flushing usage events
[0m21:48:15.897928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2035b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb205b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb205a850>]}


============================== 21:48:15.904936 | 9aacc9ce-073f-4b09-8e58-1fdc46ed6350 ==============================
[0m21:48:15.904936 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:48:15.905354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:48:15.972670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aacc9ce-073f-4b09-8e58-1fdc46ed6350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20bed10>]}
[0m21:48:15.989740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aacc9ce-073f-4b09-8e58-1fdc46ed6350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45b3650>]}
[0m21:48:15.990083 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m21:48:16.014164 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:48:16.059133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:16.059356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:16.075117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9aacc9ce-073f-4b09-8e58-1fdc46ed6350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93c66d0>]}
[0m21:48:16.127328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9aacc9ce-073f-4b09-8e58-1fdc46ed6350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93bb9d0>]}
[0m21:48:16.127665 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m21:48:16.127979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aacc9ce-073f-4b09-8e58-1fdc46ed6350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa95a7150>]}
[0m21:48:16.128752 [info ] [MainThread]: 
[0m21:48:16.129072 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:48:16.131002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m21:48:16.143840 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m21:48:16.144071 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m21:48:16.144293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:16.148527 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:48:16.149071 [debug] [ThreadPool]: On list_thrive: Close
[0m21:48:16.150084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m21:48:16.150331 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m21:48:16.152835 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:16.153032 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m21:48:16.153203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:16.156196 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:48:16.156740 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:16.156931 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m21:48:16.157196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:16.157366 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:16.157534 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m21:48:16.158012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:16.158481 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m21:48:16.158675 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:16.158837 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m21:48:16.159131 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:16.159302 [debug] [ThreadPool]: On create_thrive_main: Close
[0m21:48:16.160392 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m21:48:16.162640 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m21:48:16.162915 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m21:48:16.163116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:16.166506 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:48:16.166773 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m21:48:16.166969 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m21:48:16.175930 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:48:16.176601 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m21:48:16.176969 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m21:48:16.177129 [debug] [ThreadPool]: On list_thrive_main: Close
[0m21:48:16.178596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aacc9ce-073f-4b09-8e58-1fdc46ed6350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1fa5a10>]}
[0m21:48:16.178863 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:16.179040 [debug] [MainThread]: On master: BEGIN
[0m21:48:16.179213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:16.182194 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:48:16.182380 [debug] [MainThread]: On master: COMMIT
[0m21:48:16.182531 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:16.182675 [debug] [MainThread]: On master: COMMIT
[0m21:48:16.182926 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:16.183131 [debug] [MainThread]: On master: Close
[0m21:48:16.183883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:16.184097 [info ] [MainThread]: 
[0m21:48:16.185246 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m21:48:16.185531 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m21:48:16.185811 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m21:48:16.186021 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m21:48:16.188889 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m21:48:16.190251 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m21:48:16.201142 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m21:48:16.207812 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m21:48:16.209619 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m21:48:16.209877 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:16.215835 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:48:16.216166 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m21:48:16.216365 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m21:48:16.216726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.219837 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m21:48:16.220060 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:48:16.220393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.221463 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m21:48:16.221654 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:48:16.221956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.227527 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m21:48:16.227751 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m21:48:16.227957 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m21:48:16.228679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:16.230451 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m21:48:16.230615 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m21:48:16.231015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.231952 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m21:48:16.234310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aacc9ce-073f-4b09-8e58-1fdc46ed6350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20cffd0>]}
[0m21:48:16.234709 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.05s]
[0m21:48:16.234998 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m21:48:16.235239 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m21:48:16.235503 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m21:48:16.235749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m21:48:16.235935 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m21:48:16.237094 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m21:48:16.237505 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m21:48:16.238814 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m21:48:16.239170 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m21:48:16.239385 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m21:48:16.239727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:16.242991 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:16.243182 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m21:48:16.243333 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m21:48:16.243615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.244786 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m21:48:16.244967 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:48:16.245222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.246227 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m21:48:16.246385 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:48:16.246602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.247264 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m21:48:16.247417 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m21:48:16.247585 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m21:48:16.248130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.248952 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m21:48:16.249127 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m21:48:16.249492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.250105 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m21:48:16.252266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aacc9ce-073f-4b09-8e58-1fdc46ed6350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20bfad0>]}
[0m21:48:16.252538 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.02s]
[0m21:48:16.252795 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m21:48:16.252999 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m21:48:16.253233 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m21:48:16.253467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m21:48:16.253666 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m21:48:16.254768 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m21:48:16.255231 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m21:48:16.256577 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m21:48:16.256941 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m21:48:16.257112 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m21:48:16.257280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:16.260160 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:16.260366 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m21:48:16.260538 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as trans_id,
    "TCTYPE"::varchar as trans_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m21:48:16.260869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.261976 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m21:48:16.262135 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data" rename to "stg_tc_data__dbt_backup"
[0m21:48:16.262375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.263583 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m21:48:16.263828 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m21:48:16.264200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.265677 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m21:48:16.265860 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m21:48:16.266022 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m21:48:16.266587 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.290233 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m21:48:16.290547 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m21:48:16.291204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:16.291763 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m21:48:16.293807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aacc9ce-073f-4b09-8e58-1fdc46ed6350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb229a490>]}
[0m21:48:16.294098 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.04s]
[0m21:48:16.294348 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m21:48:16.295022 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:16.295213 [debug] [MainThread]: On master: BEGIN
[0m21:48:16.295379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:16.298792 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:48:16.299068 [debug] [MainThread]: On master: COMMIT
[0m21:48:16.299247 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:16.299387 [debug] [MainThread]: On master: COMMIT
[0m21:48:16.299628 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:16.299822 [debug] [MainThread]: On master: Close
[0m21:48:16.300597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:16.300851 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m21:48:16.301015 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m21:48:16.301167 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m21:48:16.301374 [info ] [MainThread]: 
[0m21:48:16.301549 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m21:48:16.301909 [debug] [MainThread]: Command end result
[0m21:48:16.315542 [info ] [MainThread]: 
[0m21:48:16.315829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:48:16.316056 [info ] [MainThread]: 
[0m21:48:16.316280 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:48:16.316880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4350423, "process_user_time": 0.853416, "process_kernel_time": 0.066875, "process_mem_max_rss": "251600", "process_out_blocks": "8661", "process_in_blocks": "0"}
[0m21:48:16.317152 [debug] [MainThread]: Command `dbt run` succeeded at 21:48:16.317110 after 0.44 seconds
[0m21:48:16.317345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d9dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d9ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d9cd50>]}
[0m21:48:16.317511 [debug] [MainThread]: Flushing usage events
[0m21:48:18.918251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c7cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c48690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fbea10>]}


============================== 21:48:18.919384 | 6e3d955a-f028-4ace-9985-4ef43e549df0 ==============================
[0m21:48:18.919384 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:48:18.919798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:48:18.986329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e3d955a-f028-4ace-9985-4ef43e549df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3cea790>]}
[0m21:48:19.003054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e3d955a-f028-4ace-9985-4ef43e549df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6052d90>]}
[0m21:48:19.003394 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m21:48:19.026834 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:48:19.069130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:19.069360 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:19.085051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e3d955a-f028-4ace-9985-4ef43e549df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b082450>]}
[0m21:48:19.125000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e3d955a-f028-4ace-9985-4ef43e549df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae03e50>]}
[0m21:48:19.125277 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m21:48:19.125551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e3d955a-f028-4ace-9985-4ef43e549df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1af050>]}
[0m21:48:19.126254 [info ] [MainThread]: 
[0m21:48:19.126561 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:48:19.127053 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m21:48:19.139821 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m21:48:19.140087 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m21:48:19.140264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:19.144449 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:48:19.145050 [debug] [ThreadPool]: On list_thrive: Close
[0m21:48:19.146024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m21:48:19.146285 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m21:48:19.148772 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:19.148965 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m21:48:19.149134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:19.152076 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:48:19.152605 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:19.152865 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m21:48:19.153256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:19.153564 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:19.153759 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m21:48:19.154054 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:19.154439 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m21:48:19.154615 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:19.154801 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m21:48:19.155085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:19.155322 [debug] [ThreadPool]: On create_thrive_main: Close
[0m21:48:19.158007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m21:48:19.160040 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m21:48:19.160217 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m21:48:19.160374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:19.163190 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:48:19.163379 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m21:48:19.163545 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m21:48:19.171585 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:48:19.172192 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m21:48:19.172524 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m21:48:19.172717 [debug] [ThreadPool]: On list_thrive_main: Close
[0m21:48:19.174328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e3d955a-f028-4ace-9985-4ef43e549df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3409d0>]}
[0m21:48:19.174625 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:19.174820 [debug] [MainThread]: On master: BEGIN
[0m21:48:19.175007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:19.178023 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:48:19.178215 [debug] [MainThread]: On master: COMMIT
[0m21:48:19.178388 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:19.178560 [debug] [MainThread]: On master: COMMIT
[0m21:48:19.178931 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:19.179241 [debug] [MainThread]: On master: Close
[0m21:48:19.179996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:19.180210 [info ] [MainThread]: 
[0m21:48:19.181406 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m21:48:19.181702 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m21:48:19.181992 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m21:48:19.182181 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m21:48:19.185051 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m21:48:19.186449 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m21:48:19.198443 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m21:48:19.199051 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m21:48:19.199277 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m21:48:19.199457 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:19.202845 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:19.203048 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m21:48:19.203224 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    trans_type,
    created_at,
    customer_id,
    amount,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m21:48:19.204130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:19.206449 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m21:48:19.206616 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
alter table "thrive"."main"."int_fifo_matched" rename to "int_fifo_matched__dbt_backup"
[0m21:48:19.206901 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:19.207944 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m21:48:19.208124 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
alter table "thrive"."main"."int_fifo_matched__dbt_tmp" rename to "int_fifo_matched"
[0m21:48:19.208361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:19.215300 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m21:48:19.215507 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m21:48:19.215709 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m21:48:19.216474 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:19.218307 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m21:48:19.218483 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
drop table if exists "thrive"."main"."int_fifo_matched__dbt_backup" cascade
[0m21:48:19.218920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:19.219854 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m21:48:19.222891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e3d955a-f028-4ace-9985-4ef43e549df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a31bf10>]}
[0m21:48:19.223228 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.int_fifo_matched ........................ [[32mOK[0m in 0.04s]
[0m21:48:19.223508 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m21:48:19.224300 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:19.224601 [debug] [MainThread]: On master: BEGIN
[0m21:48:19.224790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:19.227996 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:48:19.228191 [debug] [MainThread]: On master: COMMIT
[0m21:48:19.228359 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:19.228515 [debug] [MainThread]: On master: COMMIT
[0m21:48:19.228794 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:19.228996 [debug] [MainThread]: On master: Close
[0m21:48:19.229726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:19.229873 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m21:48:19.229995 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m21:48:19.230138 [info ] [MainThread]: 
[0m21:48:19.230323 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m21:48:19.230639 [debug] [MainThread]: Command end result
[0m21:48:19.244315 [info ] [MainThread]: 
[0m21:48:19.244605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:48:19.244841 [info ] [MainThread]: 
[0m21:48:19.245141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:48:19.245712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3434759, "process_user_time": 0.702215, "process_kernel_time": 0.048151, "process_mem_max_rss": "251680", "process_out_blocks": "2847", "process_in_blocks": "0"}
[0m21:48:19.245972 [debug] [MainThread]: Command `dbt run` succeeded at 21:48:19.245930 after 0.34 seconds
[0m21:48:19.246174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c43dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c43cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89edfd0>]}
[0m21:48:19.246360 [debug] [MainThread]: Flushing usage events
[0m21:48:21.010286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf81350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf38210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf7ff90>]}


============================== 21:48:21.011431 | efd948dc-da07-426b-afe2-a2ed4b8be49a ==============================
[0m21:48:21.011431 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:48:21.011735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select int_fifo_matched', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:48:21.078774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efd948dc-da07-426b-afe2-a2ed4b8be49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bfddb10>]}
[0m21:48:21.097918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efd948dc-da07-426b-afe2-a2ed4b8be49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e33f5d0>]}
[0m21:48:21.098389 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m21:48:21.123838 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:48:21.167034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:21.167269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:21.185768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efd948dc-da07-426b-afe2-a2ed4b8be49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933732d0>]}
[0m21:48:21.231016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efd948dc-da07-426b-afe2-a2ed4b8be49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931cbed0>]}
[0m21:48:21.231311 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m21:48:21.231497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efd948dc-da07-426b-afe2-a2ed4b8be49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9329a550>]}
[0m21:48:21.232234 [info ] [MainThread]: 
[0m21:48:21.232553 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:48:21.234555 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m21:48:21.247203 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m21:48:21.247442 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m21:48:21.247625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:21.251792 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:48:21.252032 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m21:48:21.252211 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m21:48:21.260737 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:48:21.261427 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m21:48:21.261802 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m21:48:21.262006 [debug] [ThreadPool]: On list_thrive_main: Close
[0m21:48:21.263633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efd948dc-da07-426b-afe2-a2ed4b8be49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927fa250>]}
[0m21:48:21.263868 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:21.264045 [debug] [MainThread]: On master: BEGIN
[0m21:48:21.264205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:21.267284 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:48:21.267489 [debug] [MainThread]: On master: COMMIT
[0m21:48:21.267673 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:21.267840 [debug] [MainThread]: On master: COMMIT
[0m21:48:21.268298 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:21.268589 [debug] [MainThread]: On master: Close
[0m21:48:21.269466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:21.269810 [info ] [MainThread]: 
[0m21:48:21.270986 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m21:48:21.271219 [info ] [Thread-1 (]: 1 of 3 START test not_null_int_fifo_matched_trans_id ........................... [RUN]
[0m21:48:21.271637 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m21:48:21.271870 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m21:48:21.278141 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m21:48:21.278746 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m21:48:21.283723 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m21:48:21.284174 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m21:48:21.284406 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: BEGIN
[0m21:48:21.284577 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:21.288025 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:21.288226 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m21:48:21.288430 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trans_id
from "thrive"."main"."int_fifo_matched"
where trans_id is null



      
    ) dbt_internal_test
[0m21:48:21.288997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:21.291025 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: ROLLBACK
[0m21:48:21.291328 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m21:48:21.291519 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: Close
[0m21:48:21.292333 [info ] [Thread-1 (]: 1 of 3 PASS not_null_int_fifo_matched_trans_id ................................. [[32mPASS[0m in 0.02s]
[0m21:48:21.292624 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m21:48:21.292859 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m21:48:21.293066 [info ] [Thread-1 (]: 2 of 3 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m21:48:21.293278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m21:48:21.293451 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m21:48:21.295762 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m21:48:21.296168 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m21:48:21.297103 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m21:48:21.297463 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m21:48:21.297652 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m21:48:21.297835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:21.300905 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:21.301222 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m21:48:21.301405 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:48:21.302747 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:21.303425 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m21:48:21.303718 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m21:48:21.303893 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m21:48:21.304765 [info ] [Thread-1 (]: 2 of 3 PASS unique_int_fifo_matched_redeem_id .................................. [[32mPASS[0m in 0.01s]
[0m21:48:21.305095 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m21:48:21.305308 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m21:48:21.305509 [info ] [Thread-1 (]: 3 of 3 START test unique_int_fifo_matched_trans_id ............................. [RUN]
[0m21:48:21.305755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b)
[0m21:48:21.305937 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m21:48:21.307596 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m21:48:21.308188 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m21:48:21.309137 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m21:48:21.309549 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m21:48:21.309723 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: BEGIN
[0m21:48:21.309881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:21.312890 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:21.313166 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m21:48:21.313351 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trans_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where trans_id is not null
group by trans_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:48:21.316317 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:21.316990 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: ROLLBACK
[0m21:48:21.317214 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b'
[0m21:48:21.317366 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: Close
[0m21:48:21.318137 [info ] [Thread-1 (]: 3 of 3 PASS unique_int_fifo_matched_trans_id ................................... [[32mPASS[0m in 0.01s]
[0m21:48:21.318390 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m21:48:21.319107 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:21.319337 [debug] [MainThread]: On master: BEGIN
[0m21:48:21.319508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:21.322454 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:48:21.322664 [debug] [MainThread]: On master: COMMIT
[0m21:48:21.322821 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:21.322966 [debug] [MainThread]: On master: COMMIT
[0m21:48:21.323168 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:21.323324 [debug] [MainThread]: On master: Close
[0m21:48:21.324207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:21.324529 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m21:48:21.324699 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b' was properly closed.
[0m21:48:21.324862 [info ] [MainThread]: 
[0m21:48:21.325045 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m21:48:21.325430 [debug] [MainThread]: Command end result
[0m21:48:21.371219 [info ] [MainThread]: 
[0m21:48:21.371635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:48:21.371928 [info ] [MainThread]: 
[0m21:48:21.372164 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:48:21.372634 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3786968, "process_user_time": 0.727531, "process_kernel_time": 0.060627, "process_mem_max_rss": "251672", "process_out_blocks": "1822", "process_in_blocks": "0"}
[0m21:48:21.372881 [debug] [MainThread]: Command `dbt test` succeeded at 21:48:21.372845 after 0.38 seconds
[0m21:48:21.373071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2b35d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c176250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3e7590>]}
[0m21:48:21.373260 [debug] [MainThread]: Flushing usage events
[0m21:48:22.693141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59e0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59eaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59e1850>]}


============================== 21:48:22.694282 | 08c4f858-028d-4c79-92fe-80c53040cecf ==============================
[0m21:48:22.694282 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:48:22.694602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:48:22.761557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08c4f858-028d-4c79-92fe-80c53040cecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa79bec90>]}
[0m21:48:22.778550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08c4f858-028d-4c79-92fe-80c53040cecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7df2f50>]}
[0m21:48:22.778900 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m21:48:22.802559 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:48:22.845144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:22.845376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:22.861228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08c4f858-028d-4c79-92fe-80c53040cecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce23610>]}
[0m21:48:22.901328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08c4f858-028d-4c79-92fe-80c53040cecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cba3fd0>]}
[0m21:48:22.901612 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 421 macros
[0m21:48:22.901804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08c4f858-028d-4c79-92fe-80c53040cecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5a8d990>]}
[0m21:48:22.902511 [info ] [MainThread]: 
[0m21:48:22.902821 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:48:22.903317 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m21:48:22.916567 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m21:48:22.916824 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m21:48:22.917010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:22.921086 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:48:22.921616 [debug] [ThreadPool]: On list_thrive: Close
[0m21:48:22.922497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m21:48:22.922747 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m21:48:22.925268 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:22.925463 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m21:48:22.925636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:22.928532 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:48:22.929093 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:22.929280 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m21:48:22.929733 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:22.930020 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:22.930203 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m21:48:22.930582 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:22.931020 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m21:48:22.931208 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m21:48:22.931374 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m21:48:22.931614 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:48:22.931823 [debug] [ThreadPool]: On create_thrive_main: Close
[0m21:48:22.934670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m21:48:22.936683 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m21:48:22.936869 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m21:48:22.937040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:22.940028 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:48:22.940344 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m21:48:22.940549 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m21:48:22.948635 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:48:22.949278 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m21:48:22.949624 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m21:48:22.949809 [debug] [ThreadPool]: On list_thrive_main: Close
[0m21:48:22.951247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08c4f858-028d-4c79-92fe-80c53040cecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf57350>]}
[0m21:48:22.951481 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:22.951659 [debug] [MainThread]: On master: BEGIN
[0m21:48:22.951828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:22.954978 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:48:22.955171 [debug] [MainThread]: On master: COMMIT
[0m21:48:22.955337 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:22.955499 [debug] [MainThread]: On master: COMMIT
[0m21:48:22.955907 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:22.956226 [debug] [MainThread]: On master: Close
[0m21:48:22.956919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:22.957134 [info ] [MainThread]: 
[0m21:48:22.958370 [debug] [Thread-1 (]: Began running node model.thrive_market.finance_report
[0m21:48:22.958659 [info ] [Thread-1 (]: 1 of 1 START sql table model main.finance_report ............................... [RUN]
[0m21:48:22.958972 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.finance_report'
[0m21:48:22.959163 [debug] [Thread-1 (]: Began compiling node model.thrive_market.finance_report
[0m21:48:22.962189 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.finance_report"
[0m21:48:22.962760 [debug] [Thread-1 (]: Began executing node model.thrive_market.finance_report
[0m21:48:22.974740 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.finance_report"
[0m21:48:22.975359 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m21:48:22.975669 [debug] [Thread-1 (]: On model.thrive_market.finance_report: BEGIN
[0m21:48:22.975866 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:22.979266 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:48:22.979464 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m21:48:22.979679 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with enriched_transactions as (
    select 
        t.trans_id,
        t.customer_id,
        t.amount,
        t.trans_type,
        t.created_at,
        f.redeem_id,
        -- Sign convention: earned = +, spent/expired = -
        case 
            when t.trans_type = 'earned' then t.amount
            else -t.amount 
        end as signed_amount
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.trans_id = f.trans_id
),

running_balances as (
    select
        trans_id,
        customer_id,
        trans_type,
        created_at,
        amount,
        redeem_id,
        signed_amount,
        -- Running balance for this customer up to this point in time
        sum(signed_amount) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as running_balance,
        -- Cumulative totals by transaction type
        sum(case when trans_type = 'earned' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_earned,
        sum(case when trans_type = 'spent' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_spent,
        sum(case when trans_type = 'expired' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_expired
    from enriched_transactions
)

select
    customer_id,
    created_at as transaction_date,
    amount,
    cumulative_earned,
    cumulative_spent,
    cumulative_expired,
    (cumulative_earned - cumulative_spent - cumulative_expired) as current_balance
from running_balances
order by customer_id, created_at, trans_id
    );
  
  
[0m21:48:22.983706 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:48:22.986141 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m21:48:22.986339 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */
alter table "thrive"."main"."finance_report" rename to "finance_report__dbt_backup"
[0m21:48:22.986905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:22.988299 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m21:48:22.988605 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */
alter table "thrive"."main"."finance_report__dbt_tmp" rename to "finance_report"
[0m21:48:22.988952 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:22.995866 [debug] [Thread-1 (]: On model.thrive_market.finance_report: COMMIT
[0m21:48:22.996058 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m21:48:22.996237 [debug] [Thread-1 (]: On model.thrive_market.finance_report: COMMIT
[0m21:48:22.996979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:48:22.998721 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m21:48:22.998883 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */
drop table if exists "thrive"."main"."finance_report__dbt_backup" cascade
[0m21:48:22.999303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:48:23.000266 [debug] [Thread-1 (]: On model.thrive_market.finance_report: Close
[0m21:48:23.002910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08c4f858-028d-4c79-92fe-80c53040cecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0f3190>]}
[0m21:48:23.003232 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.finance_report .......................... [[32mOK[0m in 0.04s]
[0m21:48:23.003518 [debug] [Thread-1 (]: Finished running node model.thrive_market.finance_report
[0m21:48:23.004130 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:23.004335 [debug] [MainThread]: On master: BEGIN
[0m21:48:23.004489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:23.007437 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:48:23.007661 [debug] [MainThread]: On master: COMMIT
[0m21:48:23.007963 [debug] [MainThread]: Using duckdb connection "master"
[0m21:48:23.008170 [debug] [MainThread]: On master: COMMIT
[0m21:48:23.008539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:48:23.008851 [debug] [MainThread]: On master: Close
[0m21:48:23.009612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:23.009781 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m21:48:23.009937 [debug] [MainThread]: Connection 'model.thrive_market.finance_report' was properly closed.
[0m21:48:23.010113 [info ] [MainThread]: 
[0m21:48:23.010291 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m21:48:23.010602 [debug] [MainThread]: Command end result
[0m21:48:23.024368 [info ] [MainThread]: 
[0m21:48:23.024638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:48:23.024855 [info ] [MainThread]: 
[0m21:48:23.025050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:48:23.025452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.34832403, "process_user_time": 0.709214, "process_kernel_time": 0.064382, "process_mem_max_rss": "251680", "process_out_blocks": "2867", "process_in_blocks": "0"}
[0m21:48:23.025914 [debug] [MainThread]: Command `dbt run` succeeded at 21:48:23.025821 after 0.35 seconds
[0m21:48:23.026194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59e0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59e1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59e3cd0>]}
[0m21:48:23.026387 [debug] [MainThread]: Flushing usage events
[0m23:13:37.107013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da8d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d902710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc5e7d0>]}


============================== 23:13:37.108601 | 9d4672be-e670-4106-9a62-d6fe615ff01b ==============================
[0m23:13:37.108601 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:13:37.108911 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt_project', 'invocation_command': 'dbt run --select staging', 'empty': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m23:13:37.182703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9693d0>]}
[0m23:13:37.203574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90884950>]}
[0m23:13:37.203972 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m23:13:37.228484 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:13:37.264865 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:13:37.265169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea63c90>]}
[0m23:13:37.629269 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'stg_tc_data' in
package 'thrive_market' (models/staging/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m23:13:37.629628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f157e50>]}
[0m23:13:37.710155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d688d0>]}
[0m23:13:37.743898 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:13:37.744845 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:13:37.761663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b0dd10>]}
[0m23:13:37.761963 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 455 macros
[0m23:13:37.762181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b4a710>]}
[0m23:13:37.762985 [info ] [MainThread]: 
[0m23:13:37.763182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:37.763337 [info ] [MainThread]: 
[0m23:13:37.763577 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:13:37.765506 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m23:13:37.777718 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m23:13:37.777940 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m23:13:37.778131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:37.782172 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:13:37.782671 [debug] [ThreadPool]: On list_thrive: Close
[0m23:13:37.783681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m23:13:37.783958 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m23:13:37.786377 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:37.786572 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m23:13:37.786742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:37.789515 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:13:37.790107 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:37.790288 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m23:13:37.790588 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:37.790778 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:37.790979 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m23:13:37.791328 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:37.791690 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m23:13:37.791876 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:37.792050 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m23:13:37.792337 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:37.792514 [debug] [ThreadPool]: On create_thrive_main: Close
[0m23:13:37.793894 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m23:13:37.796019 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:13:37.796220 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m23:13:37.796385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:37.799038 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:13:37.799216 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:13:37.799381 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m23:13:37.807249 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:13:37.807825 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m23:13:37.808163 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m23:13:37.808336 [debug] [ThreadPool]: On list_thrive_main: Close
[0m23:13:37.809568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f176610>]}
[0m23:13:37.809816 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:37.810011 [debug] [MainThread]: On master: BEGIN
[0m23:13:37.810198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:13:37.813059 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:13:37.813258 [debug] [MainThread]: On master: COMMIT
[0m23:13:37.813426 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:37.813589 [debug] [MainThread]: On master: COMMIT
[0m23:13:37.813858 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:37.814066 [debug] [MainThread]: On master: Close
[0m23:13:37.815689 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m23:13:37.815991 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m23:13:37.816281 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m23:13:37.816474 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m23:13:37.819269 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m23:13:37.820790 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m23:13:37.831931 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m23:13:37.832629 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m23:13:37.832855 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m23:13:37.833064 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:13:37.836092 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:13:37.836287 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m23:13:37.836442 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m23:13:37.836757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.839045 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m23:13:37.839255 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:13:37.839527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.844684 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m23:13:37.844904 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m23:13:37.845115 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m23:13:37.845790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.847470 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m23:13:37.847656 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m23:13:37.848151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.849245 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m23:13:37.851380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e31c910>]}
[0m23:13:37.851741 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.03s]
[0m23:13:37.852013 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m23:13:37.852211 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m23:13:37.852457 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m23:13:37.852692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m23:13:37.852883 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m23:13:37.854045 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m23:13:37.854439 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m23:13:37.855732 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m23:13:37.856116 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m23:13:37.856446 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m23:13:37.856715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:37.859880 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:13:37.860094 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m23:13:37.860299 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m23:13:37.860622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.861772 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m23:13:37.861937 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m23:13:37.862223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.862770 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m23:13:37.862932 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m23:13:37.863089 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m23:13:37.863610 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.864491 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m23:13:37.864650 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m23:13:37.864899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.865388 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m23:13:37.866949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2fe090>]}
[0m23:13:37.867271 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.01s]
[0m23:13:37.867666 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m23:13:37.867893 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m23:13:37.868247 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m23:13:37.868489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m23:13:37.868687 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m23:13:37.869831 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m23:13:37.870264 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m23:13:37.871645 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m23:13:37.872215 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:13:37.872383 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m23:13:37.872525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:37.875068 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:13:37.875269 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:13:37.875444 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as trans_id,
    "TCTYPE"::varchar as trans_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m23:13:37.875722 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.877561 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:13:37.877718 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m23:13:37.877970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.878490 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m23:13:37.878645 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:13:37.878789 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m23:13:37.879351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.880234 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m23:13:37.880388 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m23:13:37.880841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:37.881521 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m23:13:37.883181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4672be-e670-4106-9a62-d6fe615ff01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e211a90>]}
[0m23:13:37.883501 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.01s]
[0m23:13:37.883771 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m23:13:37.884389 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:37.884579 [debug] [MainThread]: On master: BEGIN
[0m23:13:37.884725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:13:37.887671 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:13:37.887988 [debug] [MainThread]: On master: COMMIT
[0m23:13:37.888179 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:37.888327 [debug] [MainThread]: On master: COMMIT
[0m23:13:37.888558 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:37.888737 [debug] [MainThread]: On master: Close
[0m23:13:37.889434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:37.889600 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m23:13:37.889752 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m23:13:37.889902 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m23:13:37.890129 [info ] [MainThread]: 
[0m23:13:37.890321 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m23:13:37.890700 [debug] [MainThread]: Command end result
[0m23:13:37.902419 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:13:37.903314 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:13:37.906079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:13:37.906270 [info ] [MainThread]: 
[0m23:13:37.906479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:13:37.906660 [info ] [MainThread]: 
[0m23:13:37.906888 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:13:37.907186 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:13:37.907636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.82029337, "process_in_blocks": "0", "process_kernel_time": 0.086308, "process_mem_max_rss": "165664", "process_out_blocks": "7088", "process_user_time": 1.244442}
[0m23:13:37.907928 [debug] [MainThread]: Command `dbt run` succeeded at 23:13:37.907879 after 0.82 seconds
[0m23:13:37.908132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc56650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd5d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925f9290>]}
[0m23:13:37.908329 [debug] [MainThread]: Flushing usage events
[0m23:13:38.102291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:13:40.190143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e84a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8862d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e84aa90>]}


============================== 23:13:40.191529 | ba958fbb-132a-4b1d-8064-61b117139bfd ==============================
[0m23:13:40.191529 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:13:40.191942 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'invocation_command': 'dbt run --select intermediate', 'empty': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None'}
[0m23:13:40.265569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba958fbb-132a-4b1d-8064-61b117139bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e738a90>]}
[0m23:13:40.286334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba958fbb-132a-4b1d-8064-61b117139bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91674910>]}
[0m23:13:40.286710 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m23:13:40.311089 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:13:40.354414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:13:40.354666 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:13:40.354837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:13:40.372330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba958fbb-132a-4b1d-8064-61b117139bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bd9750>]}
[0m23:13:40.406971 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:13:40.407853 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:13:40.413649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba958fbb-132a-4b1d-8064-61b117139bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905ce510>]}
[0m23:13:40.413927 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 455 macros
[0m23:13:40.414244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba958fbb-132a-4b1d-8064-61b117139bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85cc1d10>]}
[0m23:13:40.415001 [info ] [MainThread]: 
[0m23:13:40.415225 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:40.415414 [info ] [MainThread]: 
[0m23:13:40.415692 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:13:40.416151 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m23:13:40.451653 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m23:13:40.451956 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m23:13:40.452150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:40.456377 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:13:40.456999 [debug] [ThreadPool]: On list_thrive: Close
[0m23:13:40.457861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m23:13:40.458142 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m23:13:40.460810 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:40.461007 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m23:13:40.461185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:40.464122 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:13:40.464674 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:40.464849 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m23:13:40.465275 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:40.465564 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:40.465780 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m23:13:40.466194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:40.466638 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m23:13:40.466863 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:40.467064 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m23:13:40.467384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:40.467652 [debug] [ThreadPool]: On create_thrive_main: Close
[0m23:13:40.470515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m23:13:40.473160 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:13:40.473442 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m23:13:40.473735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:40.477299 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:13:40.477598 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:13:40.477797 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m23:13:40.485977 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:13:40.486617 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m23:13:40.487020 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m23:13:40.487218 [debug] [ThreadPool]: On list_thrive_main: Close
[0m23:13:40.488569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba958fbb-132a-4b1d-8064-61b117139bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8edf8590>]}
[0m23:13:40.488832 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:40.489007 [debug] [MainThread]: On master: BEGIN
[0m23:13:40.489207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:13:40.492456 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:13:40.492858 [debug] [MainThread]: On master: COMMIT
[0m23:13:40.493092 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:40.493305 [debug] [MainThread]: On master: COMMIT
[0m23:13:40.493595 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:40.493773 [debug] [MainThread]: On master: Close
[0m23:13:40.495360 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m23:13:40.495621 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m23:13:40.495927 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m23:13:40.496136 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m23:13:40.499105 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m23:13:40.500012 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m23:13:40.511736 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m23:13:40.512388 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m23:13:40.512557 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m23:13:40.512733 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:13:40.516040 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:13:40.516248 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m23:13:40.516439 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    trans_type,
    created_at,
    customer_id,
    amount,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m23:13:40.519487 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:13:40.521919 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m23:13:40.522135 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
alter table "thrive"."main"."int_fifo_matched__dbt_tmp" rename to "int_fifo_matched"
[0m23:13:40.522479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:40.528909 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m23:13:40.529136 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m23:13:40.529322 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m23:13:40.530048 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:13:40.531773 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m23:13:40.532005 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
drop table if exists "thrive"."main"."int_fifo_matched__dbt_backup" cascade
[0m23:13:40.532301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:40.533282 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m23:13:40.536316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba958fbb-132a-4b1d-8064-61b117139bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859840d0>]}
[0m23:13:40.536623 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.int_fifo_matched ........................ [[32mOK[0m in 0.04s]
[0m23:13:40.536903 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m23:13:40.537535 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:40.537730 [debug] [MainThread]: On master: BEGIN
[0m23:13:40.537903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:13:40.540977 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:13:40.541324 [debug] [MainThread]: On master: COMMIT
[0m23:13:40.541658 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:40.541850 [debug] [MainThread]: On master: COMMIT
[0m23:13:40.542150 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:40.542390 [debug] [MainThread]: On master: Close
[0m23:13:40.543098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:40.543272 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m23:13:40.543395 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m23:13:40.543537 [info ] [MainThread]: 
[0m23:13:40.543703 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m23:13:40.544070 [debug] [MainThread]: Command end result
[0m23:13:40.556924 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:13:40.557839 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:13:40.560467 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:13:40.560640 [info ] [MainThread]: 
[0m23:13:40.560863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:13:40.561029 [info ] [MainThread]: 
[0m23:13:40.561199 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:13:40.561635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.39160213, "process_in_blocks": "0", "process_kernel_time": 0.079049, "process_mem_max_rss": "161224", "process_out_blocks": "3008", "process_user_time": 0.802655}
[0m23:13:40.561862 [debug] [MainThread]: Command `dbt run` succeeded at 23:13:40.561825 after 0.39 seconds
[0m23:13:40.562055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e84a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e849f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933e91d0>]}
[0m23:13:40.562245 [debug] [MainThread]: Flushing usage events
[0m23:13:40.714763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:13:42.004441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f06790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86504f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f77b10>]}


============================== 23:13:42.005840 | 77aa2acf-0335-46ed-884b-cc805c86fc84 ==============================
[0m23:13:42.005840 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:13:42.006257 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'log_cache_events': 'False', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt_project', 'warn_error': 'None', 'invocation_command': 'dbt test --select int_fifo_matched', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m23:13:42.081056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77aa2acf-0335-46ed-884b-cc805c86fc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ddfc50>]}
[0m23:13:42.102125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77aa2acf-0335-46ed-884b-cc805c86fc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d36090>]}
[0m23:13:42.102516 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m23:13:42.127230 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:13:42.173943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:13:42.174328 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:13:42.174577 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:13:42.195743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77aa2acf-0335-46ed-884b-cc805c86fc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d222e10>]}
[0m23:13:42.240062 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:13:42.241165 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:13:42.251260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77aa2acf-0335-46ed-884b-cc805c86fc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ced5e10>]}
[0m23:13:42.251586 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 455 macros
[0m23:13:42.251919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77aa2acf-0335-46ed-884b-cc805c86fc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85dded10>]}
[0m23:13:42.252764 [info ] [MainThread]: 
[0m23:13:42.253005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:42.253206 [info ] [MainThread]: 
[0m23:13:42.253508 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:13:42.255597 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m23:13:42.291326 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:13:42.291655 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m23:13:42.291903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:42.296437 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m23:13:42.296672 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:13:42.297209 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m23:13:42.305535 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:13:42.306266 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m23:13:42.306663 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m23:13:42.306850 [debug] [ThreadPool]: On list_thrive_main: Close
[0m23:13:42.308526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77aa2acf-0335-46ed-884b-cc805c86fc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5228d0>]}
[0m23:13:42.308793 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:42.308988 [debug] [MainThread]: On master: BEGIN
[0m23:13:42.309170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:13:42.312495 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:13:42.312718 [debug] [MainThread]: On master: COMMIT
[0m23:13:42.312901 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:42.313076 [debug] [MainThread]: On master: COMMIT
[0m23:13:42.313478 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:42.313746 [debug] [MainThread]: On master: Close
[0m23:13:42.315384 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m23:13:42.315619 [info ] [Thread-1 (]: 1 of 3 START test not_null_int_fifo_matched_trans_id ........................... [RUN]
[0m23:13:42.315921 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m23:13:42.316152 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m23:13:42.322556 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m23:13:42.323421 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m23:13:42.329747 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m23:13:42.330239 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m23:13:42.330423 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: BEGIN
[0m23:13:42.330591 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:13:42.333855 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:13:42.334068 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m23:13:42.334251 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trans_id
from "thrive"."main"."int_fifo_matched"
where trans_id is null



  
  
      
    ) dbt_internal_test
[0m23:13:42.334969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:42.336798 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: ROLLBACK
[0m23:13:42.337107 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m23:13:42.337287 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: Close
[0m23:13:42.338139 [info ] [Thread-1 (]: 1 of 3 PASS not_null_int_fifo_matched_trans_id ................................. [[32mPASS[0m in 0.02s]
[0m23:13:42.338501 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m23:13:42.338714 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m23:13:42.338927 [info ] [Thread-1 (]: 2 of 3 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m23:13:42.339201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m23:13:42.339382 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m23:13:42.341902 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m23:13:42.342438 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m23:13:42.343444 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m23:13:42.343911 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m23:13:42.344149 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m23:13:42.344387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:42.347312 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:13:42.347570 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m23:13:42.347773 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:13:42.348998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:13:42.349637 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m23:13:42.349903 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m23:13:42.350077 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m23:13:42.350778 [info ] [Thread-1 (]: 2 of 3 PASS unique_int_fifo_matched_redeem_id .................................. [[32mPASS[0m in 0.01s]
[0m23:13:42.351073 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m23:13:42.351286 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m23:13:42.351491 [info ] [Thread-1 (]: 3 of 3 START test unique_int_fifo_matched_trans_id ............................. [RUN]
[0m23:13:42.351695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b)
[0m23:13:42.351878 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m23:13:42.353629 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m23:13:42.354270 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m23:13:42.355363 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m23:13:42.356042 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m23:13:42.356236 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: BEGIN
[0m23:13:42.356413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:42.359261 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:13:42.359456 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m23:13:42.359612 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trans_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where trans_id is not null
group by trans_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:13:42.361607 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:13:42.362253 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: ROLLBACK
[0m23:13:42.362496 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b'
[0m23:13:42.362647 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: Close
[0m23:13:42.363403 [info ] [Thread-1 (]: 3 of 3 PASS unique_int_fifo_matched_trans_id ................................... [[32mPASS[0m in 0.01s]
[0m23:13:42.363673 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m23:13:42.364307 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:42.364515 [debug] [MainThread]: On master: BEGIN
[0m23:13:42.364680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:13:42.367743 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:13:42.367995 [debug] [MainThread]: On master: COMMIT
[0m23:13:42.368196 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:42.368367 [debug] [MainThread]: On master: COMMIT
[0m23:13:42.368609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:42.368782 [debug] [MainThread]: On master: Close
[0m23:13:42.369555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:42.369797 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m23:13:42.370017 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b' was properly closed.
[0m23:13:42.370240 [info ] [MainThread]: 
[0m23:13:42.370454 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m23:13:42.370901 [debug] [MainThread]: Command end result
[0m23:13:42.384043 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:13:42.384972 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:13:42.388008 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:13:42.388211 [info ] [MainThread]: 
[0m23:13:42.388404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:13:42.388587 [info ] [MainThread]: 
[0m23:13:42.388791 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:13:42.389280 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.40480965, "process_in_blocks": "0", "process_kernel_time": 0.082263, "process_mem_max_rss": "163060", "process_out_blocks": "1984", "process_user_time": 0.808591}
[0m23:13:42.389521 [debug] [MainThread]: Command `dbt test` succeeded at 23:13:42.389481 after 0.41 seconds
[0m23:13:42.389752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aaa91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d4f9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aaa9110>]}
[0m23:13:42.389976 [debug] [MainThread]: Flushing usage events
[0m23:13:42.543254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:13:44.065115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51a21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51a2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51a09d0>]}


============================== 23:13:44.066412 | 5f558cfc-252e-4419-8f2c-31d2b0dfce92 ==============================
[0m23:13:44.066412 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:13:44.066737 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt_project', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'no_print': 'None', 'invocation_command': 'dbt run --select marts', 'log_format': 'default', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'partial_parse': 'True', 'printer_width': '80'}
[0m23:13:44.140874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f558cfc-252e-4419-8f2c-31d2b0dfce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5054a90>]}
[0m23:13:44.161897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f558cfc-252e-4419-8f2c-31d2b0dfce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f96090>]}
[0m23:13:44.162262 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m23:13:44.186821 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:13:44.230020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:13:44.230264 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:13:44.230433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:13:44.247945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f558cfc-252e-4419-8f2c-31d2b0dfce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c486c50>]}
[0m23:13:44.282641 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:13:44.283477 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:13:44.289236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f558cfc-252e-4419-8f2c-31d2b0dfce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3f07d0>]}
[0m23:13:44.289507 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 455 macros
[0m23:13:44.289739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f558cfc-252e-4419-8f2c-31d2b0dfce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6eee210>]}
[0m23:13:44.290470 [info ] [MainThread]: 
[0m23:13:44.290706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:44.290924 [info ] [MainThread]: 
[0m23:13:44.291222 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:13:44.291697 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m23:13:44.326735 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m23:13:44.327057 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m23:13:44.327246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:44.331389 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:13:44.331966 [debug] [ThreadPool]: On list_thrive: Close
[0m23:13:44.333069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m23:13:44.333342 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m23:13:44.335958 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:44.336144 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m23:13:44.336313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:44.339221 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:13:44.339788 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:44.339988 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m23:13:44.340487 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:44.340772 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:44.340976 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m23:13:44.341287 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:44.341650 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m23:13:44.341834 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m23:13:44.342004 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m23:13:44.342332 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:13:44.342571 [debug] [ThreadPool]: On create_thrive_main: Close
[0m23:13:44.345285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m23:13:44.347736 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:13:44.347953 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m23:13:44.348119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:44.350823 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:13:44.351027 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m23:13:44.351209 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m23:13:44.359392 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:13:44.360225 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m23:13:44.360736 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m23:13:44.361010 [debug] [ThreadPool]: On list_thrive_main: Close
[0m23:13:44.362678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f558cfc-252e-4419-8f2c-31d2b0dfce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b772410>]}
[0m23:13:44.363017 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:44.363246 [debug] [MainThread]: On master: BEGIN
[0m23:13:44.363439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:13:44.366988 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m23:13:44.367211 [debug] [MainThread]: On master: COMMIT
[0m23:13:44.367363 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:44.367498 [debug] [MainThread]: On master: COMMIT
[0m23:13:44.367737 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:44.367989 [debug] [MainThread]: On master: Close
[0m23:13:44.369577 [debug] [Thread-1 (]: Began running node model.thrive_market.finance_report
[0m23:13:44.369874 [info ] [Thread-1 (]: 1 of 1 START sql table model main.finance_report ............................... [RUN]
[0m23:13:44.370135 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.finance_report'
[0m23:13:44.370333 [debug] [Thread-1 (]: Began compiling node model.thrive_market.finance_report
[0m23:13:44.373563 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.finance_report"
[0m23:13:44.374191 [debug] [Thread-1 (]: Began executing node model.thrive_market.finance_report
[0m23:13:44.385717 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.finance_report"
[0m23:13:44.386396 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m23:13:44.386590 [debug] [Thread-1 (]: On model.thrive_market.finance_report: BEGIN
[0m23:13:44.386774 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:13:44.390096 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:13:44.390304 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m23:13:44.390513 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with enriched_transactions as (
    select 
        t.trans_id,
        t.customer_id,
        t.amount,
        t.trans_type,
        t.created_at,
        f.redeem_id,
        -- Sign convention: earned = +, spent/expired = -
        case 
            when t.trans_type = 'earned' then t.amount
            else -t.amount 
        end as signed_amount
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.trans_id = f.trans_id
),

running_balances as (
    select
        trans_id,
        customer_id,
        trans_type,
        created_at,
        amount,
        redeem_id,
        signed_amount,
        -- Running balance for this customer up to this point in time
        sum(signed_amount) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as running_balance,
        -- Cumulative totals by transaction type
        sum(case when trans_type = 'earned' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_earned,
        sum(case when trans_type = 'spent' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_spent,
        sum(case when trans_type = 'expired' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_expired
    from enriched_transactions
)

select
    customer_id,
    created_at as transaction_date,
    amount,
    cumulative_earned,
    cumulative_spent,
    cumulative_expired,
    (cumulative_earned - cumulative_spent - cumulative_expired) as current_balance,
    running_balance
from running_balances
order by customer_id, created_at, trans_id
    );
  
  
[0m23:13:44.394950 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:13:44.397467 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m23:13:44.397752 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */
alter table "thrive"."main"."finance_report__dbt_tmp" rename to "finance_report"
[0m23:13:44.398250 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:44.404458 [debug] [Thread-1 (]: On model.thrive_market.finance_report: COMMIT
[0m23:13:44.404663 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m23:13:44.404854 [debug] [Thread-1 (]: On model.thrive_market.finance_report: COMMIT
[0m23:13:44.405610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:13:44.407347 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m23:13:44.407554 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */
drop table if exists "thrive"."main"."finance_report__dbt_backup" cascade
[0m23:13:44.407832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:13:44.408732 [debug] [Thread-1 (]: On model.thrive_market.finance_report: Close
[0m23:13:44.411605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f558cfc-252e-4419-8f2c-31d2b0dfce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c248ed0>]}
[0m23:13:44.411965 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.finance_report .......................... [[32mOK[0m in 0.04s]
[0m23:13:44.412242 [debug] [Thread-1 (]: Finished running node model.thrive_market.finance_report
[0m23:13:44.412915 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:44.413119 [debug] [MainThread]: On master: BEGIN
[0m23:13:44.413282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:13:44.416490 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:13:44.416834 [debug] [MainThread]: On master: COMMIT
[0m23:13:44.417098 [debug] [MainThread]: Using duckdb connection "master"
[0m23:13:44.417324 [debug] [MainThread]: On master: COMMIT
[0m23:13:44.417541 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:13:44.417705 [debug] [MainThread]: On master: Close
[0m23:13:44.418457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:44.418638 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m23:13:44.418793 [debug] [MainThread]: Connection 'model.thrive_market.finance_report' was properly closed.
[0m23:13:44.418972 [info ] [MainThread]: 
[0m23:13:44.419152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m23:13:44.419496 [debug] [MainThread]: Command end result
[0m23:13:44.432124 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:13:44.432963 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:13:44.435531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:13:44.435738 [info ] [MainThread]: 
[0m23:13:44.435980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:13:44.436179 [info ] [MainThread]: 
[0m23:13:44.436391 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:13:44.436866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.39127535, "process_in_blocks": "0", "process_kernel_time": 0.057404, "process_mem_max_rss": "164700", "process_out_blocks": "3028", "process_user_time": 0.812724}
[0m23:13:44.437124 [debug] [MainThread]: Command `dbt run` succeeded at 23:13:44.437078 after 0.39 seconds
[0m23:13:44.437330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5166510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51d6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d09210>]}
[0m23:13:44.437515 [debug] [MainThread]: Flushing usage events
[0m23:13:44.583086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:30:55.919649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d73a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d575ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d577110>]}


============================== 01:30:55.921063 | 88bdff8a-9d6b-48be-9113-15c85fb2628a ==============================
[0m01:30:55.921063 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:30:55.921489 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None'}
[0m01:30:55.995658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88bdff8a-9d6b-48be-9113-15c85fb2628a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d411f90>]}
[0m01:30:56.016790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88bdff8a-9d6b-48be-9113-15c85fb2628a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80364a90>]}
[0m01:30:56.017195 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m01:30:56.042081 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:30:56.087360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:30:56.087704 [debug] [MainThread]: Partial parsing: updated file: thrive_market://models/marts/finance_report.sql
[0m01:30:56.182438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88bdff8a-9d6b-48be-9113-15c85fb2628a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74794890>]}
[0m01:30:56.241889 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m01:30:56.242956 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m01:30:56.248736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88bdff8a-9d6b-48be-9113-15c85fb2628a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d548950>]}
[0m01:30:56.249031 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 455 macros
[0m01:30:56.249339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88bdff8a-9d6b-48be-9113-15c85fb2628a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7482b9d0>]}
[0m01:30:56.250170 [info ] [MainThread]: 
[0m01:30:56.250405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:30:56.250600 [info ] [MainThread]: 
[0m01:30:56.250894 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:30:56.252828 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m01:30:56.265383 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m01:30:56.265636 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m01:30:56.265837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:56.269895 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:30:56.270461 [debug] [ThreadPool]: On list_thrive: Close
[0m01:30:56.271546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m01:30:56.271990 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m01:30:56.274653 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:30:56.274874 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m01:30:56.275072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:56.277981 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:30:56.278545 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:30:56.278737 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m01:30:56.279052 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:30:56.279236 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:30:56.279421 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m01:30:56.279723 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:30:56.280085 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m01:30:56.280297 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:30:56.280468 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m01:30:56.280748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:30:56.280949 [debug] [ThreadPool]: On create_thrive_main: Close
[0m01:30:56.282095 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m01:30:56.284228 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:30:56.284437 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m01:30:56.284610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:56.287587 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:30:56.287779 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:30:56.287979 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m01:30:56.296207 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m01:30:56.296861 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m01:30:56.297229 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m01:30:56.297409 [debug] [ThreadPool]: On list_thrive_main: Close
[0m01:30:56.298616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88bdff8a-9d6b-48be-9113-15c85fb2628a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d58e390>]}
[0m01:30:56.298890 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:56.299084 [debug] [MainThread]: On master: BEGIN
[0m01:30:56.299250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:56.302297 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:30:56.302620 [debug] [MainThread]: On master: COMMIT
[0m01:30:56.302841 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:56.303032 [debug] [MainThread]: On master: COMMIT
[0m01:30:56.303329 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:30:56.303585 [debug] [MainThread]: On master: Close
[0m01:30:56.305137 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_customers
[0m01:30:56.305429 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m01:30:56.305731 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.stg_customers'
[0m01:30:56.305953 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_customers
[0m01:30:56.308948 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_customers"
[0m01:30:56.309509 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_customers
[0m01:30:56.321187 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_customers"
[0m01:30:56.321970 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m01:30:56.322176 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: BEGIN
[0m01:30:56.322375 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:30:56.325777 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:30:56.325988 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m01:30:56.326163 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */

  
  create view "thrive"."main"."stg_customers__dbt_tmp" as (
    SELECT
    "CUSTOMERID"::int as customer_id,
    "EMAIL"::varchar as email,
    "FIRSTNAME"::varchar as first_name,
    "BILLINGPOSTCODE"::varchar as billing_post_code
FROM "thrive"."main"."raw_customers"
  );

[0m01:30:56.326525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.329011 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m01:30:56.329193 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
alter view "thrive"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:30:56.329453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.334797 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m01:30:56.335042 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m01:30:56.335229 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: COMMIT
[0m01:30:56.335936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:30:56.337836 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_customers"
[0m01:30:56.338017 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_customers"} */
drop view if exists "thrive"."main"."stg_customers__dbt_backup" cascade
[0m01:30:56.338298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.339257 [debug] [Thread-1 (]: On model.thrive_market.stg_customers: Close
[0m01:30:56.341357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88bdff8a-9d6b-48be-9113-15c85fb2628a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d560f90>]}
[0m01:30:56.341695 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m01:30:56.341964 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_customers
[0m01:30:56.342164 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_sales
[0m01:30:56.342440 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_sales ..................................... [RUN]
[0m01:30:56.342682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_customers, now model.thrive_market.stg_sales)
[0m01:30:56.342884 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_sales
[0m01:30:56.344013 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_sales"
[0m01:30:56.344424 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_sales
[0m01:30:56.345713 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_sales"
[0m01:30:56.346058 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m01:30:56.346208 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: BEGIN
[0m01:30:56.346349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:56.349598 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:30:56.349824 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m01:30:56.350000 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */

  
  create view "thrive"."main"."stg_sales__dbt_tmp" as (
    SELECT
    "ORDERID"::int as order_id,
    "CUSTOMERID"::int as customer_id,
    "PREDISCOUNTGROSSPRODUCTSALES":: decimal(10,2) as pre_discount_gross_product_sales,
    "ORDERWEIGHT"::decimal(10,2) as order_weight
FROM "thrive"."main"."raw_sales"
  );

[0m01:30:56.350354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.351532 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m01:30:56.351711 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
alter view "thrive"."main"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m01:30:56.351970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.352477 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m01:30:56.352634 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m01:30:56.352785 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: COMMIT
[0m01:30:56.353358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.354248 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_sales"
[0m01:30:56.354447 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_sales"} */
drop view if exists "thrive"."main"."stg_sales__dbt_backup" cascade
[0m01:30:56.354904 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.355517 [debug] [Thread-1 (]: On model.thrive_market.stg_sales: Close
[0m01:30:56.357014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88bdff8a-9d6b-48be-9113-15c85fb2628a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72177dd0>]}
[0m01:30:56.357387 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_sales ................................ [[32mOK[0m in 0.01s]
[0m01:30:56.357643 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_sales
[0m01:30:56.357844 [debug] [Thread-1 (]: Began running node model.thrive_market.stg_tc_data
[0m01:30:56.358082 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_tc_data ................................... [RUN]
[0m01:30:56.358291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.thrive_market.stg_sales, now model.thrive_market.stg_tc_data)
[0m01:30:56.358474 [debug] [Thread-1 (]: Began compiling node model.thrive_market.stg_tc_data
[0m01:30:56.359529 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.stg_tc_data"
[0m01:30:56.359934 [debug] [Thread-1 (]: Began executing node model.thrive_market.stg_tc_data
[0m01:30:56.361956 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.stg_tc_data"
[0m01:30:56.362318 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:30:56.362484 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: BEGIN
[0m01:30:56.362631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:56.365975 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:30:56.366218 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:30:56.366402 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */

  
  create view "thrive"."main"."stg_tc_data__dbt_tmp" as (
    select
    "TRANS_ID"::int as trans_id,
    "TCTYPE"::varchar as trans_type,
    "CREATEDAT"::timestamp as created_at,
    "EXPIREDAT"::timestamp as expired_at,
    "CUSTOMERID"::int as customer_id,
    "ORDERID"::int as order_id,
    "AMOUNT"::decimal(10,2) as amount,
    "REASON"::varchar as reason
from "thrive"."main"."raw_tc_data"
  );

[0m01:30:56.366957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.368348 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:30:56.368527 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
alter view "thrive"."main"."stg_tc_data__dbt_tmp" rename to "stg_tc_data"
[0m01:30:56.368781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.369311 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m01:30:56.369470 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:30:56.369610 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: COMMIT
[0m01:30:56.370179 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.371073 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.stg_tc_data"
[0m01:30:56.371241 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.stg_tc_data"} */
drop view if exists "thrive"."main"."stg_tc_data__dbt_backup" cascade
[0m01:30:56.371497 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:56.372003 [debug] [Thread-1 (]: On model.thrive_market.stg_tc_data: Close
[0m01:30:56.373945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88bdff8a-9d6b-48be-9113-15c85fb2628a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff446ca3d0>]}
[0m01:30:56.374261 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_tc_data .............................. [[32mOK[0m in 0.02s]
[0m01:30:56.374533 [debug] [Thread-1 (]: Finished running node model.thrive_market.stg_tc_data
[0m01:30:56.375194 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:56.375365 [debug] [MainThread]: On master: BEGIN
[0m01:30:56.375514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:30:56.378736 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:30:56.379013 [debug] [MainThread]: On master: COMMIT
[0m01:30:56.379182 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:56.379322 [debug] [MainThread]: On master: COMMIT
[0m01:30:56.379638 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:30:56.379872 [debug] [MainThread]: On master: Close
[0m01:30:56.380602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:56.380908 [debug] [MainThread]: Connection 'create_thrive_main' was properly closed.
[0m01:30:56.381219 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m01:30:56.381471 [debug] [MainThread]: Connection 'model.thrive_market.stg_tc_data' was properly closed.
[0m01:30:56.381712 [info ] [MainThread]: 
[0m01:30:56.381916 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m01:30:56.382334 [debug] [MainThread]: Command end result
[0m01:30:56.393922 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m01:30:56.394771 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m01:30:56.397490 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m01:30:56.397674 [info ] [MainThread]: 
[0m01:30:56.397908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:56.398245 [info ] [MainThread]: 
[0m01:30:56.398523 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:30:56.399000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49968624, "process_in_blocks": "0", "process_kernel_time": 0.08786, "process_mem_max_rss": "161420", "process_out_blocks": "4501", "process_user_time": 0.936509}
[0m01:30:56.399229 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:56.399196 after 0.50 seconds
[0m01:30:56.399398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3db910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3dbf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74694210>]}
[0m01:30:56.399575 [debug] [MainThread]: Flushing usage events
[0m01:30:56.589617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:30:58.779536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b50190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b8a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829cd5d0>]}


============================== 01:30:58.780993 | 6ddedd47-4e0f-4282-9ec5-30767db3333f ==============================
[0m01:30:58.780993 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:30:58.781406 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'empty': 'False', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select intermediate', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'static_parser': 'True'}
[0m01:30:58.855680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ddedd47-4e0f-4282-9ec5-30767db3333f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a39e90>]}
[0m01:30:58.876658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ddedd47-4e0f-4282-9ec5-30767db3333f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79042b50>]}
[0m01:30:58.877047 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m01:30:58.901922 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:30:58.945268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:58.945501 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:30:58.945685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:58.963302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ddedd47-4e0f-4282-9ec5-30767db3333f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bc1690>]}
[0m01:30:58.998037 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m01:30:58.998933 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m01:30:59.004614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ddedd47-4e0f-4282-9ec5-30767db3333f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78ffb590>]}
[0m01:30:59.004895 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 455 macros
[0m01:30:59.005229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ddedd47-4e0f-4282-9ec5-30767db3333f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78fdb710>]}
[0m01:30:59.005986 [info ] [MainThread]: 
[0m01:30:59.006233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:30:59.006490 [info ] [MainThread]: 
[0m01:30:59.006796 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:30:59.007260 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m01:30:59.044529 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m01:30:59.044790 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m01:30:59.044935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:59.049184 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:30:59.049782 [debug] [ThreadPool]: On list_thrive: Close
[0m01:30:59.050743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m01:30:59.051026 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m01:30:59.053600 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:30:59.053822 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m01:30:59.054032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:59.056961 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:30:59.057516 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:30:59.057703 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m01:30:59.058026 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:30:59.058219 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:30:59.058390 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m01:30:59.058708 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:30:59.059070 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m01:30:59.059244 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:30:59.059416 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m01:30:59.059687 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:30:59.059866 [debug] [ThreadPool]: On create_thrive_main: Close
[0m01:30:59.062789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m01:30:59.065325 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:30:59.065514 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m01:30:59.065700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:59.068433 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:30:59.068626 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:30:59.068813 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m01:30:59.076759 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m01:30:59.077380 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m01:30:59.077745 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m01:30:59.077937 [debug] [ThreadPool]: On list_thrive_main: Close
[0m01:30:59.079270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ddedd47-4e0f-4282-9ec5-30767db3333f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79168590>]}
[0m01:30:59.079522 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:59.079697 [debug] [MainThread]: On master: BEGIN
[0m01:30:59.079873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:59.082918 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:30:59.083109 [debug] [MainThread]: On master: COMMIT
[0m01:30:59.083291 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:59.083483 [debug] [MainThread]: On master: COMMIT
[0m01:30:59.083749 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:30:59.084097 [debug] [MainThread]: On master: Close
[0m01:30:59.085740 [debug] [Thread-1 (]: Began running node model.thrive_market.int_fifo_matched
[0m01:30:59.086064 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_fifo_matched ............................. [RUN]
[0m01:30:59.086360 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.int_fifo_matched'
[0m01:30:59.086559 [debug] [Thread-1 (]: Began compiling node model.thrive_market.int_fifo_matched
[0m01:30:59.089579 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.int_fifo_matched"
[0m01:30:59.091530 [debug] [Thread-1 (]: Began executing node model.thrive_market.int_fifo_matched
[0m01:30:59.103069 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.int_fifo_matched"
[0m01:30:59.103735 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m01:30:59.103972 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: BEGIN
[0m01:30:59.104172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:30:59.107298 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:30:59.107503 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m01:30:59.107725 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */

  
    
    

    create  table
      "thrive"."main"."int_fifo_matched__dbt_tmp"
  
    as (
      with source_data as (
    select * from "thrive"."main"."python_fifo_output"
)

select
    trans_id,
    trans_type,
    created_at,
    customer_id,
    amount,
    redeem_id::int as redeem_id
from source_data
    );
  
  
[0m01:30:59.108564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:30:59.110987 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m01:30:59.111185 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
alter table "thrive"."main"."int_fifo_matched__dbt_tmp" rename to "int_fifo_matched"
[0m01:30:59.111466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:59.118049 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m01:30:59.118267 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m01:30:59.118451 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: COMMIT
[0m01:30:59.119168 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:30:59.120901 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.int_fifo_matched"
[0m01:30:59.121072 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.int_fifo_matched"} */
drop table if exists "thrive"."main"."int_fifo_matched__dbt_backup" cascade
[0m01:30:59.121345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:30:59.122289 [debug] [Thread-1 (]: On model.thrive_market.int_fifo_matched: Close
[0m01:30:59.125310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddedd47-4e0f-4282-9ec5-30767db3333f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f1b650>]}
[0m01:30:59.125634 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.int_fifo_matched ........................ [[32mOK[0m in 0.04s]
[0m01:30:59.125917 [debug] [Thread-1 (]: Finished running node model.thrive_market.int_fifo_matched
[0m01:30:59.126541 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:59.126757 [debug] [MainThread]: On master: BEGIN
[0m01:30:59.126931 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:30:59.129999 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:30:59.130327 [debug] [MainThread]: On master: COMMIT
[0m01:30:59.130614 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:59.130879 [debug] [MainThread]: On master: COMMIT
[0m01:30:59.131133 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:30:59.131301 [debug] [MainThread]: On master: Close
[0m01:30:59.132077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:59.132290 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m01:30:59.132486 [debug] [MainThread]: Connection 'model.thrive_market.int_fifo_matched' was properly closed.
[0m01:30:59.132662 [info ] [MainThread]: 
[0m01:30:59.132862 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m01:30:59.133197 [debug] [MainThread]: Command end result
[0m01:30:59.145546 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m01:30:59.146515 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m01:30:59.149172 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m01:30:59.149360 [info ] [MainThread]: 
[0m01:30:59.149595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:59.149773 [info ] [MainThread]: 
[0m01:30:59.149955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:30:59.150414 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.39119372, "process_in_blocks": "0", "process_kernel_time": 0.08726, "process_mem_max_rss": "161020", "process_out_blocks": "3008", "process_user_time": 0.805408}
[0m01:30:59.150634 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:59.150600 after 0.39 seconds
[0m01:30:59.150836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8683e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8683cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866e9250>]}
[0m01:30:59.151016 [debug] [MainThread]: Flushing usage events
[0m01:30:59.299636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:00.812101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989005d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98af5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989030d0>]}


============================== 01:31:00.813465 | afc0744d-8ce7-4e22-bf39-70496b380d4e ==============================
[0m01:31:00.813465 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:31:00.813901 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt_project', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'empty': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt test --select int_fifo_matched', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'log_cache_events': 'False'}
[0m01:31:00.890022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afc0744d-8ce7-4e22-bf39-70496b380d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987d2710>]}
[0m01:31:00.910609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afc0744d-8ce7-4e22-bf39-70496b380d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b724210>]}
[0m01:31:00.911013 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m01:31:00.935571 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:31:00.979052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:31:00.979322 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:31:00.979509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:31:00.997032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afc0744d-8ce7-4e22-bf39-70496b380d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc71c50>]}
[0m01:31:01.031682 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m01:31:01.032583 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m01:31:01.041858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afc0744d-8ce7-4e22-bf39-70496b380d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8c7d90>]}
[0m01:31:01.042136 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 455 macros
[0m01:31:01.042426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc0744d-8ce7-4e22-bf39-70496b380d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd34e10>]}
[0m01:31:01.043192 [info ] [MainThread]: 
[0m01:31:01.043413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:01.043601 [info ] [MainThread]: 
[0m01:31:01.043911 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:31:01.045824 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive_main'
[0m01:31:01.082119 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:31:01.082424 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m01:31:01.082619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:01.086738 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:31:01.086952 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:31:01.087137 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m01:31:01.095232 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m01:31:01.095888 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m01:31:01.096239 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m01:31:01.096411 [debug] [ThreadPool]: On list_thrive_main: Close
[0m01:31:01.098066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc0744d-8ce7-4e22-bf39-70496b380d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9c0b90>]}
[0m01:31:01.098346 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:01.098539 [debug] [MainThread]: On master: BEGIN
[0m01:31:01.098720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:31:01.102242 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:31:01.102550 [debug] [MainThread]: On master: COMMIT
[0m01:31:01.102799 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:01.103023 [debug] [MainThread]: On master: COMMIT
[0m01:31:01.103340 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:31:01.103604 [debug] [MainThread]: On master: Close
[0m01:31:01.105417 [debug] [Thread-1 (]: Began running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m01:31:01.105706 [info ] [Thread-1 (]: 1 of 3 START test not_null_int_fifo_matched_trans_id ........................... [RUN]
[0m01:31:01.106026 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m01:31:01.106241 [debug] [Thread-1 (]: Began compiling node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m01:31:01.113060 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m01:31:01.113781 [debug] [Thread-1 (]: Began executing node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m01:31:01.120220 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m01:31:01.120689 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m01:31:01.120870 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: BEGIN
[0m01:31:01.121021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:31:01.124575 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:31:01.124933 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"
[0m01:31:01.125203 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trans_id
from "thrive"."main"."int_fifo_matched"
where trans_id is null



  
  
      
    ) dbt_internal_test
[0m01:31:01.125956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:31:01.127756 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: ROLLBACK
[0m01:31:01.128096 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295'
[0m01:31:01.128293 [debug] [Thread-1 (]: On test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295: Close
[0m01:31:01.129052 [info ] [Thread-1 (]: 1 of 3 PASS not_null_int_fifo_matched_trans_id ................................. [[32mPASS[0m in 0.02s]
[0m01:31:01.129357 [debug] [Thread-1 (]: Finished running node test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295
[0m01:31:01.129598 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m01:31:01.129862 [info ] [Thread-1 (]: 2 of 3 START test unique_int_fifo_matched_redeem_id ............................ [RUN]
[0m01:31:01.130098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.not_null_int_fifo_matched_trans_id.c4ad5a6295, now test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f)
[0m01:31:01.130295 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m01:31:01.132736 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m01:31:01.133250 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m01:31:01.134251 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m01:31:01.134717 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m01:31:01.134906 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: BEGIN
[0m01:31:01.135081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:01.137837 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:31:01.138038 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"
[0m01:31:01.138229 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    redeem_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where redeem_id is not null
group by redeem_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:31:01.139348 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:31:01.140046 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: ROLLBACK
[0m01:31:01.140295 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f'
[0m01:31:01.140462 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f: Close
[0m01:31:01.141420 [info ] [Thread-1 (]: 2 of 3 PASS unique_int_fifo_matched_redeem_id .................................. [[32mPASS[0m in 0.01s]
[0m01:31:01.141810 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f
[0m01:31:01.142019 [debug] [Thread-1 (]: Began running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m01:31:01.142228 [info ] [Thread-1 (]: 3 of 3 START test unique_int_fifo_matched_trans_id ............................. [RUN]
[0m01:31:01.142495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.thrive_market.unique_int_fifo_matched_redeem_id.f59552911f, now test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b)
[0m01:31:01.142696 [debug] [Thread-1 (]: Began compiling node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m01:31:01.144497 [debug] [Thread-1 (]: Writing injected SQL for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m01:31:01.146346 [debug] [Thread-1 (]: Began executing node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m01:31:01.147860 [debug] [Thread-1 (]: Writing runtime sql for node "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m01:31:01.148591 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m01:31:01.148791 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: BEGIN
[0m01:31:01.148956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:01.152053 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:31:01.152261 [debug] [Thread-1 (]: Using duckdb connection "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"
[0m01:31:01.152437 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trans_id as unique_field,
    count(*) as n_records

from "thrive"."main"."int_fifo_matched"
where trans_id is not null
group by trans_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:31:01.154286 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:31:01.155046 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: ROLLBACK
[0m01:31:01.155298 [debug] [Thread-1 (]: Failed to rollback 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b'
[0m01:31:01.155448 [debug] [Thread-1 (]: On test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b: Close
[0m01:31:01.156286 [info ] [Thread-1 (]: 3 of 3 PASS unique_int_fifo_matched_trans_id ................................... [[32mPASS[0m in 0.01s]
[0m01:31:01.156680 [debug] [Thread-1 (]: Finished running node test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b
[0m01:31:01.157604 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:01.157885 [debug] [MainThread]: On master: BEGIN
[0m01:31:01.158072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:31:01.161244 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:31:01.161436 [debug] [MainThread]: On master: COMMIT
[0m01:31:01.161588 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:01.161722 [debug] [MainThread]: On master: COMMIT
[0m01:31:01.161951 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:31:01.162133 [debug] [MainThread]: On master: Close
[0m01:31:01.162794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:01.162975 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m01:31:01.163112 [debug] [MainThread]: Connection 'test.thrive_market.unique_int_fifo_matched_trans_id.00c0825b3b' was properly closed.
[0m01:31:01.163271 [info ] [MainThread]: 
[0m01:31:01.163449 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m01:31:01.163851 [debug] [MainThread]: Command end result
[0m01:31:01.176716 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m01:31:01.177608 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m01:31:01.180876 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m01:31:01.181091 [info ] [MainThread]: 
[0m01:31:01.181285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:01.181444 [info ] [MainThread]: 
[0m01:31:01.181647 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:31:01.182156 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.38993305, "process_in_blocks": "0", "process_kernel_time": 0.07198, "process_mem_max_rss": "162480", "process_out_blocks": "1984", "process_user_time": 0.793785}
[0m01:31:01.182382 [debug] [MainThread]: Command `dbt test` succeeded at 01:31:01.182347 after 0.39 seconds
[0m01:31:01.182582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9893dad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9893c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d499110>]}
[0m01:31:01.182779 [debug] [MainThread]: Flushing usage events
[0m01:31:01.326275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:02.878615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86582c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86582ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8657a750>]}


============================== 01:31:02.879966 | 84064e08-4010-40fe-a6ca-5310ba0e1cc4 ==============================
[0m01:31:02.879966 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:31:02.880292 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select marts', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'static_parser': 'True', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project'}
[0m01:31:02.952887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84064e08-4010-40fe-a6ca-5310ba0e1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86448050>]}
[0m01:31:02.973215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84064e08-4010-40fe-a6ca-5310ba0e1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893a5fd0>]}
[0m01:31:02.973595 [info ] [MainThread]: Registered adapter: duckdb=1.8.0
[0m01:31:02.998110 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:31:03.041162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:31:03.041435 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:31:03.041607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:31:03.060508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84064e08-4010-40fe-a6ca-5310ba0e1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d906190>]}
[0m01:31:03.098966 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m01:31:03.100054 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m01:31:03.106754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84064e08-4010-40fe-a6ca-5310ba0e1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9d0ad0>]}
[0m01:31:03.107087 [info ] [MainThread]: Found 5 models, 10 data tests, 4 sources, 455 macros
[0m01:31:03.107283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84064e08-4010-40fe-a6ca-5310ba0e1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86464050>]}
[0m01:31:03.108056 [info ] [MainThread]: 
[0m01:31:03.108292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:03.108497 [info ] [MainThread]: 
[0m01:31:03.108782 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:31:03.109303 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_thrive'
[0m01:31:03.154488 [debug] [ThreadPool]: Using duckdb connection "list_thrive"
[0m01:31:03.154833 [debug] [ThreadPool]: On list_thrive: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"thrive"'
    
  
  
[0m01:31:03.155058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:03.159474 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:31:03.160366 [debug] [ThreadPool]: On list_thrive: Close
[0m01:31:03.161884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_thrive, now create_thrive_main)
[0m01:31:03.162284 [debug] [ThreadPool]: Creating schema "database: "thrive"
schema: "main"
"
[0m01:31:03.165465 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:31:03.165905 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
        select type from duckdb_databases()
        where database_name='thrive'
        and type='sqlite'
    
  
[0m01:31:03.166147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:03.170103 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:31:03.170972 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:31:03.171203 [debug] [ThreadPool]: On create_thrive_main: BEGIN
[0m01:31:03.171533 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:31:03.171782 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:31:03.171988 [debug] [ThreadPool]: On create_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "create_thrive_main"} */

    
    
        create schema if not exists "thrive"."main"
    
[0m01:31:03.172328 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:31:03.172710 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m01:31:03.172909 [debug] [ThreadPool]: Using duckdb connection "create_thrive_main"
[0m01:31:03.173104 [debug] [ThreadPool]: On create_thrive_main: COMMIT
[0m01:31:03.173501 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:31:03.173712 [debug] [ThreadPool]: On create_thrive_main: Close
[0m01:31:03.177272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_thrive_main, now list_thrive_main)
[0m01:31:03.180396 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:31:03.180614 [debug] [ThreadPool]: On list_thrive_main: BEGIN
[0m01:31:03.180800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:03.184005 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:31:03.184213 [debug] [ThreadPool]: Using duckdb connection "list_thrive_main"
[0m01:31:03.184410 [debug] [ThreadPool]: On list_thrive_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "connection_name": "list_thrive_main"} */
select
      'thrive' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'thrive'
  
[0m01:31:03.193214 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m01:31:03.194176 [debug] [ThreadPool]: On list_thrive_main: ROLLBACK
[0m01:31:03.194615 [debug] [ThreadPool]: Failed to rollback 'list_thrive_main'
[0m01:31:03.194817 [debug] [ThreadPool]: On list_thrive_main: Close
[0m01:31:03.196327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84064e08-4010-40fe-a6ca-5310ba0e1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d650950>]}
[0m01:31:03.196589 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:03.196784 [debug] [MainThread]: On master: BEGIN
[0m01:31:03.196976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:31:03.200441 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:31:03.200761 [debug] [MainThread]: On master: COMMIT
[0m01:31:03.200976 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:03.201158 [debug] [MainThread]: On master: COMMIT
[0m01:31:03.201446 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:31:03.201640 [debug] [MainThread]: On master: Close
[0m01:31:03.203307 [debug] [Thread-1 (]: Began running node model.thrive_market.finance_report
[0m01:31:03.203595 [info ] [Thread-1 (]: 1 of 1 START sql table model main.finance_report ............................... [RUN]
[0m01:31:03.203902 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.thrive_market.finance_report'
[0m01:31:03.204107 [debug] [Thread-1 (]: Began compiling node model.thrive_market.finance_report
[0m01:31:03.207281 [debug] [Thread-1 (]: Writing injected SQL for node "model.thrive_market.finance_report"
[0m01:31:03.207852 [debug] [Thread-1 (]: Began executing node model.thrive_market.finance_report
[0m01:31:03.219728 [debug] [Thread-1 (]: Writing runtime sql for node "model.thrive_market.finance_report"
[0m01:31:03.220720 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m01:31:03.220939 [debug] [Thread-1 (]: On model.thrive_market.finance_report: BEGIN
[0m01:31:03.221121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:31:03.224700 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:31:03.224890 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m01:31:03.225136 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */

  
    
    

    create  table
      "thrive"."main"."finance_report__dbt_tmp"
  
    as (
      with enriched_transactions as (
    select 
        t.trans_id,
        t.customer_id,
        t.amount,
        t.trans_type,
        t.created_at,
        f.redeem_id,
        -- Sign convention: earned = +, spent/expired = -
        case 
            when t.trans_type = 'earned' then t.amount
            else -t.amount 
        end as signed_amount
    from "thrive"."main"."stg_tc_data" t
    left join "thrive"."main"."int_fifo_matched" f 
        on t.trans_id = f.trans_id
),

running_balances as (
    select
        trans_id,
        customer_id,
        trans_type,
        created_at,
        amount,
        redeem_id,
        signed_amount,
        -- Running balance for this customer up to this point in time
        sum(signed_amount) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as running_balance,
        -- Cumulative totals by transaction type
        sum(case when trans_type = 'earned' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_earned,
        sum(case when trans_type = 'spent' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_spent,
        sum(case when trans_type = 'expired' then amount else 0 end) over (
            partition by customer_id 
            order by created_at, trans_id
            rows between unbounded preceding and current row
        ) as cumulative_expired
    from enriched_transactions
)

select
    customer_id,
    created_at as transaction_date,
    amount,
    cumulative_earned,
    cumulative_spent,
    cumulative_expired,
    (cumulative_earned - cumulative_spent - cumulative_expired) as current_balance
from running_balances
order by customer_id, created_at, trans_id
    );
  
  
[0m01:31:03.231927 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:31:03.234461 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m01:31:03.234685 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */
alter table "thrive"."main"."finance_report__dbt_tmp" rename to "finance_report"
[0m01:31:03.235059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:31:03.241064 [debug] [Thread-1 (]: On model.thrive_market.finance_report: COMMIT
[0m01:31:03.241266 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m01:31:03.241451 [debug] [Thread-1 (]: On model.thrive_market.finance_report: COMMIT
[0m01:31:03.243168 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:31:03.244932 [debug] [Thread-1 (]: Using duckdb connection "model.thrive_market.finance_report"
[0m01:31:03.245139 [debug] [Thread-1 (]: On model.thrive_market.finance_report: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "thrive_profile", "target_name": "dev", "node_id": "model.thrive_market.finance_report"} */
drop table if exists "thrive"."main"."finance_report__dbt_backup" cascade
[0m01:31:03.245733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:31:03.246917 [debug] [Thread-1 (]: On model.thrive_market.finance_report: Close
[0m01:31:03.249915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84064e08-4010-40fe-a6ca-5310ba0e1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb3dc10>]}
[0m01:31:03.250250 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.finance_report .......................... [[32mOK[0m in 0.05s]
[0m01:31:03.250527 [debug] [Thread-1 (]: Finished running node model.thrive_market.finance_report
[0m01:31:03.251183 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:03.251396 [debug] [MainThread]: On master: BEGIN
[0m01:31:03.251572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:31:03.254953 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:31:03.255156 [debug] [MainThread]: On master: COMMIT
[0m01:31:03.255324 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:03.255474 [debug] [MainThread]: On master: COMMIT
[0m01:31:03.255729 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:31:03.255907 [debug] [MainThread]: On master: Close
[0m01:31:03.256577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:03.256751 [debug] [MainThread]: Connection 'list_thrive_main' was properly closed.
[0m01:31:03.256896 [debug] [MainThread]: Connection 'model.thrive_market.finance_report' was properly closed.
[0m01:31:03.257061 [info ] [MainThread]: 
[0m01:31:03.257229 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m01:31:03.257526 [debug] [MainThread]: Command end result
[0m01:31:03.269980 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m01:31:03.270831 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m01:31:03.273446 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m01:31:03.273797 [info ] [MainThread]: 
[0m01:31:03.274124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:03.274315 [info ] [MainThread]: 
[0m01:31:03.274504 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:31:03.274965 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41594288, "process_in_blocks": "0", "process_kernel_time": 0.068622, "process_mem_max_rss": "164156", "process_out_blocks": "3027", "process_user_time": 0.82844}
[0m01:31:03.275188 [debug] [MainThread]: Command `dbt run` succeeded at 01:31:03.275155 after 0.42 seconds
[0m01:31:03.275360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8676ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1192d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b26dfd0>]}
[0m01:31:03.275545 [debug] [MainThread]: Flushing usage events
[0m01:31:03.418966 [debug] [MainThread]: An error was encountered while trying to flush usage events
